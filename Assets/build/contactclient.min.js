!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t,e){function i(){return new Date(Date.UTC.apply(Date,arguments))}function s(){var t=new Date;return i(t.getFullYear(),t.getMonth(),t.getDate())}function n(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}function r(i,s){return function(){return s!==e&&t.fn.datepicker.deprecated(s),this[i].apply(this,arguments)}}var o,a=(o={get:function(t){return this.slice(t)[0]},contains:function(t){for(var e=t&&t.valueOf(),i=0,s=this.length;i<s;i++)if(0<=this[i].valueOf()-e&&this[i].valueOf()-e<864e5)return i;return-1},remove:function(t){this.splice(t,1)},replace:function(e){e&&(t.isArray(e)||(e=[e]),this.clear(),this.push.apply(this,e))},clear:function(){this.length=0},copy:function(){var t=new a;return t.replace(this),t}},function(){var e=[];return e.push.apply(e,arguments),t.extend(e,o),e}),l=function(e,i){t.data(e,"datepicker",this),this._process_options(i),this.dates=new a,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=t(e),this.isInput=this.element.is("input"),this.inputField=this.isInput?this.element:this.element.find("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.component&&0===this.component.length&&(this.component=!1),this.isInline=!this.component&&this.element.is("div"),this.picker=t(m.template),this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow),this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(t,e){return Number(e)+1}),this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled}),this._allow_update=!1,this.setViewMode(this.o.startView),this._allow_update=!0,this.fillDow(),this.fillMonths(),this.update(),this.isInline&&this.show()};l.prototype={constructor:l,_resolveViewName:function(e){return t.each(m.viewModes,function(i,s){if(e===i||-1!==t.inArray(e,s.names))return e=i,!1}),e},_resolveDaysOfWeek:function(e){return t.isArray(e)||(e=e.split(/[,\s]*/)),t.map(e,Number)},_check_template:function(i){try{return i!==e&&""!==i&&((i.match(/[<>]/g)||[]).length<=0||t(i).length>0)}catch(t){return!1}},_process_options:function(e){this._o=t.extend({},this._o,e);var n=this.o=t.extend({},this._o),r=n.language;f[r]||(r=r.split("-")[0],f[r]||(r=c.language)),n.language=r,n.startView=this._resolveViewName(n.startView),n.minViewMode=this._resolveViewName(n.minViewMode),n.maxViewMode=this._resolveViewName(n.maxViewMode),n.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,n.startView)),!0!==n.multidate&&(n.multidate=Number(n.multidate)||!1,!1!==n.multidate&&(n.multidate=Math.max(0,n.multidate))),n.multidateSeparator=String(n.multidateSeparator),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var o=m.parseFormat(n.format);n.startDate!==-1/0&&(n.startDate?n.startDate instanceof Date?n.startDate=this._local_to_utc(this._zero_time(n.startDate)):n.startDate=m.parseDate(n.startDate,o,n.language,n.assumeNearbyYear):n.startDate=-1/0),n.endDate!==1/0&&(n.endDate?n.endDate instanceof Date?n.endDate=this._local_to_utc(this._zero_time(n.endDate)):n.endDate=m.parseDate(n.endDate,o,n.language,n.assumeNearbyYear):n.endDate=1/0),n.daysOfWeekDisabled=this._resolveDaysOfWeek(n.daysOfWeekDisabled||[]),n.daysOfWeekHighlighted=this._resolveDaysOfWeek(n.daysOfWeekHighlighted||[]),n.datesDisabled=n.datesDisabled||[],t.isArray(n.datesDisabled)||(n.datesDisabled=n.datesDisabled.split(",")),n.datesDisabled=t.map(n.datesDisabled,function(t){return m.parseDate(t,o,n.language,n.assumeNearbyYear)});var a=String(n.orientation).toLowerCase().split(/\s+/g),l=n.orientation.toLowerCase();if(a=t.grep(a,function(t){return/^auto|left|right|top|bottom$/.test(t)}),n.orientation={x:"auto",y:"auto"},l&&"auto"!==l)if(1===a.length)switch(a[0]){case"top":case"bottom":n.orientation.y=a[0];break;case"left":case"right":n.orientation.x=a[0]}else l=t.grep(a,function(t){return/^left|right$/.test(t)}),n.orientation.x=l[0]||"auto",l=t.grep(a,function(t){return/^top|bottom$/.test(t)}),n.orientation.y=l[0]||"auto";if(n.defaultViewDate instanceof Date||"string"==typeof n.defaultViewDate)n.defaultViewDate=m.parseDate(n.defaultViewDate,o,n.language,n.assumeNearbyYear);else if(n.defaultViewDate){var h=n.defaultViewDate.year||(new Date).getFullYear(),d=n.defaultViewDate.month||0,u=n.defaultViewDate.day||1;n.defaultViewDate=i(h,d,u)}else n.defaultViewDate=s()},_events:[],_secondaryEvents:[],_applyEvents:function(t){for(var i,s,n,r=0;r<t.length;r++)i=t[r][0],2===t[r].length?(s=e,n=t[r][1]):3===t[r].length&&(s=t[r][1],n=t[r][2]),i.on(n,s)},_unapplyEvents:function(t){for(var i,s,n,r=0;r<t.length;r++)i=t[r][0],2===t[r].length?(n=e,s=t[r][1]):3===t[r].length&&(n=t[r][1],s=t[r][2]),i.off(s,n)},_buildEvents:function(){var e={keyup:t.proxy(function(e){-1===t.inArray(e.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:t.proxy(this.keydown,this),paste:t.proxy(this.paste,this)};!0===this.o.showOnFocus&&(e.focus=t.proxy(this.show,this)),this.isInput?this._events=[[this.element,e]]:this.component&&this.inputField.length?this._events=[[this.inputField,e],[this.component,{click:t.proxy(this.show,this)}]]:this._events=[[this.element,{click:t.proxy(this.show,this),keydown:t.proxy(this.keydown,this)}]],this._events.push([this.element,"*",{blur:t.proxy(function(t){this._focused_from=t.target},this)}],[this.element,{blur:t.proxy(function(t){this._focused_from=t.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":t.proxy(function(t){this.update(t.date)},this)}]),this._secondaryEvents=[[this.picker,{click:t.proxy(this.click,this)}],[this.picker,".prev, .next",{click:t.proxy(this.navArrowsClick,this)}],[this.picker,".day:not(.disabled)",{click:t.proxy(this.dayCellClick,this)}],[t(window),{resize:t.proxy(this.place,this)}],[t(document),{"mousedown touchstart":t.proxy(function(t){this.element.is(t.target)||this.element.find(t.target).length||this.picker.is(t.target)||this.picker.find(t.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(e,i){var s=i||this.dates.get(-1),n=this._utc_to_local(s);this.element.trigger({type:e,date:n,viewMode:this.viewMode,dates:t.map(this.dates,this._utc_to_local),format:t.proxy(function(t,e){0===arguments.length?(t=this.dates.length-1,e=this.o.format):"string"==typeof t&&(e=t,t=this.dates.length-1),e=e||this.o.format;var i=this.dates.get(t);return m.formatDate(i,e,this.o.language)},this)})},show:function(){if(!(this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&t(this.element).blur(),this},hide:function(){return this.isInline||!this.picker.is(":visible")?this:(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.setViewMode(this.o.startView),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide"),this)},destroy:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(e){var i;if(e.originalEvent.clipboardData&&e.originalEvent.clipboardData.types&&-1!==t.inArray("text/plain",e.originalEvent.clipboardData.types))i=e.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;i=window.clipboardData.getData("Text")}this.setDate(i),this.update(),e.preventDefault()},_utc_to_local:function(t){if(!t)return t;var e=new Date(t.getTime()+6e4*t.getTimezoneOffset());return e.getTimezoneOffset()!==t.getTimezoneOffset()&&(e=new Date(t.getTime()+6e4*e.getTimezoneOffset())),e},_local_to_utc:function(t){return t&&new Date(t.getTime()-6e4*t.getTimezoneOffset())},_zero_time:function(t){return t&&new Date(t.getFullYear(),t.getMonth(),t.getDate())},_zero_utc_time:function(t){return t&&i(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())},getDates:function(){return t.map(this.dates,this._utc_to_local)},getUTCDates:function(){return t.map(this.dates,function(t){return new Date(t)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var t=this.dates.get(-1);return t!==e?new Date(t):null},clearDates:function(){this.inputField.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var e=t.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var e=t.isArray(arguments[0])?arguments[0]:arguments;return this.setDates.apply(this,t.map(e,this._utc_to_local)),this},setDate:r("setDates"),setUTCDate:r("setUTCDates"),remove:r("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),setValue:function(){var t=this.getFormattedDate();return this.inputField.val(t),this},getFormattedDate:function(i){i===e&&(i=this.o.format);var s=this.o.language;return t.map(this.dates,function(t){return m.formatDate(t,i,s)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(t){return this._process_options({startDate:t}),this.update(),this.updateNavArrows(),this},getEndDate:function(){return this.o.endDate},setEndDate:function(t){return this._process_options({endDate:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(t){return this._process_options({daysOfWeekDisabled:t}),this.update(),this},setDaysOfWeekHighlighted:function(t){return this._process_options({daysOfWeekHighlighted:t}),this.update(),this},setDatesDisabled:function(t){return this._process_options({datesDisabled:t}),this.update(),this},place:function(){if(this.isInline)return this;var e=this.picker.outerWidth(),i=this.picker.outerHeight(),s=t(this.o.container),n=s.width(),r="body"===this.o.container?t(document).scrollTop():s.scrollTop(),o=s.offset(),a=[0];this.element.parents().each(function(){var e=t(this).css("z-index");"auto"!==e&&0!==Number(e)&&a.push(Number(e))});var l=Math.max.apply(Math,a)+this.o.zIndexOffset,h=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),u=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),c=h.left-o.left,p=h.top-o.top;"body"!==this.o.container&&(p+=r),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(c-=e-u)):h.left<0?(this.picker.addClass("datepicker-orient-left"),c-=h.left-10):c+e>n?(this.picker.addClass("datepicker-orient-right"),c+=u-e):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left");var f=this.o.orientation.y;if("auto"===f&&(f=-r+p-i<0?"bottom":"top"),this.picker.addClass("datepicker-orient-"+f),"top"===f?p-=i+parseInt(this.picker.css("padding-top")):p+=d,this.o.rtl){var m=n-(c+u);this.picker.css({top:p,right:m,zIndex:l})}else this.picker.css({top:p,left:c,zIndex:l});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var e=this.dates.copy(),i=[],s=!1;return arguments.length?(t.each(arguments,t.proxy(function(t,e){e instanceof Date&&(e=this._local_to_utc(e)),i.push(e)},this)),s=!0):(i=(i=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?i.split(this.o.multidateSeparator):[i],delete this.element.data().date),i=t.map(i,t.proxy(function(t){return m.parseDate(t,this.o.format,this.o.language,this.o.assumeNearbyYear)},this)),i=t.grep(i,t.proxy(function(t){return!this.dateWithinRange(t)||!t},this),!0),this.dates.replace(i),this.o.updateViewDate&&(this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate),s?(this.setValue(),this.element.change()):this.dates.length&&String(e)!==String(this.dates)&&s&&(this._trigger("changeDate"),this.element.change()),!this.dates.length&&e.length&&(this._trigger("clearDate"),this.element.change()),this.fill(),this},fillDow:function(){if(this.o.showWeekDays){var e=this.o.weekStart,i="<tr>";for(this.o.calendarWeeks&&(i+='<th class="cw">&#160;</th>');e<this.o.weekStart+7;)i+='<th class="dow',-1!==t.inArray(e,this.o.daysOfWeekDisabled)&&(i+=" disabled"),i+='">'+f[this.o.language].daysMin[e++%7]+"</th>";i+="</tr>",this.picker.find(".datepicker-days thead").append(i)}},fillMonths:function(){for(var t,e=this._utc_to_local(this.viewDate),i="",s=0;s<12;s++)t=e&&e.getMonth()===s?" focused":"",i+='<span class="month'+t+'">'+f[this.o.language].monthsShort[s]+"</span>";this.picker.find(".datepicker-months td").html(i)},setRange:function(e){e&&e.length?this.range=t.map(e,function(t){return t.valueOf()}):delete this.range,this.fill()},getClassNames:function(e){var i=[],r=this.viewDate.getUTCFullYear(),o=this.viewDate.getUTCMonth(),a=s();return e.getUTCFullYear()<r||e.getUTCFullYear()===r&&e.getUTCMonth()<o?i.push("old"):(e.getUTCFullYear()>r||e.getUTCFullYear()===r&&e.getUTCMonth()>o)&&i.push("new"),this.focusDate&&e.valueOf()===this.focusDate.valueOf()&&i.push("focused"),this.o.todayHighlight&&n(e,a)&&i.push("today"),-1!==this.dates.contains(e)&&i.push("active"),this.dateWithinRange(e)||i.push("disabled"),this.dateIsDisabled(e)&&i.push("disabled","disabled-date"),-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekHighlighted)&&i.push("highlighted"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&i.push("range"),-1!==t.inArray(e.valueOf(),this.range)&&i.push("selected"),e.valueOf()===this.range[0]&&i.push("range-start"),e.valueOf()===this.range[this.range.length-1]&&i.push("range-end")),i},_fill_yearsView:function(i,s,n,r,o,a,l){for(var h,d,u,c="",p=n/10,f=this.picker.find(i),m=Math.floor(r/n)*n,g=m+9*p,v=Math.floor(this.viewDate.getFullYear()/p)*p,y=t.map(this.dates,function(t){return Math.floor(t.getUTCFullYear()/p)*p}),_=m-p;_<=g+p;_+=p)h=[s],d=null,_===m-p?h.push("old"):_===g+p&&h.push("new"),-1!==t.inArray(_,y)&&h.push("active"),(_<o||_>a)&&h.push("disabled"),_===v&&h.push("focused"),l!==t.noop&&(u=l(new Date(_,0,1)),u===e?u={}:"boolean"==typeof u?u={enabled:u}:"string"==typeof u&&(u={classes:u}),!1===u.enabled&&h.push("disabled"),u.classes&&(h=h.concat(u.classes.split(/\s+/))),u.tooltip&&(d=u.tooltip)),c+='<span class="'+h.join(" ")+'"'+(d?' title="'+d+'"':"")+">"+_+"</span>";f.find(".datepicker-switch").text(m+"-"+g),f.find("td").html(c)},fill:function(){var s,n,r=new Date(this.viewDate),o=r.getUTCFullYear(),a=r.getUTCMonth(),l=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,h=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,d=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,u=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,c=f[this.o.language].today||f.en.today||"",p=f[this.o.language].clear||f.en.clear||"",g=f[this.o.language].titleFormat||f.en.titleFormat;if(!isNaN(o)&&!isNaN(a)){this.picker.find(".datepicker-days .datepicker-switch").text(m.formatDate(r,g,this.o.language)),this.picker.find("tfoot .today").text(c).css("display",!0===this.o.todayBtn||"linked"===this.o.todayBtn?"table-cell":"none"),this.picker.find("tfoot .clear").text(p).css("display",!0===this.o.clearBtn?"table-cell":"none"),this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"==typeof this.o.title&&""!==this.o.title?"table-cell":"none"),this.updateNavArrows(),this.fillMonths();var v=i(o,a,0),y=v.getUTCDate();v.setUTCDate(y-(v.getUTCDay()-this.o.weekStart+7)%7);var _=new Date(v);v.getUTCFullYear()<100&&_.setUTCFullYear(v.getUTCFullYear()),_.setUTCDate(_.getUTCDate()+42),_=_.valueOf();for(var b,w,x=[];v.valueOf()<_;){if((b=v.getUTCDay())===this.o.weekStart&&(x.push("<tr>"),this.o.calendarWeeks)){var C=new Date(+v+(this.o.weekStart-b-7)%7*864e5),k=new Date(Number(C)+(11-C.getUTCDay())%7*864e5),E=new Date(Number(E=i(k.getUTCFullYear(),0,1))+(11-E.getUTCDay())%7*864e5),T=(k-E)/864e5/7+1;x.push('<td class="cw">'+T+"</td>")}(w=this.getClassNames(v)).push("day");var S=v.getUTCDate();this.o.beforeShowDay!==t.noop&&((n=this.o.beforeShowDay(this._utc_to_local(v)))===e?n={}:"boolean"==typeof n?n={enabled:n}:"string"==typeof n&&(n={classes:n}),!1===n.enabled&&w.push("disabled"),n.classes&&(w=w.concat(n.classes.split(/\s+/))),n.tooltip&&(s=n.tooltip),n.content&&(S=n.content)),w=t.isFunction(t.uniqueSort)?t.uniqueSort(w):t.unique(w),x.push('<td class="'+w.join(" ")+'"'+(s?' title="'+s+'"':"")+' data-date="'+v.getTime().toString()+'">'+S+"</td>"),s=null,b===this.o.weekEnd&&x.push("</tr>"),v.setUTCDate(v.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(x.join(""));var D=f[this.o.language].monthsTitle||f.en.monthsTitle||"Months",O=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?D:o).end().find("tbody span").removeClass("active");if(t.each(this.dates,function(t,e){e.getUTCFullYear()===o&&O.eq(e.getUTCMonth()).addClass("active")}),(o<l||o>d)&&O.addClass("disabled"),o===l&&O.slice(0,h).addClass("disabled"),o===d&&O.slice(u+1).addClass("disabled"),this.o.beforeShowMonth!==t.noop){var A=this;t.each(O,function(i,s){var n=new Date(o,i,1),r=A.o.beforeShowMonth(n);r===e?r={}:"boolean"==typeof r?r={enabled:r}:"string"==typeof r&&(r={classes:r}),!1!==r.enabled||t(s).hasClass("disabled")||t(s).addClass("disabled"),r.classes&&t(s).addClass(r.classes),r.tooltip&&t(s).prop("title",r.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,o,l,d,this.o.beforeShowYear),this._fill_yearsView(".datepicker-decades","decade",100,o,l,d,this.o.beforeShowDecade),this._fill_yearsView(".datepicker-centuries","century",1e3,o,l,d,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var t,e,i=new Date(this.viewDate),s=i.getUTCFullYear(),n=i.getUTCMonth(),r=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,o=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,a=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,l=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,h=1;switch(this.viewMode){case 0:t=s<=r&&n<=o,e=s>=a&&n>=l;break;case 4:h*=10;case 3:h*=10;case 2:h*=10;case 1:t=Math.floor(s/h)*h<=r,e=Math.floor(s/h)*h+h>=a}this.picker.find(".prev").toggleClass("disabled",t),this.picker.find(".next").toggleClass("disabled",e)}},click:function(e){var n,r,o,a;e.preventDefault(),e.stopPropagation(),(n=t(e.target)).hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1),n.hasClass("today")&&!n.hasClass("day")&&(this.setViewMode(0),this._setDate(s(),"linked"===this.o.todayBtn?null:"view")),n.hasClass("clear")&&this.clearDates(),n.hasClass("disabled")||(n.hasClass("month")||n.hasClass("year")||n.hasClass("decade")||n.hasClass("century"))&&(this.viewDate.setUTCDate(1),r=1,1===this.viewMode?(a=n.parent().find("span").index(n),o=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(a)):(a=0,o=Number(n.text()),this.viewDate.setUTCFullYear(o)),this._trigger(m.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(i(o,a,r)):(this.setViewMode(this.viewMode-1),this.fill())),this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus(),delete this._focused_from},dayCellClick:function(e){var i=t(e.currentTarget).data("date"),s=new Date(i);this.o.updateViewDate&&(s.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),s.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate)),this._setDate(s)},navArrowsClick:function(e){var i=t(e.currentTarget).hasClass("prev")?-1:1;0!==this.viewMode&&(i*=12*m.viewModes[this.viewMode].navStep),this.viewDate=this.moveMonth(this.viewDate,i),this._trigger(m.viewModes[this.viewMode].e,this.viewDate),this.fill()},_toggle_multidate:function(t){var e=this.dates.contains(t);if(t||this.dates.clear(),-1!==e?(!0===this.o.multidate||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(e):!1===this.o.multidate?(this.dates.clear(),this.dates.push(t)):this.dates.push(t),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(t,e){e&&"date"!==e||this._toggle_multidate(t&&new Date(t)),(!e&&this.o.updateViewDate||"view"===e)&&(this.viewDate=t&&new Date(t)),this.fill(),this.setValue(),e&&"view"===e||this._trigger("changeDate"),this.inputField.trigger("change"),!this.o.autoclose||e&&"date"!==e||this.hide()},moveDay:function(t,e){var i=new Date(t);return i.setUTCDate(t.getUTCDate()+e),i},moveWeek:function(t,e){return this.moveDay(t,7*e)},moveMonth:function(t,e){if(!(i=t)||isNaN(i.getTime()))return this.o.defaultViewDate;var i;if(!e)return t;var s,n,r=new Date(t.valueOf()),o=r.getUTCDate(),a=r.getUTCMonth(),l=Math.abs(e);if(e=e>0?1:-1,1===l)n=-1===e?function(){return r.getUTCMonth()===a}:function(){return r.getUTCMonth()!==s},s=a+e,r.setUTCMonth(s),s=(s+12)%12;else{for(var h=0;h<l;h++)r=this.moveMonth(r,e);s=r.getUTCMonth(),r.setUTCDate(o),n=function(){return s!==r.getUTCMonth()}}for(;n();)r.setUTCDate(--o),r.setUTCMonth(s);return r},moveYear:function(t,e){return this.moveMonth(t,12*e)},moveAvailableDate:function(t,e,i){do{if(t=this[i](t,e),!this.dateWithinRange(t))return!1;i="moveDay"}while(this.dateIsDisabled(t));return t},weekOfDateIsDisabled:function(e){return-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(e){return this.weekOfDateIsDisabled(e)||t.grep(this.o.datesDisabled,function(t){return n(e,t)}).length>0},dateWithinRange:function(t){return t>=this.o.startDate&&t<=this.o.endDate},keydown:function(t){if(this.picker.is(":visible")){var e,i,s=!1,n=this.focusDate||this.viewDate;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault(),t.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;e=37===t.keyCode||38===t.keyCode?-1:1,0===this.viewMode?t.ctrlKey?(i=this.moveAvailableDate(n,e,"moveYear"))&&this._trigger("changeYear",this.viewDate):t.shiftKey?(i=this.moveAvailableDate(n,e,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===t.keyCode||39===t.keyCode?i=this.moveAvailableDate(n,e,"moveDay"):this.weekOfDateIsDisabled(n)||(i=this.moveAvailableDate(n,e,"moveWeek")):1===this.viewMode?(38!==t.keyCode&&40!==t.keyCode||(e*=4),i=this.moveAvailableDate(n,e,"moveMonth")):2===this.viewMode&&(38!==t.keyCode&&40!==t.keyCode||(e*=4),i=this.moveAvailableDate(n,e,"moveYear")),i&&(this.focusDate=this.viewDate=i,this.setValue(),this.fill(),t.preventDefault());break;case 13:if(!this.o.forceParse)break;n=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(n),s=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(t.preventDefault(),t.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}s&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else 40!==t.keyCode&&27!==t.keyCode||(this.show(),t.stopPropagation())},setViewMode:function(t){this.viewMode=t,this.picker.children("div").hide().filter(".datepicker-"+m.viewModes[this.viewMode].clsName).show(),this.updateNavArrows(),this._trigger("changeViewMode",new Date(this.viewDate))}};var h=function(e,i){t.data(e,"datepicker",this),this.element=t(e),this.inputs=t.map(i.inputs,function(t){return t.jquery?t[0]:t}),delete i.inputs,this.keepEmptyValues=i.keepEmptyValues,delete i.keepEmptyValues,u.call(t(this.inputs),i).on("changeDate",t.proxy(this.dateUpdated,this)),this.pickers=t.map(this.inputs,function(e){return t.data(e,"datepicker")}),this.updateDates()};h.prototype={updateDates:function(){this.dates=t.map(this.pickers,function(t){return t.getUTCDate()}),this.updateRanges()},updateRanges:function(){var e=t.map(this.dates,function(t){return t.valueOf()});t.each(this.pickers,function(t,i){i.setRange(e)})},dateUpdated:function(i){if(!this.updating){this.updating=!0;var s=t.data(i.target,"datepicker");if(s!==e){var n=s.getUTCDate(),r=this.keepEmptyValues,o=t.inArray(i.target,this.inputs),a=o-1,l=o+1,h=this.inputs.length;if(-1!==o){if(t.each(this.pickers,function(t,e){e.getUTCDate()||e!==s&&r||e.setUTCDate(n)}),n<this.dates[a])for(;a>=0&&n<this.dates[a];)this.pickers[a--].setUTCDate(n);else if(n>this.dates[l])for(;l<h&&n>this.dates[l];)this.pickers[l++].setUTCDate(n);this.updateDates(),delete this.updating}}}},destroy:function(){t.map(this.pickers,function(t){t.destroy()}),t(this.inputs).off("changeDate",this.dateUpdated),delete this.element.data().datepicker},remove:r("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var d=t.fn.datepicker,u=function(i){var s,n=Array.apply(null,arguments);if(n.shift(),this.each(function(){var e=t(this),r=e.data("datepicker"),o="object"==typeof i&&i;if(!r){var a=function(e,i){function s(t,e){return e.toLowerCase()}var n,r=t(e).data(),o={},a=new RegExp("^"+i.toLowerCase()+"([A-Z])");i=new RegExp("^"+i.toLowerCase());for(var l in r)i.test(l)&&(n=l.replace(a,s),o[n]=r[l]);return o}(this,"date"),d=function(e){var i={};if(f[e]||(e=e.split("-")[0],f[e])){var s=f[e];return t.each(p,function(t,e){e in s&&(i[e]=s[e])}),i}}(t.extend({},c,a,o).language),u=t.extend({},c,d,a,o);e.hasClass("input-daterange")||u.inputs?(t.extend(u,{inputs:u.inputs||e.find("input").toArray()}),r=new h(this,u)):r=new l(this,u),e.data("datepicker",r)}"string"==typeof i&&"function"==typeof r[i]&&(s=r[i].apply(r,n))}),s===e||s instanceof l||s instanceof h)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+i+" function)");return s};t.fn.datepicker=u;var c=t.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:t.noop,beforeShowMonth:t.noop,beforeShowYear:t.noop,beforeShowDecade:t.noop,beforeShowCentury:t.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},p=t.fn.datepicker.locale_opts=["format","rtl","weekStart"];t.fn.datepicker.Constructor=l;var f=t.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},m={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1e3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(t){if("function"==typeof t.toValue&&"function"==typeof t.toDisplay)return t;var e=t.replace(this.validParts,"\0").split("\0"),i=t.match(this.validParts);if(!e||!e.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:e,parts:i}},parseDate:function(i,n,r,o){function a(){var t=this.slice(0,h[c].length),e=h[c].slice(0,t.length);return t.toLowerCase()===e.toLowerCase()}if(!i)return e;if(i instanceof Date)return i;if("string"==typeof n&&(n=m.parseFormat(n)),n.toValue)return n.toValue(i,n,r);var h,d,u,c,p,g={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},v={yesterday:"-1d",today:"+0d",tomorrow:"+1d"};if(i in v&&(i=v[i]),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(i)){for(h=i.match(/([\-+]\d+)([dmwy])/gi),i=new Date,c=0;c<h.length;c++)d=h[c].match(/([\-+]\d+)([dmwy])/i),u=Number(d[1]),p=g[d[2].toLowerCase()],i=l.prototype[p](i,u);return l.prototype._zero_utc_time(i)}h=i&&i.match(this.nonpunctuation)||[];var y,_,b={},w=["yyyy","yy","M","MM","m","mm","d","dd"],x={yyyy:function(t,e){return t.setUTCFullYear(o?(i=e,!0===(s=o)&&(s=10),i<100&&(i+=2e3)>(new Date).getFullYear()+s&&(i-=100),i):e);var i,s},m:function(t,e){if(isNaN(t))return t;for(e-=1;e<0;)e+=12;for(e%=12,t.setUTCMonth(e);t.getUTCMonth()!==e;)t.setUTCDate(t.getUTCDate()-1);return t},d:function(t,e){return t.setUTCDate(e)}};x.yy=x.yyyy,x.M=x.MM=x.mm=x.m,x.dd=x.d,i=s();var C=n.parts.slice();if(h.length!==C.length&&(C=t(C).filter(function(e,i){return-1!==t.inArray(i,w)}).toArray()),h.length===C.length){var k,E,T;for(c=0,k=C.length;c<k;c++){if(y=parseInt(h[c],10),d=C[c],isNaN(y))switch(d){case"MM":_=t(f[r].months).filter(a),y=t.inArray(_[0],f[r].months)+1;break;case"M":_=t(f[r].monthsShort).filter(a),y=t.inArray(_[0],f[r].monthsShort)+1}b[d]=y}for(c=0;c<w.length;c++)T=w[c],T in b&&!isNaN(b[T])&&(E=new Date(i),x[T](E,b[T]),isNaN(E)||(i=E))}return i},formatDate:function(e,i,s){if(!e)return"";if("string"==typeof i&&(i=m.parseFormat(i)),i.toDisplay)return i.toDisplay(e,i,s);var n={d:e.getUTCDate(),D:f[s].daysShort[e.getUTCDay()],DD:f[s].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:f[s].monthsShort[e.getUTCMonth()],MM:f[s].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};n.dd=(n.d<10?"0":"")+n.d,n.mm=(n.m<10?"0":"")+n.m,e=[];for(var r=t.extend([],i.separators),o=0,a=i.parts.length;o<=a;o++)r.length&&e.push(r.shift()),e.push(n[i.parts[o]]);return e.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+c.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+c.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};m.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+m.headTemplate+"<tbody></tbody>"+m.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+"</table></div></div>",t.fn.datepicker.DPGlobal=m,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=d,this},t.fn.datepicker.version="1.7.1",t.fn.datepicker.deprecated=function(t){var e=window.console;e&&e.warn&&e.warn("DEPRECATED: "+t)},t(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(e){var i=t(this);i.data("datepicker")||(e.preventDefault(),u.call(i,"show"))}),t(function(){u.call(t('[data-provide="datepicker-inline"]'))})});"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},windowIsDefined="object"===("undefined"==typeof window?"undefined":_typeof(window));!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var e;try{e=require("jquery")}catch(t){e=null}module.exports=t(e)}else window&&(window.Slider=t(window.jQuery))}(function(t){var e,i="bootstrapSlider";return windowIsDefined&&!window.console&&(window.console={}),windowIsDefined&&!window.console.log&&(window.console.log=function(){}),windowIsDefined&&!window.console.warn&&(window.console.warn=function(){}),function(t){function e(){}var i=Array.prototype.slice;!function(t){if(t){var s="undefined"==typeof console?e:function(t){console.error(t)};t.bridget=function(e,n){var r,o,a;(a=n).prototype.option||(a.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))}),r=e,o=n,t.fn[r]=function(e){if("string"==typeof e){for(var n=i.call(arguments,1),a=0,l=this.length;l>a;a++){var h=this[a],d=t.data(h,r);if(d)if(t.isFunction(d[e])&&"_"!==e.charAt(0)){var u=d[e].apply(d,n);if(void 0!==u&&u!==d)return u}else s("no such method '"+e+"' for "+r+" instance");else s("cannot call methods on "+r+" prior to initialization; attempted to call '"+e+"'")}return this}var c=this.map(function(){var i=t.data(this,r);return i?(i.option(e),i._init()):(i=new o(this,e),t.data(this,r,i)),t(this)});return!c||c.length>1?c:c[0]}},t.bridget}}(t)}(t),function(t){function s(e,i){function s(t,e){var i="data-slider-"+e.replace(/_/g,"-"),s=t.getAttribute(i);try{return JSON.parse(s)}catch(t){return s}}this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),i=i||{};for(var n=Object.keys(this.defaultOptions),o=0;o<n.length;o++){var a=n[o],l=i[a];l=null!==(l=void 0!==l?l:s(this.element,a))?l:this.defaultOptions[a],this.options||(this.options={}),this.options[a]=l}"auto"===this.options.rtl&&(this.options.rtl="rtl"===window.getComputedStyle(this.element).direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var h,d,u,c,p,f=this.element.style.width,m=!1,g=this.element.parentNode;if(this.sliderElem)m=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var v=document.createElement("div");v.className="slider-track",(d=document.createElement("div")).className="slider-track-low",(h=document.createElement("div")).className="slider-selection",(u=document.createElement("div")).className="slider-track-high",(c=document.createElement("div")).className="slider-handle min-slider-handle",c.setAttribute("role","slider"),c.setAttribute("aria-valuemin",this.options.min),c.setAttribute("aria-valuemax",this.options.max),(p=document.createElement("div")).className="slider-handle max-slider-handle",p.setAttribute("role","slider"),p.setAttribute("aria-valuemin",this.options.min),p.setAttribute("aria-valuemax",this.options.max),v.appendChild(d),v.appendChild(h),v.appendChild(u),this.rangeHighlightElements=[];var y=this.options.rangeHighlights;if(Array.isArray(y)&&y.length>0)for(var _=0;_<y.length;_++){var b=document.createElement("div"),w=y[_].class||"";b.className="slider-rangeHighlight slider-selection "+w,this.rangeHighlightElements.push(b),v.appendChild(b)}var x=Array.isArray(this.options.labelledby);if(x&&this.options.labelledby[0]&&c.setAttribute("aria-labelledby",this.options.labelledby[0]),x&&this.options.labelledby[1]&&p.setAttribute("aria-labelledby",this.options.labelledby[1]),!x&&this.options.labelledby&&(c.setAttribute("aria-labelledby",this.options.labelledby),p.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&this.options.ticks.length>0){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",o=0;o<this.options.ticks.length;o++){var C=document.createElement("div");if(C.className="slider-tick",this.options.ticks_tooltip){var k=this._addTickListener(),E=k.addMouseEnter(this,C,o),T=k.addMouseLeave(this,C);this.ticksCallbackMap[o]={mouseEnter:E,mouseLeave:T}}this.ticks.push(C),this.ticksContainer.appendChild(C)}h.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&this.options.ticks_labels.length>0)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",o=0;o<this.options.ticks_labels.length;o++){var S=document.createElement("div"),D=0===this.options.ticks_positions.length,O=this.options.reversed&&D?this.options.ticks_labels.length-(o+1):o;S.className="slider-tick-label",S.innerHTML=this.options.ticks_labels[O],this.tickLabels.push(S),this.tickLabelContainer.appendChild(S)}var A=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var i=document.createElement("div");i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},M=document.createElement("div");M.className="tooltip tooltip-main",M.setAttribute("role","presentation"),A(M);var N=document.createElement("div");N.className="tooltip tooltip-min",N.setAttribute("role","presentation"),A(N);var I=document.createElement("div");I.className="tooltip tooltip-max",I.setAttribute("role","presentation"),A(I),this.sliderElem.appendChild(v),this.sliderElem.appendChild(M),this.sliderElem.appendChild(N),this.sliderElem.appendChild(I),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(c),this.sliderElem.appendChild(p),g.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),r[this.options.scale]&&(this.options.scale=r[this.options.scale]),!0===m&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach(function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top"),this._removeClass(t,"right"),this._removeClass(t,"left"),this._removeClass(t,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=f,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&this.options.ticks.length>0&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=d||this.trackLow,this.trackSelection=h||this.trackSelection,this.trackHigh=u||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):("after"===this.options.selection||"before"===this.options.selection)&&(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=c||this.handle1,this.handle2=p||this.handle2,!0===m)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),o=0;o<this.ticks.length;o++)this._removeClass(this.ticks[o],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),o=0;o<this.ticks.length;o++)this._addClass(this.ticks[o],this.options.handle);if(this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable){var P=!1;try{var F=Object.defineProperty({},"passive",{get:function(){P=!0}});window.addEventListener("test",null,F)}catch(t){}var j=!!P&&{passive:!0};this.sliderElem.addEventListener("touchstart",this.touchstart,j),this.sliderElem.addEventListener("touchmove",this.touchmove,j)}if(this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip)this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide");else if("always"===this.options.tooltip)this._showTooltip(),this._alwaysShowTooltip=!0;else{if(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip){var L=this._addTickListener(),R=L.addMouseEnter(this,this.handle1),$=L.addMouseLeave(this,this.handle1);this.handleCallbackMap.handle1={mouseEnter:R,mouseLeave:$},R=L.addMouseEnter(this,this.handle2),$=L.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:R,mouseLeave:$}}else this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1);this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)}this.options.enabled?this.enable():this.disable()}var n=function(t){return"Invalid input value '"+t+"' passed in"},r={linear:{toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(this.options.ticks_positions.length>0){for(var s,n,r,o=0,a=1;a<this.options.ticks_positions.length;a++)if(t<=this.options.ticks_positions[a]){s=this.options.ticks[a-1],r=this.options.ticks_positions[a-1],n=this.options.ticks[a],o=this.options.ticks_positions[a];break}e=s+(t-r)/(o-r)*(n-s),i=!1}var l=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return l<this.options.min?this.options.min:l>this.options.max?this.options.max:l},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(this.options.ticks_positions.length>0){for(var e,i,s,n=0,r=0;r<this.options.ticks.length;r++)if(t<=this.options.ticks[r]){e=r>0?this.options.ticks[r-1]:0,s=r>0?this.options.ticks_positions[r-1]:0,i=this.options.ticks[r],n=this.options.ticks_positions[r];break}if(r>0)return s+(t-e)/(i-e)*(n-s)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=0===this.options.min?0:Math.log(this.options.min),i=Math.log(this.options.max),s=Math.exp(e+(i-e)*t/100);return Math.round(s)===this.options.max?this.options.max:(s=this.options.min+Math.round((s-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:s>this.options.max?this.options.max:s},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var e=Math.log(this.options.max),i=0===this.options.min?0:Math.log(this.options.min);return 100*((0===t?0:Math.log(t))-i)/(e-i)}}};if((e=function(t,e){return s.call(this,t,e),this}).prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t||(t=0);var s=this.getValue();this._state.value=this._validateInputValue(t);var n=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=n(this._state.value[0]),this._state.value[1]=n(this._state.value[1]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=n(this._state.value),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();var r=this.options.range?this._state.value:this._state.value[0];return this._setDataVal(r),!0===e&&this._trigger("slide",r),s!==r&&!0===i&&this._trigger("change",{oldValue:s,newValue:r}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(e,i){t?(this.$element.off(e,i),this.$sliderElem.off(e,i)):this._unbindNonQueryEventHandler(e,i)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),s.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},relayout:function(){return this._resize(),this._layout(),this},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1)}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&(this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle2.removeEventListener("focus",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("blur",this.hideTooltip,!1)),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var s=0;s<i.length;s++)if(i[s]===e){i.splice(s,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this._state.over=!1},_setToolTipOnMouseOver:function(t){function e(t,e){return e?[100-t.percentage[0],this.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}var i=this.options.formatter(t?t.value[0]:this._state.value[0]),s=e(t||this._state,this.options.reversed);this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=s[0]+"%"},_addTickListener:function(){return{addMouseEnter:function(t,e,i){var s=function(){var e=t._state,s=i>=0?i:this.attributes["aria-valuenow"].value,n=parseInt(s,10);e.value[0]=n,e.percentage[0]=t.options.ticks_positions[n],t._setToolTipOnMouseOver(e),t._showTooltip()};return e.addEventListener("mouseenter",s,!1),s},addMouseLeave:function(t,e){var i=function(){t._hideTooltip()};return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t,e;if(t=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),isNaN(this.options.formatter(this._state.value[0]))&&this.handle1.setAttribute("aria-valuetext",this.options.formatter(this._state.value[0])),this.handle2.style[this.stylePos]=t[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),isNaN(this.options.formatter(this._state.value[1]))&&this.handle2.setAttribute("aria-valuetext",this.options.formatter(this._state.value[1])),this.rangeHighlightElements.length>0&&Array.isArray(this.options.rangeHighlights)&&this.options.rangeHighlights.length>0)for(var i=0;i<this.options.rangeHighlights.length;i++){var s=this._toPercentage(this.options.rangeHighlights[i].start),n=this._toPercentage(this.options.rangeHighlights[i].end);if(this.options.reversed){var r=100-n;n=100-s,s=r}var o=this._createHighlightRange(s,n);o?"vertical"===this.options.orientation?(this.rangeHighlightElements[i].style.top=o.start+"%",this.rangeHighlightElements[i].style.height=o.size+"%"):(this.options.rtl?this.rangeHighlightElements[i].style.right=o.start+"%":this.rangeHighlightElements[i].style.left=o.start+"%",this.rangeHighlightElements[i].style.width=o.size+"%"):this.rangeHighlightElements[i].style.display="none"}if(Array.isArray(this.options.ticks)&&this.options.ticks.length>0){var a,l="vertical"===this.options.orientation?"height":"width";a="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft";var h=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var d=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[a]=-h/2+"px"),d=this.tickLabelContainer.offsetHeight;else for(u=0;u<this.tickLabelContainer.childNodes.length;u++)this.tickLabelContainer.childNodes[u].offsetHeight>d&&(d=this.tickLabelContainer.childNodes[u].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=d+"px")}for(var u=0;u<this.options.ticks.length;u++){var c=this.options.ticks_positions[u]||this._toPercentage(this.options.ticks[u]);this.options.reversed&&(c=100-c),this.ticks[u].style[this.stylePos]=c+"%",this._removeClass(this.ticks[u],"in-selection"),this.options.range?c>=t[0]&&c<=t[1]&&this._addClass(this.ticks[u],"in-selection"):"after"===this.options.selection&&c>=t[0]?this._addClass(this.ticks[u],"in-selection"):"before"===this.options.selection&&c<=t[0]&&this._addClass(this.ticks[u],"in-selection"),this.tickLabels[u]&&(this.tickLabels[u].style[l]=h+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[u]?(this.tickLabels[u].style.position="absolute",this.tickLabels[u].style[this.stylePos]=c+"%",this.tickLabels[u].style[a]=-h/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[u].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[u].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[a]=this.sliderElem.offsetWidth/2*-1+"px"))}}if(this.options.range){e=this.options.formatter(this._state.value),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%";var p=this.options.formatter(this._state.value[0]);this._setText(this.tooltipInner_min,p);var f=this.options.formatter(this._state.value[1]);this._setText(this.tooltipInner_max,f),this.tooltip_min.style[this.stylePos]=t[0]+"%",this.tooltip_max.style[this.stylePos]=t[1]+"%"}else e=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=t[0]+"%";if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(t[0],t[1])+"%",this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";else{"right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(t[0],t[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(t[0],t[1])+"%":this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";var m=this.tooltip_min.getBoundingClientRect(),g=this.tooltip_max.getBoundingClientRect();"bottom"===this.options.tooltip_position?m.right>g.left?(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):m.right>g.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?t>e?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return t>=0&&100>=t&&e>=0&&100>=e},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var i=Math.abs(this._state.percentage[0]-e),s=Math.abs(this._state.percentage[1]-e);this._state.dragged=s>i?0:1,this._adjustPercentageForRangeSliders(e)}else this._state.dragged=0;this._state.percentage[this._state.dragged]=e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;var n=this._calculateValue();return this._trigger("slideStart",n),this._setDataVal(n),this.setValue(n,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0];this.touchX=e.pageX,this.touchY=e.pageY}else this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){if(this.options.natural_arrow_keys){var s="vertical"===this.options.orientation&&!this.options.reversed,n="horizontal"===this.options.orientation&&this.options.reversed;(s||n)&&(i=-i)}var r=this._state.value[t]+i*this.options.step,o=r/this.options.max*100;if(this._state.keyCtrl=t,this.options.range)this._adjustPercentageForRangeSliders(o),r=[this._state.keyCtrl?this._state.value[0]:r,this._state.keyCtrl?r:this._state.value[1]];return this._trigger("slideStart",r),this._setDataVal(r),this.setValue(r,!0,!0),this._setDataVal(r),this._trigger("slideStop",r),this._layout(),this._pauseEvent(e),delete this._state.keyCtrl,!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this._state.percentage[this._state.dragged]=e,this._layout();var i=this._calculateValue(!0);return this.setValue(i,!0,!0),!1},_touchmove:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0],i=e.pageX-this.touchX,s=e.pageY-this.touchY;this._state.inDrag||("vertical"===this.options.orientation&&5>=i&&i>=-5&&(s>=15||-15>=s)?this._mousedown(t):5>=s&&s>=-5&&(i>=15||-15>=i)&&this._mousedown(t))}},_adjustPercentageForRangeSliders:function(t){if(this.options.range){var e=this._getNumDigitsAfterDecimalPlace(t);e=e?e-1:0;var i=this._applyToFixedAndParseFloat(t,e);0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._state.value[1]/this.options.max*100<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._state.value[0]/this.options.max*100>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus())}},_mouseup:function(){if(!this._state.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!1,!1===this._state.over&&this._hideTooltip();var t=this._calculateValue(!0);return this._layout(),this._setDataVal(t),this._trigger("slideStop",t),!1},_calculateValue:function(t){var e;if(this.options.range?(e=[this.options.min,this.options.max],0!==this._state.percentage[0]&&(e[0]=this._toValue(this._state.percentage[0]),e[0]=this._applyPrecision(e[0])),100!==this._state.percentage[1]&&(e[1]=this._toValue(this._state.percentage[1]),e[1]=this._applyPrecision(e[1]))):(e=this._toValue(this._state.percentage[0]),e=parseFloat(e),e=this._applyPrecision(e)),t){for(var i=[e,1/0],s=0;s<this.options.ticks.length;s++){var n=Math.abs(this.options.ticks[s]-e);n<=i[1]&&(i=[this.options.ticks[s],n])}if(i[1]<=this.options.ticks_snap_bounds)return i[0]}return e},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var i=t.toFixed(e);return parseFloat(i)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=t[this.mousePos]-this._state.offset[this.stylePos];"right"===this.stylePos&&(e=-e);var i=e/this._state.size*100;return i=Math.round(i/this._state.percentage[2])*this._state.percentage[2],this.options.reversed&&(i=100-i),Math.max(0,Math.min(100,i))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(n(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var i=t[e];if("number"!=typeof i)throw new Error(n(i))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(e,i){i=i||0===i?i:void 0;var s=this.eventToCallbackMap[e];if(s&&s.length)for(var n=0;n<s.length;n++){(0,s[n])(i)}t&&this._triggerJQueryEvent(e,i)},_triggerJQueryEvent:function(t,e){var i={type:t,value:e};this.$element.trigger(i),this.$sliderElem.trigger(i)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),s=t.className,n=0;n<i.length;n++){var r=i[n],o=new RegExp("(?:\\s|^)"+r+"(?:\\s|$)");s=s.replace(o," ")}t.className=s.trim()},_addClass:function(t,e){for(var i=e.split(" "),s=t.className,n=0;n<i.length;n++){var r=i[n];new RegExp("(?:\\s|^)"+r+"(?:\\s|$)").test(s)||(s+=" "+r)}t.className=s.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(e,i,s){if(t)t.style(e,i,s);else{var n=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()});e.style[n]=s}},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var t=[this.tooltip,this.tooltip_min,this.tooltip_max];if("vertical"===this.options.orientation){var e,i="left"===(e=this.options.tooltip_position?this.options.tooltip_position:this.options.rtl?"left":"right")?"right":"left";t.forEach(function(t){this._addClass(t,e),t.style[i]="100%"}.bind(this))}else"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))}},t&&t.fn){var o=void 0;t.fn.slider?(windowIsDefined&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),o=i):(t.bridget("slider",e),o="slider"),t.bridget(i,e),t(function(){t("input[data-provide=slider]")[o]()})}}(t),e}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){t.defineOption("fullScreen",!1,function(e,i,s){var n,r;(s==t.Init&&(s=!1),!s!=!i)&&(i?(r=(n=e).getWrapperElement(),n.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:r.style.width,height:r.style.height},r.style.width="",r.style.height="auto",r.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",n.refresh()):function(t){var e=t.getWrapperElement();e.className=e.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var i=t.state.fullScreenRestore;e.style.width=i.width,e.style.height=i.height,window.scrollTo(i.scrollLeft,i.scrollTop),t.refresh()}(e))})}),function(t){function e(){}function i(t){if(!t||"object"!=typeof t)return!1;var e=x(t)||ut;return/object|function/.test(typeof e.Element)?t instanceof e.Element:1===t.nodeType&&"string"==typeof t.nodeName}function s(t){return t===ut||!(!t||!t.Window)&&t instanceof t.Window}function n(t){return!!t&&t instanceof pt}function r(t){return o(t)&&void 0!==typeof t.length&&a(t.splice)}function o(t){return!!t&&"object"==typeof t}function a(t){return"function"==typeof t}function l(t){return"number"==typeof t}function h(t){return"boolean"==typeof t}function d(t){return"string"==typeof t}function u(t){return!!d(t)&&(ct.querySelector(t),!0)}function c(t,e){for(var i in e)t[i]=e[i];return t}function p(t,e){for(var i in e){var s=!1;for(var n in Ut)if(0===i.indexOf(n)&&Ut[n].test(i)){s=!0;break}s||(t[i]=e[i])}return t}function f(t,e){t.page=t.page||{},t.page.x=e.page.x,t.page.y=e.page.y,t.client=t.client||{},t.client.x=e.client.x,t.client.y=e.client.y,t.timeStamp=e.timeStamp}function m(t,e,i){t.page.x=i.page.x-e.page.x,t.page.y=i.page.y-e.page.y,t.client.x=i.client.x-e.client.x,t.client.y=i.client.y-e.client.y,t.timeStamp=(new Date).getTime()-e.timeStamp;var s=Math.max(t.timeStamp/1e3,.001);t.page.speed=_t(t.page.x,t.page.y)/s,t.page.vx=t.page.x/s,t.page.vy=t.page.y/s,t.client.speed=_t(t.client.x,t.page.y)/s,t.client.vx=t.client.x/s,t.client.vy=t.client.y/s}function g(t){return t instanceof ut.Event||Dt&&ut.Touch&&t instanceof ut.Touch}function v(t,e,i){return i=i||{},t=t||"page",i.x=e[t+"X"],i.y=e[t+"Y"],i}function y(t,e){return e=e||{},$t&&g(t)?(v("screen",t,e),e.x+=ut.scrollX,e.y+=ut.scrollY):v("page",t,e),e}function _(t,e){return e=e||{},$t&&g(t)?v("screen",t,e):v("client",t,e),e}function b(t){return l(t.pointerId)?t.pointerId:t.identifier}function w(t){return t instanceof gt?t.correspondingUseElement:t}function x(t){if(s(t))return t;var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||ut}function C(t){var e=t instanceof ft?t.getBoundingClientRect():t.getClientRects()[0];return e&&{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}}function k(t){var e,i=C(t);if(!zt&&i){var s={x:(e=(e=x(t))||ut).scrollX||e.document.documentElement.scrollLeft,y:e.scrollY||e.document.documentElement.scrollTop};i.left+=s.x,i.right+=s.x,i.top+=s.y,i.bottom+=s.y}return i}function E(t){var e=[];return r(t)?(e[0]=t[0],e[1]=t[1]):"touchend"===t.type?1===t.touches.length?(e[0]=t.touches[0],e[1]=t.changedTouches[0]):0===t.touches.length&&(e[0]=t.changedTouches[0],e[1]=t.changedTouches[1]):(e[0]=t.touches[0],e[1]=t.touches[1]),e}function T(t){for(var e,i={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},s=0;s<t.length;s++)for(e in i)i[e]+=t[s][e];for(e in i)i[e]/=t.length;return i}function S(t){if(t.length||t.touches&&t.touches.length>1){var e=E(t),i=Math.min(e[0].pageX,e[1].pageX),s=Math.min(e[0].pageY,e[1].pageY);return{x:i,y:s,left:i,top:s,width:Math.max(e[0].pageX,e[1].pageX)-i,height:Math.max(e[0].pageY,e[1].pageY)-s}}}function D(t,e){var i=(e=e||Tt.deltaSource)+"X",s=e+"Y",n=E(t),r=n[0][i]-n[1][i],o=n[0][s]-n[1][s];return _t(r,o)}function O(t,e,i){var s=(i=i||Tt.deltaSource)+"X",n=i+"Y",r=E(t),o=r[0][s]-r[1][s],a=r[0][n]-r[1][n],h=180*Math.atan(a/o)/Math.PI;if(l(e)){var d=(h-e)%360;d>315?h-=360+h/360|0:d>135?h-=180+h/360|0:d<-315?h+=360+h/360|0:d<-135&&(h+=180+h/360|0)}return h}function A(t,e){var s=t?t.options.origin:Tt.origin;return"parent"===s?s=F(e):"self"===s?s=t.getRect(e):u(s)&&(s=P(e,s)||{x:0,y:0}),a(s)&&(s=s(t&&e)),i(s)&&(s=k(s)),s.x="x"in s?s.x:s.left,s.y="y"in s?s.y:s.top,s}function M(t,e,i,s){var n=1-t;return n*n*e+2*n*t*i+t*t*s}function N(t,e,i,s){return-i*(t/=s)*(t-2)+e}function I(t,e){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function P(t,e){for(var s=F(t);i(s);){if(at(s,e))return s;s=F(s)}return null}function F(t){var e=t.parentNode;if(n(e)){for(;(e=e.host)&&n(e););return e}return e}function j(t,e){return t._context===e.ownerDocument||I(t._context,e)}function L(t,e,s){var n=t.options.ignoreFrom;return!(!n||!i(s))&&(d(n)?lt(s,n,e):!!i(n)&&I(n,s))}function R(t,e,s){var n=t.options.allowFrom;return!n||!!i(s)&&(d(n)?lt(s,n,e):!!i(n)&&I(n,s))}function $(t,e){if(!e)return!1;var i=e.options.drag.axis;return"xy"===t||"xy"===i||i===t}function z(t,e){var i=t.options;return/^resize/.test(e)&&(e="resize"),i[e].snap&&i[e].snap.enabled}function V(t,e){var i=t.options;return/^resize/.test(e)&&(e="resize"),i[e].restrict&&i[e].restrict.enabled}function q(t,e,i){for(var s=t.options,n=s[i.name].max,r=s[i.name].maxPerElement,o=0,a=0,l=0,h=0,d=Ct.length;h<d;h++){var u=Ct[h],c=u.prepared.name;if(u.interacting()){if(++o>=It)return!1;if(u.target===t){if((a+=c===i.name|0)>=n)return!1;if(u.element===e&&(l++,c!==i.name||l>=r))return!1}}}return It>0}function B(){if(this.target=null,this.element=null,this.dropTarget=null,this.dropElement=null,this.prevDropTarget=null,this.prevDropElement=null,this.prepared={name:null,axis:null,edges:null},this.matches=[],this.matchElements=[],this.inertiaStatus={active:!1,smoothEnd:!1,ending:!1,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,resumeDx:0,resumeDy:0,lambda_v0:0,one_ve_v0:0,i:null},a(Function.prototype.bind))this.boundInertiaFrame=this.inertiaFrame.bind(this),this.boundSmoothEndFrame=this.smoothEndFrame.bind(this);else{var t=this;this.boundInertiaFrame=function(){return t.inertiaFrame()},this.boundSmoothEndFrame=function(){return t.smoothEndFrame()}}this.activeDrops={dropzones:[],elements:[],rects:[]},this.pointers=[],this.pointerIds=[],this.downTargets=[],this.downTimes=[],this.holdTimers=[],this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0},this.downEvent=null,this.downPointer={},this._eventTarget=null,this._curEventTarget=null,this.prevEvent=null,this.tapTime=0,this.prevTap=null,this.startOffset={left:0,right:0,top:0,bottom:0},this.restrictOffset={left:0,right:0,top:0,bottom:0},this.snapOffsets=[],this.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0},this.snapStatus={x:0,y:0,dx:0,dy:0,realX:0,realY:0,snappedX:0,snappedY:0,targets:[],locked:!1,changed:!1},this.restrictStatus={dx:0,dy:0,restrictedX:0,restrictedY:0,snap:null,restricted:!1,changed:!1},this.restrictStatus.snap=this.snapStatus,this.pointerIsDown=!1,this.pointerWasMoved=!1,this.gesturing=!1,this.dragging=!1,this.resizing=!1,this.resizeAxes="xy",this.mouse=!1,Ct.push(this)}function H(t,e,i){var s,n=0,r=Ct.length,o=/mouse/i.test(t.pointerType||e)||4===t.pointerType,a=b(t);if(/down|start/i.test(e))for(n=0;n<r;n++){var l=i;if((s=Ct[n]).inertiaStatus.active&&s.target.options[s.prepared.name].inertia.allowResume&&s.mouse===o)for(;l;){if(l===s.element)return s;l=F(l)}}if(o||!Dt&&!Ot){for(n=0;n<r;n++)if(Ct[n].mouse&&!Ct[n].inertiaStatus.active)return Ct[n];for(n=0;n<r;n++)if(Ct[n].mouse&&(!/down/.test(e)||!Ct[n].inertiaStatus.active))return s;return(s=new B).mouse=!0,s}for(n=0;n<r;n++)if(ot(Ct[n].pointerIds,a))return Ct[n];if(/up|end|out/i.test(e))return null;for(n=0;n<r;n++)if((!(s=Ct[n]).prepared.name||s.target.options.gesture.enabled)&&!s.interacting()&&(o||!s.mouse))return s;return new B}function U(t){return function(e){var i,s,n=w(e.path?e.path[0]:e.target),r=w(e.currentTarget);if(Dt&&/touch/.test(e.type))for(Nt=(new Date).getTime(),s=0;s<e.changedTouches.length;s++){var o=e.changedTouches[s];(i=H(o,e.type,n))&&(i._updateEventTargets(n,r),i[t](o,e,n,r))}else{if(!Ot&&/mouse/.test(e.type)){for(s=0;s<Ct.length;s++)if(!Ct[s].mouse&&Ct[s].pointerIsDown)return;if((new Date).getTime()-Nt<500)return}if(!(i=H(e,e.type,n)))return;i._updateEventTargets(n,r),i[t](e,e,n,r)}}}function Q(t,e,i,s,n,r){var o,a,l=t.target,h=t.snapStatus,d=t.restrictStatus,u=t.pointers,p=(l&&l.options||Tt).deltaSource,f=p+"X",m=p+"Y",g=l?l.options:Tt,v=A(l,n),y="start"===s,_="end"===s,b=y?t.startCoords:t.curCoords;n=n||t.element,a=c({},b.page),o=c({},b.client),a.x-=v.x,a.y-=v.y,o.x-=v.x,o.y-=v.y;var w=g[i].snap&&g[i].snap.relativePoints;!z(l,i)||y&&w&&w.length||(this.snap={range:h.range,locked:h.locked,x:h.snappedX,y:h.snappedY,realX:h.realX,realY:h.realY,dx:h.dx,dy:h.dy},h.locked&&(a.x+=h.dx,a.y+=h.dy,o.x+=h.dx,o.y+=h.dy)),!V(l,i)||y&&g[i].restrict.elementRect||!d.restricted||(a.x+=d.dx,a.y+=d.dy,o.x+=d.dx,o.y+=d.dy,this.restrict={dx:d.dx,dy:d.dy}),this.pageX=a.x,this.pageY=a.y,this.clientX=o.x,this.clientY=o.y,this.x0=t.startCoords.page.x-v.x,this.y0=t.startCoords.page.y-v.y,this.clientX0=t.startCoords.client.x-v.x,this.clientY0=t.startCoords.client.y-v.y,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.button=e.button,this.buttons=e.buttons,this.target=n,this.t0=t.downTimes[0],this.type=i+(s||""),this.interaction=t,this.interactable=l;var x=t.inertiaStatus;if(x.active&&(this.detail="inertia"),r&&(this.relatedTarget=r),_?"client"===p?(this.dx=o.x-t.startCoords.client.x,this.dy=o.y-t.startCoords.client.y):(this.dx=a.x-t.startCoords.page.x,this.dy=a.y-t.startCoords.page.y):y?(this.dx=0,this.dy=0):"inertiastart"===s?(this.dx=t.prevEvent.dx,this.dy=t.prevEvent.dy):"client"===p?(this.dx=o.x-t.prevEvent.clientX,this.dy=o.y-t.prevEvent.clientY):(this.dx=a.x-t.prevEvent.pageX,this.dy=a.y-t.prevEvent.pageY),t.prevEvent&&"inertia"===t.prevEvent.detail&&!x.active&&g[i].inertia&&g[i].inertia.zeroResumeDelta&&(x.resumeDx+=this.dx,x.resumeDy+=this.dy,this.dx=this.dy=0),"resize"===i&&t.resizeAxes?g.resize.square?("y"===t.resizeAxes?this.dx=this.dy:this.dy=this.dx,this.axes="xy"):(this.axes=t.resizeAxes,"x"===t.resizeAxes?this.dy=0:"y"===t.resizeAxes&&(this.dx=0)):"gesture"===i&&(this.touches=[u[0],u[1]],y?(this.distance=D(u,p),this.box=S(u),this.scale=1,this.ds=0,this.angle=O(u,void 0,p),this.da=0):_||e instanceof Q?(this.distance=t.prevEvent.distance,this.box=t.prevEvent.box,this.scale=t.prevEvent.scale,this.ds=this.scale-1,this.angle=t.prevEvent.angle,this.da=this.angle-t.gesture.startAngle):(this.distance=D(u,p),this.box=S(u),this.scale=this.distance/t.gesture.startDistance,this.angle=O(u,t.gesture.prevAngle,p),this.ds=this.scale-t.gesture.prevScale,this.da=this.angle-t.gesture.prevAngle)),y)this.timeStamp=t.downTimes[0],this.dt=0,this.duration=0,this.speed=0,this.velocityX=0,this.velocityY=0;else if("inertiastart"===s)this.timeStamp=t.prevEvent.timeStamp,this.dt=t.prevEvent.dt,this.duration=t.prevEvent.duration,this.speed=t.prevEvent.speed,this.velocityX=t.prevEvent.velocityX,this.velocityY=t.prevEvent.velocityY;else if(this.timeStamp=(new Date).getTime(),this.dt=this.timeStamp-t.prevEvent.timeStamp,this.duration=this.timeStamp-t.downTimes[0],e instanceof Q){var C=this[f]-t.prevEvent[f],k=this[m]-t.prevEvent[m],E=this.dt/1e3;this.speed=_t(C,k)/E,this.velocityX=C/E,this.velocityY=k/E}else this.speed=t.pointerDelta[p].speed,this.velocityX=t.pointerDelta[p].vx,this.velocityY=t.pointerDelta[p].vy;if((_||"inertiastart"===s)&&t.prevEvent.speed>600&&this.timeStamp-t.prevEvent.timeStamp<150){var T=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;T<0&&(T+=360);var M=112.5<=T&&T<247.5,N=202.5<=T&&T<337.5,I=!M&&(292.5<=T||T<67.5),P=!N&&22.5<=T&&T<157.5;this.swipe={up:N,down:P,left:M,right:I,angle:T,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}}}function Y(){this.originalEvent.preventDefault()}function W(t){var e="";if("drag"===t.name&&(e=Pt.drag),"resize"===t.name)if(t.axis)e=Pt[t.name+t.axis];else if(t.edges){for(var i="resize",s=["top","bottom","left","right"],n=0;n<4;n++)t.edges[s[n]]&&(i+=s[n]);e=Pt[i]}return e}function G(t,e,s,n,r,o,a){if(!e)return!1;if(!0===e){var h=l(o.width)?o.width:o.right-o.left,d=l(o.height)?o.height:o.bottom-o.top;if(h<0&&("left"===t?t="right":"right"===t&&(t="left")),d<0&&("top"===t?t="bottom":"bottom"===t&&(t="top")),"left"===t)return s.x<(h>=0?o.left:o.right)+a;if("top"===t)return s.y<(d>=0?o.top:o.bottom)+a;if("right"===t)return s.x>(h>=0?o.right:o.left)-a;if("bottom"===t)return s.y>(d>=0?o.bottom:o.top)-a}return!!i(n)&&(i(e)?e===n:lt(n,e,r))}function J(t,e,i){var s,n=this.getRect(i),r=!1,a=null,l=null,h=c({},e.curCoords.page),d=this.options;if(!n)return null;if(Ft.resize&&d.resize.enabled){var u=d.resize;if(s={left:!1,right:!1,top:!1,bottom:!1},o(u.edges)){for(var p in s)s[p]=G(p,u.edges[p],h,e._eventTarget,i,n,u.margin||At);s.left=s.left&&!s.right,s.top=s.top&&!s.bottom,r=s.left||s.right||s.top||s.bottom}else{var f="y"!==d.resize.axis&&h.x>n.right-At,m="x"!==d.resize.axis&&h.y>n.bottom-At;r=f||m,l=(f?"x":"")+(m?"y":"")}}return a=r?"resize":Ft.drag&&d.drag.enabled?"drag":null,Ft.gesture&&e.pointerIds.length>=2&&!e.dragging&&!e.resizing&&(a="gesture"),a?{name:a,axis:l,edges:s}:null}function X(t,e){if(!o(t))return null;var i=t.name,s=e.options;return("resize"===i&&s.resize.enabled||"drag"===i&&s.drag.enabled||"gesture"===i&&s.gesture.enabled)&&Ft[i]?("resize"!==i&&"resizeyx"!==i||(i="resizexy"),t):null}function K(t,e){var s={},n=Et[t.type],r=w(t.path?t.path[0]:t.target),o=r;e=!!e;for(var a in t)s[a]=t[a];for(s.originalEvent=t,s.preventDefault=Y;i(o);){for(var l=0;l<n.selectors.length;l++){var h=n.selectors[l],d=n.contexts[l];if(at(o,h)&&I(d,r)&&I(d,o)){var u=n.listeners[l];s.currentTarget=o;for(var c=0;c<u.length;c++)u[c][1]===e&&u[c][0](s)}}o=F(o)}}function Z(t){return K.call(this,t,!0)}function tt(t,e){return xt.get(t,e)||new et(t,e)}function et(t,e){var s;if(this._element=t,this._iEvents=this._iEvents||{},u(t)){this.selector=t;var n=e&&e.context;s=n?x(n):ut,n&&(s.Node?n instanceof s.Node:i(n)||n===s.document)&&(this._context=n)}else s=x(t),i(t)&&(Ot?(Ht.add(this._element,ht.down,Qt.pointerDown),Ht.add(this._element,ht.move,Qt.pointerHover)):(Ht.add(this._element,"mousedown",Qt.pointerDown),Ht.add(this._element,"mousemove",Qt.pointerHover),Ht.add(this._element,"touchstart",Qt.pointerDown),Ht.add(this._element,"touchmove",Qt.pointerHover)));this._doc=s.document,ot(wt,this._doc)||nt(this._doc),xt.push(this),this.set(e)}function it(t,e){var i=!1;return function(){return i||(ut.console.warn(e),i=!0),t.apply(this,arguments)}}function st(t){for(var e=0;e<Ct.length;e++)Ct[e].pointerEnd(t,t)}function nt(t){if(!ot(wt,t)){var e=t.defaultView||t.parentWindow;for(var i in Et)Ht.add(t,i,K),Ht.add(t,i,Z,!0);Ot?(ht=yt===e.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"},Ht.add(t,ht.down,Qt.selectorDown),Ht.add(t,ht.move,Qt.pointerMove),Ht.add(t,ht.over,Qt.pointerOver),Ht.add(t,ht.out,Qt.pointerOut),Ht.add(t,ht.up,Qt.pointerUp),Ht.add(t,ht.cancel,Qt.pointerCancel),Ht.add(t,ht.move,Qt.autoScrollMove)):(Ht.add(t,"mousedown",Qt.selectorDown),Ht.add(t,"mousemove",Qt.pointerMove),Ht.add(t,"mouseup",Qt.pointerUp),Ht.add(t,"mouseover",Qt.pointerOver),Ht.add(t,"mouseout",Qt.pointerOut),Ht.add(t,"touchstart",Qt.selectorDown),Ht.add(t,"touchmove",Qt.pointerMove),Ht.add(t,"touchend",Qt.pointerUp),Ht.add(t,"touchcancel",Qt.pointerCancel),Ht.add(t,"mousemove",Qt.autoScrollMove),Ht.add(t,"touchmove",Qt.autoScrollMove)),Ht.add(e,"blur",st);try{if(e.frameElement){var s=e.frameElement.ownerDocument,n=s.defaultView;Ht.add(s,"mouseup",Qt.pointerEnd),Ht.add(s,"touchend",Qt.pointerEnd),Ht.add(s,"touchcancel",Qt.pointerEnd),Ht.add(s,"pointerup",Qt.pointerEnd),Ht.add(s,"MSPointerUp",Qt.pointerEnd),Ht.add(n,"blur",st)}}catch(t){tt.windowParentError=t}Ht.add(t,"dragstart",function(t){for(var e=0;e<Ct.length;e++){var i=Ct[e];if(i.element&&(i.element===t.target||I(i.element,t.target)))return void i.checkAndPreventDefault(t,i.target,i.element)}}),Ht.useAttachEvent&&(Ht.add(t,"selectstart",function(t){var e=Ct[0];e.currentAction()&&e.checkAndPreventDefault(t)}),Ht.add(t,"dblclick",U("ie8Dblclick"))),wt.push(t)}}function rt(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1}function ot(t,e){return-1!==rt(t,e)}function at(e,i,s){return dt?dt(e,i,s):(ut!==t&&(i=i.replace(/\/deep\//g," ")),e[Vt](i))}function lt(t,e,s){for(;i(t);){if(at(t,e))return!0;if((t=F(t))===s)return at(t,e)}return!1}if(t){var ht,dt,ut=(Xt=t.document.createTextNode("")).ownerDocument!==t.document&&"function"==typeof t.wrap&&t.wrap(Xt)===Xt?t.wrap(t):t,ct=ut.document,pt=ut.DocumentFragment||e,ft=ut.SVGElement||e,mt=ut.SVGSVGElement||e,gt=ut.SVGElementInstance||e,vt=ut.HTMLElement||ut.Element,yt=ut.PointerEvent||ut.MSPointerEvent,_t=Math.hypot||function(t,e){return Math.sqrt(t*t+e*e)},bt={},wt=[],xt=[],Ct=[],kt=!1,Et={},Tt={base:{accept:null,actionChecker:null,styleCursor:!0,preventDefault:"auto",origin:{x:0,y:0},deltaSource:"page",allowFrom:null,ignoreFrom:null,_context:ct,dropChecker:null},drag:{enabled:!1,manualStart:!0,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,axis:"xy"},drop:{enabled:!1,accept:null,overlap:"pointer"},resize:{enabled:!1,manualStart:!1,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},gesture:{manualStart:!1,enabled:!1,max:1/0,maxPerElement:1,restrict:null},perAction:{manualStart:!1,max:1/0,maxPerElement:1,snap:{enabled:!1,endOnly:!1,range:1/0,targets:null,offsets:null,relativePoints:null},restrict:{enabled:!1,endOnly:!1},autoScroll:{enabled:!1,container:null,margin:60,speed:300},inertia:{enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,zeroResumeDelta:!0,smoothEndDuration:300}},_holdDuration:600},St={interaction:null,i:null,x:0,y:0,scroll:function(){var t,e,i,n,r=St.interaction.target.options[St.interaction.prepared.name].autoScroll,o=r.container||x(St.interaction.element),a=(new Date).getTime(),l=(a-St.prevTimeX)/1e3,h=(a-St.prevTimeY)/1e3;r.velocity?(t=r.velocity.x,e=r.velocity.y):t=e=r.speed,n=e*h,((i=t*l)>=1||n>=1)&&(s(o)?o.scrollBy(St.x*i,St.y*n):o&&(o.scrollLeft+=St.x*i,o.scrollTop+=St.y*n),i>=1&&(St.prevTimeX=a),n>=1&&(St.prevTimeY=a)),St.isScrolling&&(Bt(St.i),St.i=qt(St.scroll))},isScrolling:!1,prevTimeX:0,prevTimeY:0,start:function(t){St.isScrolling=!0,Bt(St.i),St.interaction=t,St.prevTimeX=(new Date).getTime(),St.prevTimeY=(new Date).getTime(),St.i=qt(St.scroll)},stop:function(){St.isScrolling=!1,Bt(St.i)}},Dt="ontouchstart"in ut||ut.DocumentTouch&&ct instanceof ut.DocumentTouch,Ot=yt&&!/Chrome/.test(navigator.userAgent),At=Dt||Ot?20:10,Mt=1,Nt=0,It=1/0,Pt=ct.all&&!ut.atob?{drag:"move",resizex:"e-resize",resizey:"s-resize",resizexy:"se-resize",resizetop:"n-resize",resizeleft:"w-resize",resizebottom:"s-resize",resizeright:"e-resize",resizetopleft:"se-resize",resizebottomright:"se-resize",resizetopright:"ne-resize",resizebottomleft:"ne-resize",gesture:""}:{drag:"move",resizex:"ew-resize",resizey:"ns-resize",resizexy:"nwse-resize",resizetop:"ns-resize",resizeleft:"ew-resize",resizebottom:"ns-resize",resizeright:"ew-resize",resizetopleft:"nwse-resize",resizebottomright:"nwse-resize",resizetopright:"nesw-resize",resizebottomleft:"nesw-resize",gesture:""},Ft={drag:!0,resize:!0,gesture:!0},jt="onmousewheel"in ct?"mousewheel":"wheel",Lt=["dragstart","dragmove","draginertiastart","dragend","dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop","resizestart","resizemove","resizeinertiastart","resizeend","gesturestart","gesturemove","gestureinertiastart","gestureend","down","move","up","cancel","tap","doubletap","hold"],Rt={},$t="Opera"==navigator.appName&&Dt&&navigator.userAgent.match("Presto"),zt=/iP(hone|od|ad)/.test(navigator.platform)&&/OS 7[^\d]/.test(navigator.appVersion),Vt="matches"in Element.prototype?"matches":"webkitMatchesSelector"in Element.prototype?"webkitMatchesSelector":"mozMatchesSelector"in Element.prototype?"mozMatchesSelector":"oMatchesSelector"in Element.prototype?"oMatchesSelector":"msMatchesSelector",qt=t.requestAnimationFrame,Bt=t.cancelAnimationFrame,Ht=function(){var t="attachEvent"in ut&&!("addEventListener"in ut),e=t?"attachEvent":"addEventListener",i=t?"detachEvent":"removeEventListener",s=t?"on":"",n=[],r=[],o=[];return{add:function(i,a,l,h){var d=rt(n,i),u=r[d];if(u||(u={events:{},typeCount:0},d=n.push(i)-1,r.push(u),o.push(t?{supplied:[],wrapped:[],useCount:[]}:null)),u.events[a]||(u.events[a]=[],u.typeCount++),!ot(u.events[a],l)){var c;if(t){var p=o[d],f=rt(p.supplied,l),m=p.wrapped[f]||function(t){t.immediatePropagationStopped||(t.target=t.srcElement,t.currentTarget=i,t.preventDefault=t.preventDefault||function(){this.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){this.cancelBubble=!0},t.stopImmediatePropagation=t.stopImmediatePropagation||function(){this.cancelBubble=!0,this.immediatePropagationStopped=!0},/mouse|click/.test(t.type)&&(t.pageX=t.clientX+x(i).document.documentElement.scrollLeft,t.pageY=t.clientY+x(i).document.documentElement.scrollTop),l(t))};c=i[e](s+a,m,Boolean(h)),-1===f?(p.supplied.push(l),p.wrapped.push(m),p.useCount.push(1)):p.useCount[f]++}else c=i[e](a,l,h||!1);return u.events[a].push(l),c}},remove:function e(a,l,h,d){var u,c,p,f=rt(n,a),m=r[f],g=h;if(m&&m.events)if(t&&(p=rt((c=o[f]).supplied,h),g=c.wrapped[p]),"all"!==l){if(m.events[l]){var v=m.events[l].length;if("all"===h){for(u=0;u<v;u++)e(a,l,m.events[l][u],Boolean(d));return}for(u=0;u<v;u++)if(m.events[l][u]===h){a[i](s+l,g,d||!1),m.events[l].splice(u,1),t&&c&&(c.useCount[p]--,0===c.useCount[p]&&(c.supplied.splice(p,1),c.wrapped.splice(p,1),c.useCount.splice(p,1)));break}m.events[l]&&0===m.events[l].length&&(m.events[l]=null,m.typeCount--)}m.typeCount||(r.splice(f,1),n.splice(f,1),o.splice(f,1))}else for(l in m.events)m.events.hasOwnProperty(l)&&e(a,l,"all")},useAttachEvent:t,_elements:n,_targets:r,_attachedListeners:o}}(),Ut={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/};B.prototype={getPageXY:function(t,e){return y(t,e)},getClientXY:function(t,e){return _(t,e)},setEventXY:function(t,e){return i=t,y(n=(s=e).length>1?T(s):s[0],bt),i.page.x=bt.x,i.page.y=bt.y,_(n,bt),i.client.x=bt.x,i.client.y=bt.y,void(i.timeStamp=(new Date).getTime());var i,s,n},pointerOver:function(t,e,i){if(!this.prepared.name&&this.mouse){var s=[],n=[],r=this.element;this.addPointer(t),!this.target||!L(this.target,this.element,i)&&R(this.target,this.element,i)||(this.target=null,this.element=null,this.matches=[],this.matchElements=[]);var o=xt.get(i),a=o&&!L(o,i,i)&&R(o,i,i)&&X(o.getAction(t,e,this,i),o);a&&!q(o,i,a)&&(a=null),a?(this.target=o,this.element=i,this.matches=[],this.matchElements=[]):(xt.forEachSelector(function(t,e){t&&j(t,i)&&!L(t,i,i)&&R(t,i,i)&&at(i,e)&&(s.push(t),n.push(i))}),this.validateSelector(t,e,s,n)?(this.matches=s,this.matchElements=n,this.pointerHover(t,e,this.matches,this.matchElements),Ht.add(i,Ot?ht.move:"mousemove",Qt.pointerHover)):this.target&&(I(r,i)?(this.pointerHover(t,e,this.matches,this.matchElements),Ht.add(this.element,Ot?ht.move:"mousemove",Qt.pointerHover)):(this.target=null,this.element=null,this.matches=[],this.matchElements=[])))}},pointerHover:function(t,e,i,s,n,r){var o,a=this.target;!this.prepared.name&&this.mouse?(this.setEventXY(this.curCoords,[t]),n?o=this.validateSelector(t,e,n,r):a&&(o=X(a.getAction(this.pointers[0],e,this,this.element),this.target)),a&&a.options.styleCursor&&(a._doc.documentElement.style.cursor=o?W(o):"")):this.prepared.name&&this.checkAndPreventDefault(e,a,this.element)},pointerOut:function(t,e,i){this.prepared.name||(xt.get(i)||Ht.remove(i,Ot?ht.move:"mousemove",Qt.pointerHover),this.target&&this.target.options.styleCursor&&!this.interacting()&&(this.target._doc.documentElement.style.cursor=""))},selectorDown:function(t,e,s,n){function r(t,e,i){var n=dt?i.querySelectorAll(e):void 0;j(t,h)&&!L(t,h,s)&&R(t,h,s)&&at(h,e,n)&&(a.matches.push(t),a.matchElements.push(h))}var o,a=this,l=Ht.useAttachEvent?c({},e):e,h=s,d=this.addPointer(t);if(this.holdTimers[d]=setTimeout(function(){a.pointerHold(Ht.useAttachEvent?l:t,l,s,n)},Tt._holdDuration),this.pointerIsDown=!0,this.inertiaStatus.active&&this.target.selector)for(;i(h);){if(h===this.element&&X(this.target.getAction(t,e,this,this.element),this.target).name===this.prepared.name)return Bt(this.inertiaStatus.i),this.inertiaStatus.active=!1,void this.collectEventTargets(t,e,s,"down");h=F(h)}if(this.interacting())this.collectEventTargets(t,e,s,"down");else{for(this.setEventXY(this.curCoords,[t]),this.downEvent=e;i(h)&&!o;)this.matches=[],this.matchElements=[],xt.forEachSelector(r),o=this.validateSelector(t,e,this.matches,this.matchElements),h=F(h);if(o)return this.prepared.name=o.name,this.prepared.axis=o.axis,this.prepared.edges=o.edges,this.collectEventTargets(t,e,s,"down"),this.pointerDown(t,e,s,n,o);this.downTimes[d]=(new Date).getTime(),this.downTargets[d]=s,p(this.downPointer,t),f(this.prevCoords,this.curCoords),this.pointerWasMoved=!1,this.collectEventTargets(t,e,s,"down")}},pointerDown:function(t,e,i,s,n){if(n||this.inertiaStatus.active||!this.pointerWasMoved||!this.prepared.name){this.pointerIsDown=!0,this.downEvent=e;var r,o=this.addPointer(t);if(this.pointerIds.length>1&&this.target._element===this.element){var a=X(n||this.target.getAction(t,e,this,this.element),this.target);q(this.target,this.element,a)&&(r=a),this.prepared.name=null}else if(!this.prepared.name){var l=xt.get(s);l&&!L(l,s,i)&&R(l,s,i)&&(r=X(n||l.getAction(t,e,this,s),l))&&q(l,s,r)&&(this.target=l,this.element=s)}var h=this.target,d=h&&h.options;if(!h||!n&&this.prepared.name)this.inertiaStatus.active&&s===this.element&&X(h.getAction(t,e,this,this.element),h).name===this.prepared.name&&(Bt(this.inertiaStatus.i),this.inertiaStatus.active=!1,this.checkAndPreventDefault(e,h,this.element));else{if(r=r||X(n||h.getAction(t,e,this,s),h,this.element),this.setEventXY(this.startCoords,this.pointers),!r)return;d.styleCursor&&(h._doc.documentElement.style.cursor=W(r)),this.resizeAxes="resize"===r.name?r.axis:null,"gesture"===r&&this.pointerIds.length<2&&(r=null),this.prepared.name=r.name,this.prepared.axis=r.axis,this.prepared.edges=r.edges,this.snapStatus.snappedX=this.snapStatus.snappedY=this.restrictStatus.restrictedX=this.restrictStatus.restrictedY=NaN,this.downTimes[o]=(new Date).getTime(),this.downTargets[o]=i,p(this.downPointer,t),f(this.prevCoords,this.startCoords),this.pointerWasMoved=!1,this.checkAndPreventDefault(e,h,this.element)}}else this.checkAndPreventDefault(e,this.target,this.element)},setModifications:function(t,e){var i=this.target,s=!0,n=z(i,this.prepared.name)&&(!i.options[this.prepared.name].snap.endOnly||e),r=V(i,this.prepared.name)&&(!i.options[this.prepared.name].restrict.endOnly||e);return n?this.setSnapping(t):this.snapStatus.locked=!1,r?this.setRestriction(t):this.restrictStatus.restricted=!1,n&&this.snapStatus.locked&&!this.snapStatus.changed?s=r&&this.restrictStatus.restricted&&this.restrictStatus.changed:r&&this.restrictStatus.restricted&&!this.restrictStatus.changed&&(s=!1),s},setStartOffsets:function(t,e,i){var s,n,r=e.getRect(i),o=A(e,i),a=e.options[this.prepared.name].snap,l=e.options[this.prepared.name].restrict;r?(this.startOffset.left=this.startCoords.page.x-r.left,this.startOffset.top=this.startCoords.page.y-r.top,this.startOffset.right=r.right-this.startCoords.page.x,this.startOffset.bottom=r.bottom-this.startCoords.page.y,s="width"in r?r.width:r.right-r.left,n="height"in r?r.height:r.bottom-r.top):this.startOffset.left=this.startOffset.top=this.startOffset.right=this.startOffset.bottom=0,this.snapOffsets.splice(0);var h=a&&"startCoords"===a.offset?{x:this.startCoords.page.x-o.x,y:this.startCoords.page.y-o.y}:a&&a.offset||{x:0,y:0};if(r&&a&&a.relativePoints&&a.relativePoints.length)for(var d=0;d<a.relativePoints.length;d++)this.snapOffsets.push({x:this.startOffset.left-s*a.relativePoints[d].x+h.x,y:this.startOffset.top-n*a.relativePoints[d].y+h.y});else this.snapOffsets.push(h);r&&l.elementRect?(this.restrictOffset.left=this.startOffset.left-s*l.elementRect.left,this.restrictOffset.top=this.startOffset.top-n*l.elementRect.top,this.restrictOffset.right=this.startOffset.right-s*(1-l.elementRect.right),this.restrictOffset.bottom=this.startOffset.bottom-n*(1-l.elementRect.bottom)):this.restrictOffset.left=this.restrictOffset.top=this.restrictOffset.right=this.restrictOffset.bottom=0},start:function(t,e,i){this.interacting()||!this.pointerIsDown||this.pointerIds.length<("gesture"===t.name?2:1)||(-1===rt(Ct,this)&&Ct.push(this),this.prepared.name||this.setEventXY(this.startCoords,this.pointers),this.prepared.name=t.name,this.prepared.axis=t.axis,this.prepared.edges=t.edges,this.target=e,this.element=i,this.setStartOffsets(t.name,e,i),this.setModifications(this.startCoords.page),this.prevEvent=this[this.prepared.name+"Start"](this.downEvent))},pointerMove:function(t,e,s,n,r){if(this.inertiaStatus.active){var o=this.inertiaStatus.upCoords.page,a=this.inertiaStatus.upCoords.client,l={pageX:o.x+this.inertiaStatus.sx,pageY:o.y+this.inertiaStatus.sy,clientX:a.x+this.inertiaStatus.sx,clientY:a.y+this.inertiaStatus.sy};this.setEventXY(this.curCoords,[l])}else this.recordPointer(t),this.setEventXY(this.curCoords,this.pointers);var h,d,u=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y,c=this.mouse?0:rt(this.pointerIds,b(t));if(this.pointerIsDown&&!this.pointerWasMoved&&(h=this.curCoords.client.x-this.startCoords.client.x,d=this.curCoords.client.y-this.startCoords.client.y,this.pointerWasMoved=_t(h,d)>Mt),u||this.pointerIsDown&&!this.pointerWasMoved||(this.pointerIsDown&&clearTimeout(this.holdTimers[c]),this.collectEventTargets(t,e,s,"move")),this.pointerIsDown)if(u&&this.pointerWasMoved&&!r)this.checkAndPreventDefault(e,this.target,this.element);else if(m(this.pointerDelta,this.prevCoords,this.curCoords),this.prepared.name){if(this.pointerWasMoved&&(!this.inertiaStatus.active||t instanceof Q&&/inertiastart/.test(t.type))){if(!this.interacting()&&(m(this.pointerDelta,this.prevCoords,this.curCoords),"drag"===this.prepared.name)){var p=Math.abs(h),g=Math.abs(d),v=this.target.options.drag.axis,y=p>g?"x":p<g?"y":"xy";if("xy"!==y&&"xy"!==v&&v!==y){this.prepared.name=null;for(var _=s;i(_);){var w=xt.get(_);if(w&&w!==this.target&&!w.options.drag.manualStart&&"drag"===w.getAction(this.downPointer,this.downEvent,this,_).name&&$(y,w)){this.prepared.name="drag",this.target=w,this.element=_;break}_=F(_)}if(!this.prepared.name){var x=this,C=function(t,e,i){var n=dt?i.querySelectorAll(e):void 0;if(t!==x.target)return j(t,s)&&!t.options.drag.manualStart&&!L(t,_,s)&&R(t,_,s)&&at(_,e,n)&&"drag"===t.getAction(x.downPointer,x.downEvent,x,_).name&&$(y,t)&&q(t,_,"drag")?t:void 0};for(_=s;i(_);){var k=xt.forEachSelector(C);if(k){this.prepared.name="drag",this.target=k,this.element=_;break}_=F(_)}}}}var E=!!this.prepared.name&&!this.interacting();if(E&&(this.target.options[this.prepared.name].manualStart||!q(this.target,this.element,this.prepared)))return void this.stop(e);this.prepared.name&&this.target&&(E&&this.start(this.prepared,this.target,this.element),(this.setModifications(this.curCoords.page,r)||E)&&(this.prevEvent=this[this.prepared.name+"Move"](e)),this.checkAndPreventDefault(e,this.target,this.element))}f(this.prevCoords,this.curCoords),(this.dragging||this.resizing)&&this.autoScrollMove(t)}},dragStart:function(t){var e=new Q(this,t,"drag","start",this.element);this.dragging=!0,this.target.fire(e),this.activeDrops.dropzones=[],this.activeDrops.elements=[],this.activeDrops.rects=[],this.dynamicDrop||this.setActiveDrops(this.element);var i=this.getDropEvents(t,e);return i.activate&&this.fireActiveDrops(i.activate),e},dragMove:function(t){var e=this.target,i=new Q(this,t,"drag","move",this.element),s=this.element,n=this.getDrop(i,t,s);this.dropTarget=n.dropzone,this.dropElement=n.element;var r=this.getDropEvents(t,i);return e.fire(i),r.leave&&this.prevDropTarget.fire(r.leave),r.enter&&this.dropTarget.fire(r.enter),r.move&&this.dropTarget.fire(r.move),this.prevDropTarget=this.dropTarget,this.prevDropElement=this.dropElement,i},resizeStart:function(t){var e=new Q(this,t,"resize","start",this.element);if(this.prepared.edges){var i=this.target.getRect(this.element);if(this.target.options.resize.square||this.target.options.resize.preserveAspectRatio){var s=c({},this.prepared.edges);s.top=s.top||s.left&&!s.bottom,s.left=s.left||s.top&&!s.right,s.bottom=s.bottom||s.right&&!s.top,s.right=s.right||s.bottom&&!s.left,this.prepared._linkedEdges=s}else this.prepared._linkedEdges=null;this.target.options.resize.preserveAspectRatio&&(this.resizeStartAspectRatio=i.width/i.height),this.resizeRects={start:i,current:c({},i),restricted:c({},i),previous:c({},i),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},e.rect=this.resizeRects.restricted,e.deltaRect=this.resizeRects.delta}return this.target.fire(e),this.resizing=!0,e},resizeMove:function(t){var e=new Q(this,t,"resize","move",this.element),i=this.prepared.edges,s=this.target.options.resize.invert,n="reposition"===s||"negate"===s;if(i){var r,o=e.dx,a=e.dy,l=this.resizeRects.start,h=this.resizeRects.current,d=this.resizeRects.restricted,u=this.resizeRects.delta,p=c(this.resizeRects.previous,d),f=i;if(this.target.options.resize.preserveAspectRatio){var m=this.resizeStartAspectRatio;i=this.prepared._linkedEdges,f.left&&f.bottom||f.right&&f.top?a=-o/m:f.left||f.right?a=o/m:(f.top||f.bottom)&&(o=a*m)}else this.target.options.resize.square&&(i=this.prepared._linkedEdges,f.left&&f.bottom||f.right&&f.top?a=-o:f.left||f.right?a=o:(f.top||f.bottom)&&(o=a));if(i.top&&(h.top+=a),i.bottom&&(h.bottom+=a),i.left&&(h.left+=o),i.right&&(h.right+=o),n){if(c(d,h),"reposition"===s)d.top>d.bottom&&(r=d.top,d.top=d.bottom,d.bottom=r),d.left>d.right&&(r=d.left,d.left=d.right,d.right=r)}else d.top=Math.min(h.top,l.bottom),d.bottom=Math.max(h.bottom,l.top),d.left=Math.min(h.left,l.right),d.right=Math.max(h.right,l.left);d.width=d.right-d.left,d.height=d.bottom-d.top;for(var g in d)u[g]=d[g]-p[g];e.edges=this.prepared.edges,e.rect=d,e.deltaRect=u}return this.target.fire(e),e},gestureStart:function(t){var e=new Q(this,t,"gesture","start",this.element);return e.ds=0,this.gesture.startDistance=this.gesture.prevDistance=e.distance,this.gesture.startAngle=this.gesture.prevAngle=e.angle,this.gesture.scale=1,this.gesturing=!0,this.target.fire(e),e},gestureMove:function(t){return this.pointerIds.length?((e=new Q(this,t,"gesture","move",this.element)).ds=e.scale-this.gesture.scale,this.target.fire(e),this.gesture.prevAngle=e.angle,this.gesture.prevDistance=e.distance,e.scale===1/0||null===e.scale||void 0===e.scale||isNaN(e.scale)||(this.gesture.scale=e.scale),e):this.prevEvent;var e},pointerHold:function(t,e,i){this.collectEventTargets(t,e,i,"hold")},pointerUp:function(t,e,i,s){var n=this.mouse?0:rt(this.pointerIds,b(t));clearTimeout(this.holdTimers[n]),this.collectEventTargets(t,e,i,"up"),this.collectEventTargets(t,e,i,"tap"),this.pointerEnd(t,e,i,s),this.removePointer(t)},pointerCancel:function(t,e,i,s){var n=this.mouse?0:rt(this.pointerIds,b(t));clearTimeout(this.holdTimers[n]),this.collectEventTargets(t,e,i,"cancel"),this.pointerEnd(t,e,i,s),this.removePointer(t)},ie8Dblclick:function(t,e,i){this.prevTap&&e.clientX===this.prevTap.clientX&&e.clientY===this.prevTap.clientY&&i===this.prevTap.target&&(this.downTargets[0]=i,this.downTimes[0]=(new Date).getTime(),this.collectEventTargets(t,e,i,"tap"))},pointerEnd:function(t,e,i,s){var n,r=this.target,o=r&&r.options,a=o&&this.prepared.name&&o[this.prepared.name].inertia,l=this.inertiaStatus;if(this.interacting()){if(l.active&&!l.ending)return;var h,d,u,p=(new Date).getTime(),m=!1,g=z(r,this.prepared.name)&&o[this.prepared.name].snap.endOnly,v=V(r,this.prepared.name)&&o[this.prepared.name].restrict.endOnly,y=0,_=0;if(h=this.dragging?"x"===o.drag.axis?Math.abs(this.pointerDelta.client.vx):"y"===o.drag.axis?Math.abs(this.pointerDelta.client.vy):this.pointerDelta.client.speed:this.pointerDelta.client.speed,u=(d=a&&a.enabled&&"gesture"!==this.prepared.name&&e!==l.startEvent)&&p-this.curCoords.timeStamp<50&&h>a.minSpeed&&h>a.endSpeed,d&&!u&&(g||v)){var b={};b.snap=b.restrict=b,g&&(this.setSnapping(this.curCoords.page,b),b.locked&&(y+=b.dx,_+=b.dy)),v&&(this.setRestriction(this.curCoords.page,b),b.restricted&&(y+=b.dx,_+=b.dy)),(y||_)&&(m=!0)}if(u||m){if(f(l.upCoords,this.curCoords),this.pointers[0]=l.startEvent=new Q(this,e,this.prepared.name,"inertiastart",this.element),l.t0=p,r.fire(l.startEvent),u){l.vx0=this.pointerDelta.client.vx,l.vy0=this.pointerDelta.client.vy,l.v0=h,this.calcInertia(l);var w,x=c({},this.curCoords.page),C=A(r,this.element);if(x.x=x.x+l.xe-C.x,x.y=x.y+l.ye-C.y,(w={useStatusXY:!0,x:x.x,y:x.y,dx:0,dy:0,snap:null}).snap=w,y=_=0,g){var k=this.setSnapping(this.curCoords.page,w);k.locked&&(y+=k.dx,_+=k.dy)}if(v){var E=this.setRestriction(this.curCoords.page,w);E.restricted&&(y+=E.dx,_+=E.dy)}l.modifiedXe+=y,l.modifiedYe+=_,l.i=qt(this.boundInertiaFrame)}else l.smoothEnd=!0,l.xe=y,l.ye=_,l.sx=l.sy=0,l.i=qt(this.boundSmoothEndFrame);return void(l.active=!0)}(g||v)&&this.pointerMove(t,e,i,s,!0)}if(this.dragging){n=new Q(this,e,"drag","end",this.element);var T=this.element,S=this.getDrop(n,e,T);this.dropTarget=S.dropzone,this.dropElement=S.element;var D=this.getDropEvents(e,n);D.leave&&this.prevDropTarget.fire(D.leave),D.enter&&this.dropTarget.fire(D.enter),D.drop&&this.dropTarget.fire(D.drop),D.deactivate&&this.fireActiveDrops(D.deactivate),r.fire(n)}else this.resizing?(n=new Q(this,e,"resize","end",this.element),r.fire(n)):this.gesturing&&(n=new Q(this,e,"gesture","end",this.element),r.fire(n));this.stop(e)},collectDrops:function(t){var e,s=[],n=[];for(t=t||this.element,e=0;e<xt.length;e++)if(xt[e].options.drop.enabled){var r=xt[e],o=r.options.drop.accept;if(!(i(o)&&o!==t||d(o)&&!at(t,o)))for(var a=r.selector?r._context.querySelectorAll(r.selector):[r._element],l=0,h=a.length;l<h;l++){var u=a[l];u!==t&&(s.push(r),n.push(u))}}return{dropzones:s,elements:n}},fireActiveDrops:function(t){var e,i,s,n;for(e=0;e<this.activeDrops.dropzones.length;e++)i=this.activeDrops.dropzones[e],(s=this.activeDrops.elements[e])!==n&&(t.target=s,i.fire(t)),n=s},setActiveDrops:function(t){var e=this.collectDrops(t,!0);this.activeDrops.dropzones=e.dropzones,this.activeDrops.elements=e.elements,this.activeDrops.rects=[];for(var i=0;i<this.activeDrops.dropzones.length;i++)this.activeDrops.rects[i]=this.activeDrops.dropzones[i].getRect(this.activeDrops.elements[i])},getDrop:function(t,e,i){var s=[];kt&&this.setActiveDrops(i);for(var n=0;n<this.activeDrops.dropzones.length;n++){var r=this.activeDrops.dropzones[n],o=this.activeDrops.elements[n],a=this.activeDrops.rects[n];s.push(r.dropCheck(t,e,this.target,i,o,a)?o:null)}var l=function(t){var e,i,s,n,r,o=t[0],a=o?0:-1,l=[],h=[];for(n=1;n<t.length;n++)if((e=t[n])&&e!==o)if(o){if(e.parentNode!==e.ownerDocument)if(o.parentNode!==e.ownerDocument){if(!l.length)for(i=o;i.parentNode&&i.parentNode!==i.ownerDocument;)l.unshift(i),i=i.parentNode;if(o instanceof vt&&e instanceof ft&&!(e instanceof mt)){if(e===o.parentNode)continue;i=e.ownerSVGElement}else i=e;for(h=[];i.parentNode!==i.ownerDocument;)h.unshift(i),i=i.parentNode;for(r=0;h[r]&&h[r]===l[r];)r++;var d=[h[r-1],h[r],l[r]];for(s=d[0].lastChild;s;){if(s===d[1]){o=e,a=n,l=[];break}if(s===d[2])break;s=s.previousSibling}}else o=e,a=n}else o=e,a=n;return a}(s);return{dropzone:this.activeDrops.dropzones[l]||null,element:this.activeDrops.elements[l]||null}},getDropEvents:function(t,e){var i={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return this.dropElement!==this.prevDropElement&&(this.prevDropTarget&&(i.leave={target:this.prevDropElement,dropzone:this.prevDropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dragleave"},e.dragLeave=this.prevDropElement,e.prevDropzone=this.prevDropTarget),this.dropTarget&&(i.enter={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dragenter"},e.dragEnter=this.dropElement,e.dropzone=this.dropTarget)),"dragend"===e.type&&this.dropTarget&&(i.drop={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"drop"},e.dropzone=this.dropTarget),"dragstart"===e.type&&(i.activate={target:null,dropzone:null,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dropactivate"}),"dragend"===e.type&&(i.deactivate={target:null,dropzone:null,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dropdeactivate"}),"dragmove"===e.type&&this.dropTarget&&(i.move={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,dragmove:e,timeStamp:e.timeStamp,type:"dropmove"},e.dropzone=this.dropTarget),i},currentAction:function(){return(this.dragging?"drag":this.resizing&&"resize")||this.gesturing&&"gesture"||null},interacting:function(){return this.dragging||this.resizing||this.gesturing},clearTargets:function(){this.target=this.element=null,this.dropTarget=this.dropElement=this.prevDropTarget=this.prevDropElement=null},stop:function(t){if(this.interacting()){St.stop(),this.matches=[],this.matchElements=[];var e=this.target;e.options.styleCursor&&(e._doc.documentElement.style.cursor=""),t&&a(t.preventDefault)&&this.checkAndPreventDefault(t,e,this.element),this.dragging&&(this.activeDrops.dropzones=this.activeDrops.elements=this.activeDrops.rects=null)}this.clearTargets(),this.pointerIsDown=this.snapStatus.locked=this.dragging=this.resizing=this.gesturing=!1,this.prepared.name=this.prevEvent=null,this.inertiaStatus.resumeDx=this.inertiaStatus.resumeDy=0;for(var i=0;i<this.pointers.length;i++)-1===rt(this.pointerIds,b(this.pointers[i]))&&this.pointers.splice(i,1)},inertiaFrame:function(){var t,e,i,s,n,r=this.inertiaStatus,o=this.target.options[this.prepared.name].inertia.resistance,a=(new Date).getTime()/1e3-r.t0;if(a<r.te){var l=1-(Math.exp(-o*a)-r.lambda_v0)/r.one_ve_v0;if(r.modifiedXe===r.xe&&r.modifiedYe===r.ye)r.sx=r.xe*l,r.sy=r.ye*l;else{var h=(t=r.xe,e=r.ye,i=r.modifiedXe,s=r.modifiedYe,{x:M(n=l,0,t,i),y:M(n,0,e,s)});r.sx=h.x,r.sy=h.y}this.pointerMove(r.startEvent,r.startEvent),r.i=qt(this.boundInertiaFrame)}else r.ending=!0,r.sx=r.modifiedXe,r.sy=r.modifiedYe,this.pointerMove(r.startEvent,r.startEvent),this.pointerEnd(r.startEvent,r.startEvent),r.active=r.ending=!1},smoothEndFrame:function(){var t=this.inertiaStatus,e=(new Date).getTime()-t.t0,i=this.target.options[this.prepared.name].inertia.smoothEndDuration;e<i?(t.sx=N(e,0,t.xe,i),t.sy=N(e,0,t.ye,i),this.pointerMove(t.startEvent,t.startEvent),t.i=qt(this.boundSmoothEndFrame)):(t.ending=!0,t.sx=t.xe,t.sy=t.ye,this.pointerMove(t.startEvent,t.startEvent),this.pointerEnd(t.startEvent,t.startEvent),t.smoothEnd=t.active=t.ending=!1)},addPointer:function(t){var e=b(t),i=this.mouse?0:rt(this.pointerIds,e);return-1===i&&(i=this.pointerIds.length),this.pointerIds[i]=e,this.pointers[i]=t,i},removePointer:function(t){var e=b(t),i=this.mouse?0:rt(this.pointerIds,e);-1!==i&&(this.pointers.splice(i,1),this.pointerIds.splice(i,1),this.downTargets.splice(i,1),this.downTimes.splice(i,1),this.holdTimers.splice(i,1))},recordPointer:function(t){var e=this.mouse?0:rt(this.pointerIds,b(t));-1!==e&&(this.pointers[e]=t)},collectEventTargets:function(t,e,s,n){function r(t,e,r){var o=dt?r.querySelectorAll(e):void 0;t._iEvents[n]&&i(h)&&j(t,h)&&!L(t,h,s)&&R(t,h,s)&&at(h,e,o)&&(a.push(t),l.push(h))}var o=this.mouse?0:rt(this.pointerIds,b(t));if("tap"!==n||!this.pointerWasMoved&&this.downTargets[o]&&this.downTargets[o]===s){for(var a=[],l=[],h=s;h;)tt.isSet(h)&&tt(h)._iEvents[n]&&(a.push(tt(h)),l.push(h)),xt.forEachSelector(r),h=F(h);(a.length||"tap"===n)&&this.firePointers(t,e,s,a,l,n)}},firePointers:function(t,e,i,s,n,r){var o,a,l,h=this.mouse?0:rt(this.pointerIds,b(t)),u={};for("doubletap"===r?u=t:(p(u,e),e!==t&&p(u,t),u.preventDefault=Y,u.stopPropagation=Q.prototype.stopPropagation,u.stopImmediatePropagation=Q.prototype.stopImmediatePropagation,u.interaction=this,u.timeStamp=(new Date).getTime(),u.originalEvent=e,u.originalPointer=t,u.type=r,u.pointerId=b(t),u.pointerType=this.mouse?"mouse":Ot?d(t.pointerType)?t.pointerType:[,,"touch","pen","mouse"][t.pointerType]:"touch"),"tap"===r&&(u.dt=u.timeStamp-this.downTimes[h],a=u.timeStamp-this.tapTime,l=!!(this.prevTap&&"doubletap"!==this.prevTap.type&&this.prevTap.target===u.target&&a<500),u.double=l,this.tapTime=u.timeStamp),o=0;o<s.length&&(u.currentTarget=n[o],u.interactable=s[o],s[o].fire(u),!(u.immediatePropagationStopped||u.propagationStopped&&n[o+1]!==u.currentTarget));o++);if(l){var f={};c(f,u),f.dt=a,f.type="doubletap",this.collectEventTargets(f,e,i,"doubletap"),this.prevTap=f}else"tap"===r&&(this.prevTap=u)},validateSelector:function(t,e,i,s){for(var n=0,r=i.length;n<r;n++){var o=i[n],a=s[n],l=X(o.getAction(t,e,this,a),o);if(l&&q(o,a,l))return this.target=o,this.element=a,l}},setSnapping:function(t,e){var i,s,n,r=this.target.options[this.prepared.name].snap,o=[];if((e=e||this.snapStatus).useStatusXY)s={x:e.x,y:e.y};else{var h=A(this.target,this.element);(s=c({},t)).x-=h.x,s.y-=h.y}e.realX=s.x,e.realY=s.y,s.x=s.x-this.inertiaStatus.resumeDx,s.y=s.y-this.inertiaStatus.resumeDy;for(var d=r.targets?r.targets.length:0,u=0;u<this.snapOffsets.length;u++){var p={x:s.x-this.snapOffsets[u].x,y:s.y-this.snapOffsets[u].y};for(n=0;n<d;n++)(i=a(r.targets[n])?r.targets[n](p.x,p.y,this):r.targets[n])&&o.push({x:l(i.x)?i.x+this.snapOffsets[u].x:p.x,y:l(i.y)?i.y+this.snapOffsets[u].y:p.y,range:l(i.range)?i.range:r.range})}var f,m={target:null,inRange:!1,distance:0,range:0,dx:0,dy:0};for(n=0,d=o.length;n<d;n++){var g=(i=o[n]).range,v=i.x-s.x,y=i.y-s.y,_=_t(v,y),b=_<=g;g===1/0&&m.inRange&&m.range!==1/0&&(b=!1),m.target&&!(b?m.inRange&&g!==1/0?_/g<m.distance/m.range:g===1/0&&m.range!==1/0||_<m.distance:!m.inRange&&_<m.distance)||(g===1/0&&(b=!0),m.target=i,m.distance=_,m.range=g,m.inRange=b,m.dx=v,m.dy=y,e.range=g)}return m.target?(f=e.snappedX!==m.target.x||e.snappedY!==m.target.y,e.snappedX=m.target.x,e.snappedY=m.target.y):(f=!0,e.snappedX=NaN,e.snappedY=NaN),e.dx=m.dx,e.dy=m.dy,e.changed=f||m.inRange&&!e.locked,e.locked=m.inRange,e},setRestriction:function(t,e){var s,n,r,o,l=this.target,h=l&&l.options[this.prepared.name].restrict,u=h&&h.restriction;return u?(s=s=(e=e||this.restrictStatus).useStatusXY?{x:e.x,y:e.y}:c({},t),e.snap&&e.snap.locked&&(s.x+=e.snap.dx||0,s.y+=e.snap.dy||0),s.x-=this.inertiaStatus.resumeDx,s.y-=this.inertiaStatus.resumeDy,e.dx=0,e.dy=0,e.restricted=!1,d(u)&&!(u="parent"===u?F(this.element):"self"===u?l.getRect(this.element):P(this.element,u))?e:(a(u)&&(u=u(s.x,s.y,this.element)),i(u)&&(u=k(u)),n=u,u?"x"in u&&"y"in u?(r=Math.max(Math.min(n.x+n.width-this.restrictOffset.right,s.x),n.x+this.restrictOffset.left),o=Math.max(Math.min(n.y+n.height-this.restrictOffset.bottom,s.y),n.y+this.restrictOffset.top)):(r=Math.max(Math.min(n.right-this.restrictOffset.right,s.x),n.left+this.restrictOffset.left),o=Math.max(Math.min(n.bottom-this.restrictOffset.bottom,s.y),n.top+this.restrictOffset.top)):(r=s.x,o=s.y),e.dx=r-s.x,e.dy=o-s.y,e.changed=e.restrictedX!==r||e.restrictedY!==o,e.restricted=!(!e.dx&&!e.dy),e.restrictedX=r,e.restrictedY=o,e)):e},checkAndPreventDefault:function(t,e,i){if(e=e||this.target){var s=e.options,n=s.preventDefault;if("auto"!==n||!i||/^(input|select|textarea)$/i.test(t.target.nodeName))"always"!==n||t.preventDefault();else{if(/down|start/i.test(t.type)&&"drag"===this.prepared.name&&"xy"!==s.drag.axis)return;if(s[this.prepared.name]&&s[this.prepared.name].manualStart&&!this.interacting())return;t.preventDefault()}}},calcInertia:function(t){var e=this.target.options[this.prepared.name].inertia,i=e.resistance,s=-Math.log(e.endSpeed/t.v0)/i;t.x0=this.prevEvent.pageX,t.y0=this.prevEvent.pageY,t.t0=t.startEvent.timeStamp/1e3,t.sx=t.sy=0,t.modifiedXe=t.xe=(t.vx0-s)/i,t.modifiedYe=t.ye=(t.vy0-s)/i,t.te=s,t.lambda_v0=i/t.v0,t.one_ve_v0=1-e.endSpeed/t.v0},autoScrollMove:function(t){if(this.interacting()&&(h=this.target,d=this.prepared.name,u=h.options,/^resize/.test(d)&&(d="resize"),u[d].autoScroll&&u[d].autoScroll.enabled))if(this.inertiaStatus.active)St.x=St.y=0;else{var e,i,n,r,o=this.target.options[this.prepared.name].autoScroll,a=o.container||x(this.element);if(s(a))r=t.clientX<St.margin,e=t.clientY<St.margin,i=t.clientX>a.innerWidth-St.margin,n=t.clientY>a.innerHeight-St.margin;else{var l=C(a);r=t.clientX<l.left+St.margin,e=t.clientY<l.top+St.margin,i=t.clientX>l.right-St.margin,n=t.clientY>l.bottom-St.margin}St.x=i?1:r?-1:0,St.y=n?1:e?-1:0,St.isScrolling||(St.margin=o.margin,St.speed=o.speed,St.start(this))}var h,d,u},_updateEventTargets:function(t,e){this._eventTarget=t,this._curEventTarget=e}},Q.prototype={preventDefault:e,stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},stopPropagation:function(){this.propagationStopped=!0}};for(var Qt={},Yt=["dragStart","dragMove","resizeStart","resizeMove","gestureStart","gestureMove","pointerOver","pointerOut","pointerHover","selectorDown","pointerDown","pointerMove","pointerUp","pointerCancel","pointerEnd","addPointer","removePointer","recordPointer","autoScrollMove"],Wt=0,Gt=Yt.length;Wt<Gt;Wt++){var Jt=Yt[Wt];Qt[Jt]=U(Jt)}xt.indexOfElement=function(t,e){e=e||ct;for(var i=0;i<this.length;i++){var s=this[i];if(s.selector===t&&s._context===e||!s.selector&&s._element===t)return i}return-1},xt.get=function(t,e){return this[this.indexOfElement(t,e&&e.context)]},xt.forEachSelector=function(t){for(var e=0;e<this.length;e++){var i=this[e];if(i.selector){var s=t(i,i.selector,i._context,e,this);if(void 0!==s)return s}}},(et.prototype={setOnEvents:function(t,e){return"drop"===t?(a(e.ondrop)&&(this.ondrop=e.ondrop),a(e.ondropactivate)&&(this.ondropactivate=e.ondropactivate),a(e.ondropdeactivate)&&(this.ondropdeactivate=e.ondropdeactivate),a(e.ondragenter)&&(this.ondragenter=e.ondragenter),a(e.ondragleave)&&(this.ondragleave=e.ondragleave),a(e.ondropmove)&&(this.ondropmove=e.ondropmove)):(t="on"+t,a(e.onstart)&&(this[t+"start"]=e.onstart),a(e.onmove)&&(this[t+"move"]=e.onmove),a(e.onend)&&(this[t+"end"]=e.onend),a(e.oninertiastart)&&(this[t+"inertiastart"]=e.oninertiastart)),this},draggable:function(t){return o(t)?(this.options.drag.enabled=!1!==t.enabled,this.setPerAction("drag",t),this.setOnEvents("drag",t),/^x$|^y$|^xy$/.test(t.axis)?this.options.drag.axis=t.axis:null===t.axis&&delete this.options.drag.axis,this):h(t)?(this.options.drag.enabled=t,this):this.options.drag},setPerAction:function(t,e){for(var i in e)i in Tt[t]&&(o(e[i])?(this.options[t][i]=c(this.options[t][i]||{},e[i]),o(Tt.perAction[i])&&"enabled"in Tt.perAction[i]&&(this.options[t][i].enabled=!1!==e[i].enabled)):h(e[i])&&o(Tt.perAction[i])?this.options[t][i].enabled=e[i]:void 0!==e[i]&&(this.options[t][i]=e[i]))},dropzone:function(t){return o(t)?(this.options.drop.enabled=!1!==t.enabled,this.setOnEvents("drop",t),/^(pointer|center)$/.test(t.overlap)?this.options.drop.overlap=t.overlap:l(t.overlap)&&(this.options.drop.overlap=Math.max(Math.min(1,t.overlap),0)),"accept"in t&&(this.options.drop.accept=t.accept),"checker"in t&&(this.options.drop.checker=t.checker),this):h(t)?(this.options.drop.enabled=t,this):this.options.drop},dropCheck:function(t,e,i,s,n,r){var o=!1;if(!(r=r||this.getRect(n)))return!!this.options.drop.checker&&this.options.drop.checker(t,e,o,this,n,i,s);var a=this.options.drop.overlap;if("pointer"===a){var h,d,u=y(t),c=A(i,s);u.x+=c.x,u.y+=c.y,h=u.x>r.left&&u.x<r.right,d=u.y>r.top&&u.y<r.bottom,o=h&&d}var p=i.getRect(s);if("center"===a){var f=p.left+p.width/2,m=p.top+p.height/2;o=f>=r.left&&f<=r.right&&m>=r.top&&m<=r.bottom}return l(a)&&(o=Math.max(0,Math.min(r.right,p.right)-Math.max(r.left,p.left))*Math.max(0,Math.min(r.bottom,p.bottom)-Math.max(r.top,p.top))/(p.width*p.height)>=a),this.options.drop.checker&&(o=this.options.drop.checker(t,e,o,this,n,i,s)),o},dropChecker:function(t){return a(t)?(this.options.drop.checker=t,this):null===t?(delete this.options.getRect,this):this.options.drop.checker},accept:function(t){return i(t)?(this.options.drop.accept=t,this):u(t)?(this.options.drop.accept=t,this):null===t?(delete this.options.drop.accept,this):this.options.drop.accept},resizable:function(t){return o(t)?(this.options.resize.enabled=!1!==t.enabled,this.setPerAction("resize",t),this.setOnEvents("resize",t),/^x$|^y$|^xy$/.test(t.axis)?this.options.resize.axis=t.axis:null===t.axis&&(this.options.resize.axis=Tt.resize.axis),h(t.preserveAspectRatio)?this.options.resize.preserveAspectRatio=t.preserveAspectRatio:h(t.square)&&(this.options.resize.square=t.square),this):h(t)?(this.options.resize.enabled=t,this):this.options.resize},squareResize:function(t){return h(t)?(this.options.resize.square=t,this):null===t?(delete this.options.resize.square,this):this.options.resize.square},gesturable:function(t){return o(t)?(this.options.gesture.enabled=!1!==t.enabled,this.setPerAction("gesture",t),this.setOnEvents("gesture",t),this):h(t)?(this.options.gesture.enabled=t,this):this.options.gesture},autoScroll:function(t){return o(t)?t=c({actions:["drag","resize"]},t):h(t)&&(t={actions:["drag","resize"],enabled:t}),this.setOptions("autoScroll",t)},snap:function(t){var e=this.setOptions("snap",t);return e===this?this:e.drag},setOptions:function(t,e){var i,s=e&&r(e.actions)?e.actions:["drag"];if(o(e)||h(e)){for(i=0;i<s.length;i++){var n=/resize/.test(s[i])?"resize":s[i];if(o(this.options[n])){var a=this.options[n][t];o(e)?(c(a,e),a.enabled=!1!==e.enabled,"snap"===t&&("grid"===a.mode?a.targets=[tt.createSnapGrid(c({offset:a.gridOffset||{x:0,y:0}},a.grid||{}))]:"anchor"===a.mode?a.targets=a.anchors:"path"===a.mode&&(a.targets=a.paths),"elementOrigin"in e&&(a.relativePoints=[e.elementOrigin]))):h(e)&&(a.enabled=e)}}return this}var l={},d=["drag","resize","gesture"];for(i=0;i<d.length;i++)t in Tt[d[i]]&&(l[d[i]]=this.options[d[i]][t]);return l},inertia:function(t){var e=this.setOptions("inertia",t);return e===this?this:e.drag},getAction:function(t,e,i,s){var n=this.defaultActionChecker(t,i,s);return this.options.actionChecker?this.options.actionChecker(t,e,n,this,s,i):n},defaultActionChecker:J,actionChecker:function(t){return a(t)?(this.options.actionChecker=t,this):null===t?(delete this.options.actionChecker,this):this.options.actionChecker},getRect:function(t){return t=t||this._element,this.selector&&!i(t)&&(t=this._context.querySelector(this.selector)),k(t)},rectChecker:function(t){return a(t)?(this.getRect=t,this):null===t?(delete this.options.getRect,this):this.getRect},styleCursor:function(t){return h(t)?(this.options.styleCursor=t,this):null===t?(delete this.options.styleCursor,this):this.options.styleCursor},preventDefault:function(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):h(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault},origin:function(t){return u(t)?(this.options.origin=t,this):o(t)?(this.options.origin=t,this):this.options.origin},deltaSource:function(t){return"page"===t||"client"===t?(this.options.deltaSource=t,this):this.options.deltaSource},restrict:function(t){if(!o(t))return this.setOptions("restrict",t);for(var e,i=["drag","resize","gesture"],s=0;s<i.length;s++){var n=i[s];if(n in t){var r=c({actions:[n],restriction:t[n]},t);e=this.setOptions("restrict",r)}}return e},context:function(){return this._context},_context:ct,ignoreFrom:function(t){return u(t)?(this.options.ignoreFrom=t,this):i(t)?(this.options.ignoreFrom=t,this):this.options.ignoreFrom},allowFrom:function(t){return u(t)?(this.options.allowFrom=t,this):i(t)?(this.options.allowFrom=t,this):this.options.allowFrom},element:function(){return this._element},fire:function(t){if(!t||!t.type||!ot(Lt,t.type))return this;var e,i,s,n="on"+t.type;if(t.type in this._iEvents)for(i=0,s=(e=this._iEvents[t.type]).length;i<s&&!t.immediatePropagationStopped;i++)e[i].name,e[i](t);if(a(this[n])&&(this[n].name,this[n](t)),t.type in Rt&&(e=Rt[t.type]))for(i=0,s=e.length;i<s&&!t.immediatePropagationStopped;i++)e[i].name,e[i](t);return this},on:function(t,e,i){var s;if(d(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),r(t)){for(s=0;s<t.length;s++)this.on(t[s],e,i);return this}if(o(t)){for(var n in t)this.on(n,t[n],e);return this}if("wheel"===t&&(t=jt),i=!!i,ot(Lt,t))t in this._iEvents?this._iEvents[t].push(e):this._iEvents[t]=[e];else if(this.selector){if(!Et[t])for(Et[t]={selectors:[],contexts:[],listeners:[]},s=0;s<wt.length;s++)Ht.add(wt[s],t,K),Ht.add(wt[s],t,Z,!0);var a,l=Et[t];for(a=l.selectors.length-1;a>=0&&(l.selectors[a]!==this.selector||l.contexts[a]!==this._context);a--);-1===a&&(a=l.selectors.length,l.selectors.push(this.selector),l.contexts.push(this._context),l.listeners.push([])),l.listeners[a].push([e,i])}else Ht.add(this._element,t,e,i);return this},off:function(t,e,i){var s;if(d(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),r(t)){for(s=0;s<t.length;s++)this.off(t[s],e,i);return this}if(o(t)){for(var n in t)this.off(n,t[n],e);return this}var a,l=-1;if(i=!!i,"wheel"===t&&(t=jt),ot(Lt,t))(a=this._iEvents[t])&&-1!==(l=rt(a,e))&&this._iEvents[t].splice(l,1);else if(this.selector){var h=Et[t],u=!1;if(!h)return this;for(l=h.selectors.length-1;l>=0;l--)if(h.selectors[l]===this.selector&&h.contexts[l]===this._context){var c=h.listeners[l];for(s=c.length-1;s>=0;s--){var p=c[s][0],f=c[s][1];if(p===e&&f===i){c.splice(s,1),c.length||(h.selectors.splice(l,1),h.contexts.splice(l,1),h.listeners.splice(l,1),Ht.remove(this._context,t,K),Ht.remove(this._context,t,Z,!0),h.selectors.length||(Et[t]=null)),u=!0;break}}if(u)break}}else Ht.remove(this._element,t,e,i);return this},set:function(t){o(t)||(t={}),this.options=c({},Tt.base);var e,i=["drag","drop","resize","gesture"],s=["draggable","dropzone","resizable","gesturable"],n=c(c({},Tt.perAction),t[r]||{});for(e=0;e<i.length;e++){var r=i[e];this.options[r]=c({},Tt[r]),this.setPerAction(r,n),this[s[e]](t[r])}var a=["accept","actionChecker","allowFrom","deltaSource","dropChecker","ignoreFrom","origin","preventDefault","rectChecker","styleCursor"];for(e=0,Gt=a.length;e<Gt;e++){var l=a[e];this.options[l]=Tt.base[l],l in t&&this[l](t[l])}return this},unset:function(){if(Ht.remove(this._element,"all"),d(this.selector))for(var t in Et)for(var e=Et[t],i=0;i<e.selectors.length;i++){e.selectors[i]===this.selector&&e.contexts[i]===this._context&&(e.selectors.splice(i,1),e.contexts.splice(i,1),e.listeners.splice(i,1),e.selectors.length||(Et[t]=null)),Ht.remove(this._context,t,K),Ht.remove(this._context,t,Z,!0);break}else Ht.remove(this,"all"),this.options.styleCursor&&(this._element.style.cursor="");return this.dropzone(!1),xt.splice(rt(xt,this),1),tt}}).snap=it(et.prototype.snap,"Interactable#snap is deprecated. See the new documentation for snapping at http://interactjs.io/docs/snapping"),et.prototype.restrict=it(et.prototype.restrict,"Interactable#restrict is deprecated. See the new documentation for resticting at http://interactjs.io/docs/restriction"),et.prototype.inertia=it(et.prototype.inertia,"Interactable#inertia is deprecated. See the new documentation for inertia at http://interactjs.io/docs/inertia"),et.prototype.autoScroll=it(et.prototype.autoScroll,"Interactable#autoScroll is deprecated. See the new documentation for autoScroll at http://interactjs.io/docs/#autoscroll"),et.prototype.squareResize=it(et.prototype.squareResize,"Interactable#squareResize is deprecated. See http://interactjs.io/docs/#resize-square"),et.prototype.accept=it(et.prototype.accept,"Interactable#accept is deprecated. use Interactable#dropzone({ accept: target }) instead"),et.prototype.dropChecker=it(et.prototype.dropChecker,"Interactable#dropChecker is deprecated. use Interactable#dropzone({ dropChecker: checkerFunction }) instead"),et.prototype.context=it(et.prototype.context,"Interactable#context as a method is deprecated. It will soon be a DOM Node instead"),tt.isSet=function(t,e){return-1!==xt.indexOfElement(t,e&&e.context)},tt.on=function(t,e,i){if(d(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),r(t)){for(var s=0;s<t.length;s++)tt.on(t[s],e,i);return tt}if(o(t)){for(var n in t)tt.on(n,t[n],e);return tt}return ot(Lt,t)?Rt[t]?Rt[t].push(e):Rt[t]=[e]:Ht.add(ct,t,e,i),tt},tt.off=function(t,e,i){if(d(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),r(t)){for(var s=0;s<t.length;s++)tt.off(t[s],e,i);return tt}if(o(t)){for(var n in t)tt.off(n,t[n],e);return tt}var a;ot(Lt,t)?t in Rt&&-1!==(a=rt(Rt[t],e))&&Rt[t].splice(a,1):Ht.remove(ct,t,e,i);return tt},tt.enableDragging=it(function(t){return null!==t&&void 0!==t?(Ft.drag=t,tt):Ft.drag},"interact.enableDragging is deprecated and will soon be removed."),tt.enableResizing=it(function(t){return null!==t&&void 0!==t?(Ft.resize=t,tt):Ft.resize},"interact.enableResizing is deprecated and will soon be removed."),tt.enableGesturing=it(function(t){return null!==t&&void 0!==t?(Ft.gesture=t,tt):Ft.gesture},"interact.enableGesturing is deprecated and will soon be removed."),tt.eventTypes=Lt,tt.debug=function(){var t=Ct[0]||new B;return{interactions:Ct,target:t.target,dragging:t.dragging,resizing:t.resizing,gesturing:t.gesturing,prepared:t.prepared,matches:t.matches,matchElements:t.matchElements,prevCoords:t.prevCoords,startCoords:t.startCoords,pointerIds:t.pointerIds,pointers:t.pointers,addPointer:Qt.addPointer,removePointer:Qt.removePointer,recordPointer:Qt.recordPointer,snap:t.snapStatus,restrict:t.restrictStatus,inertia:t.inertiaStatus,downTime:t.downTimes[0],downEvent:t.downEvent,downPointer:t.downPointer,prevEvent:t.prevEvent,Interactable:et,interactables:xt,pointerIsDown:t.pointerIsDown,defaultOptions:Tt,defaultActionChecker:J,actionCursors:Pt,dragMove:Qt.dragMove,resizeMove:Qt.resizeMove,gestureMove:Qt.gestureMove,pointerUp:Qt.pointerUp,pointerDown:Qt.pointerDown,pointerMove:Qt.pointerMove,pointerHover:Qt.pointerHover,eventTypes:Lt,events:Ht,globalEvents:Rt,delegatedEvents:Et,prefixedPropREs:Ut}},tt.getPointerAverage=T,tt.getTouchBBox=S,tt.getTouchDistance=D,tt.getTouchAngle=O,tt.getElementRect=k,tt.getElementClientRect=C,tt.matchesSelector=at,tt.closest=P,tt.margin=it(function(t){return l(t)?(At=t,tt):At},"interact.margin is deprecated. Use interact(target).resizable({ margin: number }); instead."),tt.supportsTouch=function(){return Dt},tt.supportsPointerEvent=function(){return Ot},tt.stop=function(t){for(var e=Ct.length-1;e>=0;e--)Ct[e].stop(t);return tt},tt.dynamicDrop=function(t){return h(t)?(kt=t,tt):kt},tt.pointerMoveTolerance=function(t){return l(t)?(Mt=t,this):Mt},tt.maxInteractions=function(t){return l(t)?(It=t,this):It},tt.createSnapGrid=function(t){return function(e,i){var s=0,n=0;o(t.offset)&&(s=t.offset.x,n=t.offset.y);var r=Math.round((e-s)/t.x),a=Math.round((i-n)/t.y);return{x:r*t.x+s,y:a*t.y+n,range:t.range}}},nt(ct),Vt in Element.prototype&&a(Element.prototype[Vt])||(dt=function(t,e,i){for(var s=0,n=(i=i||t.parentNode.querySelectorAll(e)).length;s<n;s++)if(i[s]===t)return!0;return!1}),function(){for(var e=0,i=["ms","moz","webkit","o"],s=0;s<i.length&&!t.requestAnimationFrame;++s)qt=t[i[s]+"RequestAnimationFrame"],Bt=t[i[s]+"CancelAnimationFrame"]||t[i[s]+"CancelRequestAnimationFrame"];qt||(qt=function(t){var i=(new Date).getTime(),s=Math.max(0,16-(i-e)),n=setTimeout(function(){t(i+s)},s);return e=i+s,n}),Bt||(Bt=function(t){clearTimeout(t)})}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=tt),exports.interact=tt):"function"==typeof define&&define.amd?define("interact",function(){return tt}):t.interact=tt}var Xt}("undefined"==typeof window?void 0:window),function(t){t.fn.businessHours=function(e){function i(t,e,i){t.val(e),i&&t.prop("readonly",!0)}var s={preInit:function(){},postInit:function(){},inputDisabled:!1,checkedColorClass:"WorkingDayState",uncheckedColorClass:"RestDayState",colorBoxValContainerClass:"colorBoxContainer",weekdays:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],operationTime:[{},{},{},{},{},{isActive:!1},{isActive:!1}],defaultOperationTimeFrom:"9:00",defaultOperationTimeTill:"18:00",defaultActive:!0,containerTmpl:'<div class="clean"/>',dayTmpl:'<div class="dayContainer"><div data-original-title="" class="colorBox"><input type="checkbox" class="invisible operationState"/></div><div class="weekday"></div><div class="operationDayTimeContainer"><div class="operationTime"><input type="text" name="startTime" class="mini-time operationTimeFrom" value=""/></div><div class="operationTime"><input type="text" name="endTime" class="mini-time operationTimeTill" value=""/></div></div></div>'},n=t(this);return{getValueOrDefault:function(t,e){return"undefined"===jQuery.type(t)||null==t?e:t},init:function(e){return this.options=t.extend(s,e),n.html(""),"function"==typeof this.options.preInit&&this.options.preInit(),this.initView(this.options),"function"==typeof this.options.postInit&&this.options.postInit(),{serialize:function(){var e=[];return n.find(".operationState").each(function(i,s){var n=t(s).prop("checked"),r=t(s).parents(".dayContainer");e.push({isActive:n,timeFrom:n?r.find("[name='startTime']").val():null,timeTill:n?r.find("[name='endTime']").val():null})}),e}}},initView:function(e){for(var s=[e.checkedColorClass,e.uncheckedColorClass],r=n.append(t(e.containerTmpl)),o=this,a=0;a<e.weekdays.length;a++)r.append(e.dayTmpl);t.each(e.weekdays,function(t,s){var r=e.operationTime[t],a=n.find(".dayContainer").eq(t);a.find(".weekday").html(s);var l=o.getValueOrDefault(r.isActive,e.defaultActive);a.find(".operationState").prop("checked",l);var h=o.getValueOrDefault(r.timeFrom,e.defaultOperationTimeFrom);i(a.find('[name="startTime"]'),h,e.inputDisabled);var d=o.getValueOrDefault(r.timeTill,e.defaultOperationTimeTill);i(a.find('[name="endTime"]'),d,e.inputDisabled)}),n.find(".operationState").change(function(){var i=t(this),n=e.checkedColorClass,r=!1;i.prop("checked")||(n=e.uncheckedColorClass,r=!0),i.parents(".colorBox").removeClass(s.join(" ")).addClass(n),i.parents(".dayContainer").find(".operationTime").toggle(!r)}).trigger("change"),e.inputDisabled||n.find(".colorBox").on("click",function(){var e=t(this).find(".operationState");e.prop("checked",!e.prop("checked")).trigger("change")})}}.init(e)}}(jQuery),function(t){"object"==typeof exports&&exports&&"object"==typeof module&&module&&module.exports===exports?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(t){var e=t[0];return e.offsetWidth>0&&e.offsetHeight>0}function i(e){if(e.minTime&&(e.minTime=_(e.minTime)),e.maxTime&&(e.maxTime=_(e.maxTime)),e.durationTime&&"function"!=typeof e.durationTime&&(e.durationTime=_(e.durationTime)),"now"==e.scrollDefault)e.scrollDefault=function(){return e.roundingFunction(_(new Date),e)};else if(e.scrollDefault&&"function"!=typeof e.scrollDefault){var i=e.scrollDefault;e.scrollDefault=function(){return e.roundingFunction(_(i),e)}}else e.minTime&&(e.scrollDefault=function(){return e.roundingFunction(e.minTime,e)});if("string"===t.type(e.timeFormat)&&e.timeFormat.match(/[gh]/)&&(e._twelveHourTime=!0),!1===e.showOnFocus&&-1!=e.showOn.indexOf("focus")&&e.showOn.splice(e.showOn.indexOf("focus"),1),e.disableTimeRanges.length>0){for(var s in e.disableTimeRanges)e.disableTimeRanges[s]=[_(e.disableTimeRanges[s][0]),_(e.disableTimeRanges[s][1])];e.disableTimeRanges=e.disableTimeRanges.sort(function(t,e){return t[0]-e[0]});for(s=e.disableTimeRanges.length-1;s>0;s--)e.disableTimeRanges[s][0]<=e.disableTimeRanges[s-1][1]&&(e.disableTimeRanges[s-1]=[Math.min(e.disableTimeRanges[s][0],e.disableTimeRanges[s-1][0]),Math.max(e.disableTimeRanges[s][1],e.disableTimeRanges[s-1][1])],e.disableTimeRanges.splice(s,1))}return e}function s(e){var i=e.data("timepicker-settings"),s=e.data("timepicker-list");if(s&&s.length&&(s.remove(),e.data("timepicker-list",!1)),i.useSelect)var o=s=t("<select />",{class:"ui-timepicker-select"});else s=t("<ul />",{class:"ui-timepicker-list"}),(o=t("<div />",{class:"ui-timepicker-wrapper",tabindex:-1})).css({display:"none",position:"absolute"}).append(s);if(i.noneOption)if(!0===i.noneOption&&(i.noneOption=i.useSelect?"Time...":"None"),t.isArray(i.noneOption)){for(var l in i.noneOption)if(parseInt(l,10)==l){var d=n(i.noneOption[l],i.useSelect);s.append(d)}}else{d=n(i.noneOption,i.useSelect);s.append(d)}i.className&&o.addClass(i.className),null===i.minTime&&null===i.durationTime||!i.showDuration||("function"==typeof i.step||i.step,o.addClass("ui-timepicker-with-duration"),o.addClass("ui-timepicker-step-"+i.step));var u=i.minTime;"function"==typeof i.durationTime?u=_(i.durationTime()):null!==i.durationTime&&(u=i.durationTime);var p=null!==i.minTime?i.minTime:0,f=null!==i.maxTime?i.maxTime:p+w-1;f<p&&(f+=w),f===w-1&&"string"===t.type(i.timeFormat)&&i.show2400&&(f=w);var m=i.disableTimeRanges,x=0,C=m.length,E=i.step;"function"!=typeof E&&(E=function(){return i.step});l=p;for(var T=0;l<=f;l+=60*E(++T)){var S,D=l,O=y(D,i);if(i.useSelect)(S=t("<option />",{value:O})).text(O);else(S=t("<li />")).addClass(D%w<w/2?"ui-timepicker-am":"ui-timepicker-pm"),S.data("time",b(D,i)),S.text(O);if((null!==i.minTime||null!==i.durationTime)&&i.showDuration){var A=v(l-u,i.step);if(i.useSelect)S.text(S.text()+" ("+A+")");else{var M=t("<span />",{class:"ui-timepicker-duration"});M.text(" ("+A+")"),S.append(M)}}x<C&&(D>=m[x][1]&&(x+=1),m[x]&&D>=m[x][0]&&D<m[x][1]&&(i.useSelect?S.prop("disabled",!0):S.addClass("ui-timepicker-disabled"))),s.append(S)}if(o.data("timepicker-input",e),e.data("timepicker-list",o),i.useSelect)e.val()&&s.val(r(_(e.val()),i)),s.on("focus",function(){t(this).data("timepicker-input").trigger("showTimepicker")}),s.on("blur",function(){t(this).data("timepicker-input").trigger("hideTimepicker")}),s.on("change",function(){c(e,t(this).val(),"select")}),c(e,s.val(),"initial"),e.hide().after(s);else{var N=i.appendTo;"string"==typeof N?N=t(N):"function"==typeof N&&(N=N(e)),N.append(o),h(e,s),s.on("mousedown click","li",function(i){e.off("focus.timepicker"),e.on("focus.timepicker-ie-hack",function(){e.off("focus.timepicker-ie-hack"),e.on("focus.timepicker",k.show)}),a(e)||e[0].focus(),s.find("li").removeClass("ui-timepicker-selected"),t(this).addClass("ui-timepicker-selected"),g(e)&&(e.trigger("hideTimepicker"),s.on("mouseup.timepicker click.timepicker","li",function(t){s.off("mouseup.timepicker click.timepicker"),o.hide()}))})}}function n(e,i){var s,n,r;return"object"==typeof e?(s=e.label,n=e.className,r=e.value):"string"==typeof e?(s=e,r=""):t.error("Invalid noneOption value"),i?t("<option />",{value:r,class:n,text:s}):t("<li />",{class:n,text:s}).data("time",String(r))}function r(t,e){if(null!==(t=e.roundingFunction(t,e)))return y(t,e)}function o(e){if(e.target!=window){var i=t(e.target);i.closest(".ui-timepicker-input").length||i.closest(".ui-timepicker-wrapper").length||(k.hide(),t(document).unbind(".ui-timepicker"),t(window).unbind(".ui-timepicker"))}}function a(t){var e=t.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&e.disableTouchKeyboard}function l(e,i,s){if(!s&&0!==s)return!1;var n=e.data("timepicker-settings"),r=!1;s=n.roundingFunction(s,n);return i.find("li").each(function(e,i){var n=t(i);if("number"==typeof n.data("time"))return n.data("time")==s?(r=n,!1):void 0}),r}function h(t,e){e.find("li").removeClass("ui-timepicker-selected");var i=t.data("timepicker-settings"),s=_(u(t),i);if(null!==s){var n=l(t,e,s);if(n){var r=n.offset().top-e.offset().top;(r+n.outerHeight()>e.outerHeight()||r<0)&&e.scrollTop(e.scrollTop()+n.position().top-n.outerHeight()),(i.forceRoundTime||n.data("time")===s)&&n.addClass("ui-timepicker-selected")}}}function d(e,i){if("timepicker"!=i){var s=t(this);if(""===this.value)return void c(s,null,i);if(!s.is(":focus")||e&&"change"==e.type){var n=s.data("timepicker-settings"),r=_(this.value,n);if(null===r)return void s.trigger("timeFormatError");var o=!1;if(null!==n.minTime&&null!==n.maxTime&&(r<n.minTime||r>n.maxTime)&&(o=!0),t.each(n.disableTimeRanges,function(){if(r>=this[0]&&r<this[1])return o=!0,!1}),n.forceRoundTime){var a=n.roundingFunction(r,n);a!=r&&(r=a,i=null)}var l=y(r,n);o?(c(s,l,"error")||e&&"change"==e.type)&&s.trigger("timeRangeError"):c(s,l,i)}}}function u(t){return t.is("input")?t.val():t.data("ui-timepicker-value")}function c(t,e,i){if(t.is("input")){t.val(e);var s=t.data("timepicker-settings");s.useSelect&&"select"!=i&&t.data("timepicker-list").val(r(_(e),s))}return t.data("ui-timepicker-value")!=e?(t.data("ui-timepicker-value",e),"select"==i?t.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):-1==["error","initial"].indexOf(i)&&t.trigger("changeTime"),!0):(-1==["error","initial"].indexOf(i)&&t.trigger("selectTime"),!1)}function p(t){switch(t.keyCode){case 13:case 9:return;default:t.preventDefault()}}function f(i){var s=t(this),n=s.data("timepicker-list");if(!n||!e(n)){if(40!=i.keyCode)return!0;k.show.call(s.get(0)),n=s.data("timepicker-list"),a(s)||s.focus()}switch(i.keyCode){case 13:return g(s)&&(d.call(s.get(0),{type:"change"}),k.hide.apply(this)),i.preventDefault(),!1;case 38:var r=n.find(".ui-timepicker-selected");return r.length?r.is(":first-child")||(r.removeClass("ui-timepicker-selected"),r.prev().addClass("ui-timepicker-selected"),r.prev().position().top<r.outerHeight()&&n.scrollTop(n.scrollTop()-r.outerHeight())):(n.find("li").each(function(e,i){if(t(i).position().top>0)return r=t(i),!1}),r.addClass("ui-timepicker-selected")),!1;case 40:return 0===(r=n.find(".ui-timepicker-selected")).length?(n.find("li").each(function(e,i){if(t(i).position().top>0)return r=t(i),!1}),r.addClass("ui-timepicker-selected")):r.is(":last-child")||(r.removeClass("ui-timepicker-selected"),r.next().addClass("ui-timepicker-selected"),r.next().position().top+2*r.outerHeight()>n.outerHeight()&&n.scrollTop(n.scrollTop()+r.outerHeight())),!1;case 27:n.find("li").removeClass("ui-timepicker-selected"),k.hide();break;case 9:k.hide();break;default:return!0}}function m(i){var s=t(this),n=s.data("timepicker-list"),r=s.data("timepicker-settings");if(!n||!e(n)||r.disableTextInput)return!0;if("paste"!==i.type&&"cut"!==i.type)switch(i.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:r.typeaheadHighlight?h(s,n):n.hide()}else setTimeout(function(){r.typeaheadHighlight?h(s,n):n.hide()},0)}function g(t){var e=t.data("timepicker-settings"),i=null,s=t.data("timepicker-list").find(".ui-timepicker-selected");return!s.hasClass("ui-timepicker-disabled")&&(s.length&&(i=s.data("time")),null!==i&&("string"!=typeof i&&(i=y(i,e)),c(t,i,"select")),!0)}function v(t,e){t=Math.abs(t);var i,s,n=Math.round(t/60),r=[];return n<60?r=[n,x.mins]:(i=Math.floor(n/60),s=n%60,30==e&&30==s&&(i+=x.decimal+5),r.push(i),r.push(1==i?x.hr:x.hrs),30!=e&&s&&(r.push(s),r.push(x.mins))),r.join(" ")}function y(e,i){if("number"!=typeof e)return null;var s=parseInt(e%60),n=parseInt(e/60%60),r=parseInt(e/3600%24),o=new Date(1970,0,2,r,n,s,0);if(isNaN(o.getTime()))return null;if("function"===t.type(i.timeFormat))return i.timeFormat(o);for(var a,l,h="",d=0;d<i.timeFormat.length;d++)switch(l=i.timeFormat.charAt(d)){case"a":h+=o.getHours()>11?x.pm:x.am;break;case"A":h+=o.getHours()>11?x.PM:x.AM;break;case"g":h+=0===(a=o.getHours()%12)?"12":a;break;case"G":a=o.getHours(),e===w&&(a=i.show2400?24:0),h+=a;break;case"h":0!==(a=o.getHours()%12)&&a<10&&(a="0"+a),h+=0===a?"12":a;break;case"H":a=o.getHours(),e===w&&(a=i.show2400?24:0),h+=a>9?a:"0"+a;break;case"i":h+=(n=o.getMinutes())>9?n:"0"+n;break;case"s":h+=(s=o.getSeconds())>9?s:"0"+s;break;case"\\":d++,h+=i.timeFormat.charAt(d);break;default:h+=l}return h}function _(t,e){if(""===t||null===t)return null;if("object"==typeof t)return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds();if("string"!=typeof t)return t;"a"!=(t=t.toLowerCase().replace(/[\s\.]/g,"")).slice(-1)&&"p"!=t.slice(-1)||(t+="m");var i="("+x.am.replace(".","")+"|"+x.pm.replace(".","")+"|"+x.AM.replace(".","")+"|"+x.PM.replace(".","")+")?",s=new RegExp("^"+i+"([0-9]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?"+i+"$"),n=t.match(s);if(!n)return null;var r=parseInt(1*n[2],10),o=n[1]||n[5],a=r,l=1*n[3]||0,h=1*n[4]||0;if(r<=12&&o){var d=o==x.pm||o==x.PM;a=12==r?d?12:0:r+(d?12:0)}else if(e){if(3600*r+60*l+h>=w+(e.show2400?1:0)){if(!1===e.wrapHours)return null;a=r%24}}var u=3600*a+60*l+h;if(r<12&&!o&&e&&e._twelveHourTime&&e.scrollDefault){var c=u-e.scrollDefault();c<0&&c>=w/-2&&(u=(u+w/2)%w)}return u}function b(t,e){return t==w&&e.show2400?t:t%w}var w=86400,x={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},C={appendTo:"body",className:null,closeOnWindowScroll:!1,disableTextInput:!1,disableTimeRanges:[],disableTouchKeyboard:!1,durationTime:null,forceRoundTime:!1,maxTime:null,minTime:null,noneOption:!1,orientation:"l",roundingFunction:function(t,e){if(null===t)return null;if("number"!=typeof e.step)return t;var i=t%(60*e.step);return(i-=(e.minTime||0)%(60*e.step))>=30*e.step?t+=60*e.step-i:t-=i,b(t,e)},scrollDefault:null,selectOnBlur:!1,show2400:!1,showDuration:!1,showOn:["click","focus"],showOnFocus:!0,step:30,stopScrollPropagation:!1,timeFormat:"g:ia",typeaheadHighlight:!0,useSelect:!1,wrapHours:!0},k={init:function(e){return this.each(function(){var n=t(this),r=[];for(var o in C)n.data(o)&&(r[o]=n.data(o));var a=t.extend({},C,e,r);if(a.lang&&(x=t.extend(x,a.lang)),a=i(a),n.data("timepicker-settings",a),n.addClass("ui-timepicker-input"),a.useSelect)s(n);else{if(n.prop("autocomplete","off"),a.showOn)for(var l in a.showOn)n.on(a.showOn[l]+".timepicker",k.show);n.on("change.timepicker",d),n.on("keydown.timepicker",f),n.on("keyup.timepicker",m),a.disableTextInput&&n.on("keydown.timepicker",p),n.on("cut.timepicker",m),n.on("paste.timepicker",m),d.call(n.get(0),null,"initial")}})},show:function(i){var n=t(this),r=n.data("timepicker-settings");if(i&&i.preventDefault(),r.useSelect)n.data("timepicker-list").focus();else{a(n)&&n.blur();var d=n.data("timepicker-list");if(!n.prop("readonly")&&(d&&0!==d.length&&"function"!=typeof r.durationTime||(s(n),d=n.data("timepicker-list")),!e(d))){n.data("ui-timepicker-value",n.val()),h(n,d),k.hide(),d.show();var c={};r.orientation.match(/r/)?c.left=n.offset().left+n.outerWidth()-d.outerWidth()+parseInt(d.css("marginLeft").replace("px",""),10):c.left=n.offset().left+parseInt(d.css("marginLeft").replace("px",""),10),"t"==(r.orientation.match(/t/)?"t":r.orientation.match(/b/)?"b":n.offset().top+n.outerHeight(!0)+d.outerHeight()>t(window).height()+t(window).scrollTop()?"t":"b")?(d.addClass("ui-timepicker-positioned-top"),c.top=n.offset().top-d.outerHeight()+parseInt(d.css("marginTop").replace("px",""),10)):(d.removeClass("ui-timepicker-positioned-top"),c.top=n.offset().top+n.outerHeight()+parseInt(d.css("marginTop").replace("px",""),10)),d.offset(c);var p=d.find(".ui-timepicker-selected");if(!p.length){var f=_(u(n));null!==f?p=l(n,d,f):r.scrollDefault&&(p=l(n,d,r.scrollDefault()))}if(p.length&&!p.hasClass("ui-timepicker-disabled")||(p=d.find("li:not(.ui-timepicker-disabled):first")),p&&p.length){var m=d.scrollTop()+p.position().top-p.outerHeight();d.scrollTop(m)}else d.scrollTop(0);return r.stopScrollPropagation&&t(document).on("wheel.ui-timepicker",".ui-timepicker-wrapper",function(e){e.preventDefault();var i=t(this).scrollTop();t(this).scrollTop(i+e.originalEvent.deltaY)}),t(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",o),t(window).on("resize.ui-timepicker",o),r.closeOnWindowScroll&&t(document).on("scroll.ui-timepicker",o),n.trigger("showTimepicker"),this}}},hide:function(i){var s=t(this),n=s.data("timepicker-settings");return n&&n.useSelect&&s.blur(),t(".ui-timepicker-wrapper").each(function(){var i=t(this);if(e(i)){var s=i.data("timepicker-input"),n=s.data("timepicker-settings");n&&n.selectOnBlur&&g(s),i.hide(),s.trigger("hideTimepicker")}}),this},option:function(e,n){return"string"==typeof e&&void 0===n?t(this).data("timepicker-settings")[e]:this.each(function(){var r=t(this),o=r.data("timepicker-settings"),a=r.data("timepicker-list");"object"==typeof e?o=t.extend(o,e):"string"==typeof e&&(o[e]=n),o=i(o),r.data("timepicker-settings",o),d.call(r.get(0),{type:"change"},"initial"),a&&(a.remove(),r.data("timepicker-list",!1)),o.useSelect&&s(r)})},getSecondsFromMidnight:function(){return _(u(this))},getTime:function(t){var e=u(this);if(!e)return null;var i=_(e);if(null===i)return null;t||(t=new Date);var s=new Date(t);return s.setHours(i/3600),s.setMinutes(i%3600/60),s.setSeconds(i%60),s.setMilliseconds(0),s},isVisible:function(){var t=this.data("timepicker-list");return!(!t||!e(t))},setTime:function(t){var e=this.data("timepicker-settings");if(e.forceRoundTime)var i=r(_(t),e);else i=y(_(t),e);return t&&null===i&&e.noneOption&&(i=t),c(this,i,"initial"),d.call(this.get(0),{type:"change"},"initial"),this.data("timepicker-list")&&h(this,this.data("timepicker-list")),this},remove:function(){if(this.hasClass("ui-timepicker-input")){var t=this.data("timepicker-settings");return this.removeAttr("autocomplete","off"),this.removeClass("ui-timepicker-input"),this.removeData("timepicker-settings"),this.off(".timepicker"),this.data("timepicker-list")&&this.data("timepicker-list").remove(),t.useSelect&&this.show(),this.removeData("timepicker-list"),this}}};t.fn.timepicker=function(e){return this.length?k[e]?this.hasClass("ui-timepicker-input")?k[e].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.timepicker"):k.init.apply(this,arguments):this}}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){t.registerHelper("lint","json",function(e){var i=[];jsonlint.parseError=function(e,s){var n=s.loc;i.push({from:t.Pos(n.first_line-1,n.first_column),to:t.Pos(n.last_line-1,n.last_column),message:e})};try{jsonlint.parse(e)}catch(t){}return i})}),function(){var t,e,i;e=!1,i=/xyz/.test(function(){window.postMessage("xyz")})?/\b_super\b/:/.*/,(t=function(){}).extend=function t(s){function n(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var o=new this;e=!1;for(var a in s)o[a]="function"==typeof s[a]&&"function"==typeof r[a]&&i.test(s[a])?function(t,e){return function(){var i=this._super;this._super=r[t];var s=e.apply(this,arguments);return this._super=i,s}}(a,s[a]):s[a];return n.prototype=o,n.prototype.constructor=n,n.extend=t,n},function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}t.prototype=window.Event.prototype,window.CustomEvent=t}(),function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var s=(new Date).getTime(),n=Math.max(0,16-(s-t)),r=window.setTimeout(function(){e(s+n)},n);return t=s+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var s=function(t){var e,i,n,r;for(i=1;i<arguments.length;i++){e=arguments[i];for(n in e)e.hasOwnProperty(n)&&(!e[n]||(r=e[n],"object"!=typeof r||r.nodeType||null!==r&&r===r.window||r.constructor&&!Object.prototype.hasOwnProperty.call(r.constructor.prototype,"isPrototypeOf"))?t[n]=e[n]:(t.hasOwnProperty(n)||(t[n]={}),s(t[n],e[n])))}return t},n=function(t,e){var i;if(t&&"object"==typeof t)if(Array.isArray(t)||"number"==typeof t.length&&t.length>0&&t.length-1 in t){for(i=0;i<t.length;i++)if(!1===e(i,t[i]))return}else if(Object.keys){var s=Object.keys(t);for(i=0;i<s.length;i++)if(!1===e(s[i],t[s[i]]))return}else for(i in t)if(t.hasOwnProperty(i)&&!1===e(i,t[i]))return},r=function(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)},o=function(t,e){if(!(t instanceof Element))throw new Error("element should be an instance of Element");e=s({},o.defaults.options,e||{}),this.element=t,this.options=e,this.init()};o.prototype={constructor:o,init:function(){var t=this;this.ready=!1;var e=o.defaults.themes[this.options.theme||o.defaults.theme];if(!e)throw"Unknown theme "+(this.options.theme||o.defaults.theme);this.schema=this.options.schema,this.theme=new e,this.template=this.options.template,this.refs=this.options.refs||{},this.uuid=0,this.__data={};var i=o.defaults.iconlibs[this.options.iconlib||o.defaults.iconlib];i&&(this.iconlib=new i),this.root_container=this.theme.getContainer(),this.element.appendChild(this.root_container),this.translate=this.options.translate||o.defaults.translate,this._loadExternalRefs(this.schema,function(){t._getDefinitions(t.schema);var e={};t.options.custom_validators&&(e.custom_validators=t.options.custom_validators),t.validator=new o.Validator(t,null,e);var i=t.getEditorClass(t.schema);t.root=t.createEditor(i,{jsoneditor:t,schema:t.schema,required:!0,container:t.root_container}),t.root.preBuild(),t.root.build(),t.root.postBuild(),t.options.startval&&t.root.setValue(t.options.startval),t.validation_results=t.validator.validate(t.root.getValue()),t.root.showValidationErrors(t.validation_results),t.ready=!0,window.requestAnimationFrame(function(){t.ready&&(t.validation_results=t.validator.validate(t.root.getValue()),t.root.showValidationErrors(t.validation_results),t.trigger("ready"),t.trigger("change"))})})},getValue:function(){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before getting the value";return this.root.getValue()},setValue:function(t){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before setting the value";return this.root.setValue(t),this},validate:function(t){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before validating";return 1===arguments.length?this.validator.validate(t):this.validation_results},destroy:function(){this.destroyed||this.ready&&(this.schema=null,this.options=null,this.root.destroy(),this.root=null,this.root_container=null,this.validator=null,this.validation_results=null,this.theme=null,this.iconlib=null,this.template=null,this.__data=null,this.ready=!1,this.element.innerHTML="",this.destroyed=!0)},on:function(t,e){return this.callbacks=this.callbacks||{},this.callbacks[t]=this.callbacks[t]||[],this.callbacks[t].push(e),this},off:function(t,e){if(t&&e){this.callbacks=this.callbacks||{},this.callbacks[t]=this.callbacks[t]||[];for(var i=[],s=0;s<this.callbacks[t].length;s++)this.callbacks[t][s]!==e&&i.push(this.callbacks[t][s]);this.callbacks[t]=i}else t?(this.callbacks=this.callbacks||{},this.callbacks[t]=[]):this.callbacks={};return this},trigger:function(t){if(this.callbacks&&this.callbacks[t]&&this.callbacks[t].length)for(var e=0;e<this.callbacks[t].length;e++)this.callbacks[t][e]();return this},setOption:function(t,e){if("show_errors"!==t)throw"Option "+t+" must be set during instantiation and cannot be changed later";return this.options.show_errors=e,this.onChange(),this},getEditorClass:function(t){var e;if(t=this.expandSchema(t),n(o.defaults.resolvers,function(i,s){var n=s(t);if(n&&o.defaults.editors[n])return e=n,!1}),!e)throw"Unknown editor for schema "+JSON.stringify(t);if(!o.defaults.editors[e])throw"Unknown editor "+e;return o.defaults.editors[e]},createEditor:function(t,e){return new t(e=s({},t.options||{},e))},onChange:function(){if(this.ready&&!this.firing_change){this.firing_change=!0;var t=this;return window.requestAnimationFrame(function(){t.firing_change=!1,t.ready&&(t.validation_results=t.validator.validate(t.root.getValue()),"never"!==t.options.show_errors?t.root.showValidationErrors(t.validation_results):t.root.showValidationErrors([]),t.trigger("change"))}),this}},compileTemplate:function(t,e){var i;if("string"==typeof(e=e||o.defaults.template)){if(!o.defaults.templates[e])throw"Unknown template engine "+e;if(!(i=o.defaults.templates[e]()))throw"Template engine "+e+" missing required library."}else i=e;if(!i)throw"No template engine set";if(!i.compile)throw"Invalid template engine set";return i.compile(t)},_data:function(t,e,i){if(3!==arguments.length)return t.hasAttribute("data-jsoneditor-"+e)?this.__data[t.getAttribute("data-jsoneditor-"+e)]:null;var s;t.hasAttribute("data-jsoneditor-"+e)?s=t.getAttribute("data-jsoneditor-"+e):(s=this.uuid++,t.setAttribute("data-jsoneditor-"+e,s)),this.__data[s]=i},registerEditor:function(t){return this.editors=this.editors||{},this.editors[t.path]=t,this},unregisterEditor:function(t){return this.editors=this.editors||{},this.editors[t.path]=null,this},getEditor:function(t){if(this.editors)return this.editors[t]},watch:function(t,e){return this.watchlist=this.watchlist||{},this.watchlist[t]=this.watchlist[t]||[],this.watchlist[t].push(e),this},unwatch:function(t,e){if(!this.watchlist||!this.watchlist[t])return this;if(!e)return this.watchlist[t]=null,this;for(var i=[],s=0;s<this.watchlist[t].length;s++)this.watchlist[t][s]!==e&&i.push(this.watchlist[t][s]);return this.watchlist[t]=i.length?i:null,this},notifyWatchers:function(t){if(!this.watchlist||!this.watchlist[t])return this;for(var e=0;e<this.watchlist[t].length;e++)this.watchlist[t][e]()},isEnabled:function(){return!this.root||this.root.isEnabled()},enable:function(){this.root.enable()},disable:function(){this.root.disable()},_getDefinitions:function(t,e){if(e=e||"#/definitions/",t.definitions)for(var i in t.definitions)t.definitions.hasOwnProperty(i)&&(this.refs[e+i]=t.definitions[i],t.definitions[i].definitions&&this._getDefinitions(t.definitions[i],e+i+"/definitions/"))},_getExternalRefs:function(t){var e={},i=function(t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=!0)};t.$ref&&"object"!=typeof t.$ref&&"#"!==t.$ref.substr(0,1)&&!this.refs[t.$ref]&&(e[t.$ref]=!0);for(var s in t)if(t.hasOwnProperty(s))if(t[s]&&"object"==typeof t[s]&&Array.isArray(t[s]))for(var n=0;n<t[s].length;n++)"object"==typeof t[s][n]&&i(this._getExternalRefs(t[s][n]));else t[s]&&"object"==typeof t[s]&&i(this._getExternalRefs(t[s]));return e},_loadExternalRefs:function(t,e){var i=this,s=this._getExternalRefs(t),r=0,o=0,a=!1;n(s,function(t){if(!i.refs[t]){if(!i.options.ajax)throw"Must set ajax option to true to load external ref "+t;i.refs[t]="loading",o++;var s=new XMLHttpRequest;s.open("GET",t,!0),s.onreadystatechange=function(){if(4==s.readyState){if(200!==s.status)throw window.console.log(s),"Failed to fetch ref via ajax- "+t;var n;try{n=JSON.parse(s.responseText)}catch(e){throw window.console.log(e),"Failed to parse external ref "+t}if(!n||"object"!=typeof n)throw"External ref does not contain a valid schema - "+t;i.refs[t]=n,i._loadExternalRefs(n,function(){++r>=o&&!a&&(a=!0,e())})}},s.send()}}),o||e()},expandRefs:function(t){for(t=s({},t);t.$ref;){var e=t.$ref;delete t.$ref,this.refs[e]||(e=decodeURIComponent(e)),t=this.extendSchemas(t,this.refs[e])}return t},expandSchema:function(t){var e,i=this,r=s({},t);if("object"==typeof t.type&&(Array.isArray(t.type)?n(t.type,function(e,s){"object"==typeof s&&(t.type[e]=i.expandSchema(s))}):t.type=i.expandSchema(t.type)),"object"==typeof t.disallow&&(Array.isArray(t.disallow)?n(t.disallow,function(e,s){"object"==typeof s&&(t.disallow[e]=i.expandSchema(s))}):t.disallow=i.expandSchema(t.disallow)),t.anyOf&&n(t.anyOf,function(e,s){t.anyOf[e]=i.expandSchema(s)}),t.dependencies&&n(t.dependencies,function(e,s){"object"!=typeof s||Array.isArray(s)||(t.dependencies[e]=i.expandSchema(s))}),t.not&&(t.not=this.expandSchema(t.not)),t.allOf){for(e=0;e<t.allOf.length;e++)r=this.extendSchemas(r,this.expandSchema(t.allOf[e]));delete r.allOf}if(t.extends){if(Array.isArray(t.extends))for(e=0;e<t.extends.length;e++)r=this.extendSchemas(r,this.expandSchema(t.extends[e]));else r=this.extendSchemas(r,this.expandSchema(t.extends));delete r.extends}if(t.oneOf){var o=s({},r);for(delete o.oneOf,e=0;e<t.oneOf.length;e++)r.oneOf[e]=this.extendSchemas(this.expandSchema(t.oneOf[e]),o)}return this.expandRefs(r)},extendSchemas:function(t,e){t=s({},t),e=s({},e);var i=this,r={};return n(t,function(t,s){void 0!==e[t]?"required"!==t&&"defaultProperties"!==t||"object"!=typeof s||!Array.isArray(s)?"type"!==t||"string"!=typeof s&&!Array.isArray(s)?"object"==typeof s&&Array.isArray(s)?r[t]=s.filter(function(i){return-1!==e[t].indexOf(i)}):r[t]="object"==typeof s&&null!==s?i.extendSchemas(s,e[t]):s:("string"==typeof s&&(s=[s]),"string"==typeof e.type&&(e.type=[e.type]),e.type&&e.type.length?r.type=s.filter(function(t){return-1!==e.type.indexOf(t)}):r.type=s,1===r.type.length&&"string"==typeof r.type[0]?r.type=r.type[0]:0===r.type.length&&delete r.type):r[t]=s.concat(e[t]).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[]):r[t]=s}),n(e,function(e,i){void 0===t[e]&&(r[e]=i)}),r}},o.defaults={themes:{},templates:{},iconlibs:{},editors:{},languages:{},resolvers:[],custom_validators:[]},o.Validator=t.extend({init:function(t,e,i){this.jsoneditor=t,this.schema=e||this.jsoneditor.schema,this.options=i||{},this.translate=this.jsoneditor.translate||o.defaults.translate},validate:function(t){return this._validateSchema(this.schema,t)},_validateSchema:function(t,e,i){var r,a,l,h=this,d=[],u=JSON.stringify(e);if(i=i||"root",(t=s({},this.jsoneditor.expandRefs(t))).required&&!0===t.required){if(void 0===e)return d.push({path:i,property:"required",message:this.translate("error_notset")}),d}else if(void 0===e){if(!this.jsoneditor.options.required_by_default)return d;d.push({path:i,property:"required",message:this.translate("error_notset")})}if(t.enum){for(r=!1,a=0;a<t.enum.length;a++)u===JSON.stringify(t.enum[a])&&(r=!0);r||d.push({path:i,property:"enum",message:this.translate("error_enum")})}if(t.extends)for(a=0;a<t.extends.length;a++)d=d.concat(this._validateSchema(t.extends[a],e,i));if(t.allOf)for(a=0;a<t.allOf.length;a++)d=d.concat(this._validateSchema(t.allOf[a],e,i));if(t.anyOf){for(r=!1,a=0;a<t.anyOf.length;a++)if(!this._validateSchema(t.anyOf[a],e,i).length){r=!0;break}r||d.push({path:i,property:"anyOf",message:this.translate("error_anyOf")})}if(t.oneOf){r=0;var c=[];for(a=0;a<t.oneOf.length;a++){var p=this._validateSchema(t.oneOf[a],e,i);for(p.length||r++,l=0;l<p.length;l++)p[l].path=i+".oneOf["+a+"]"+p[l].path.substr(i.length);c=c.concat(p)}1!==r&&(d.push({path:i,property:"oneOf",message:this.translate("error_oneOf",[r])}),d=d.concat(c))}if(t.not&&(this._validateSchema(t.not,e,i).length||d.push({path:i,property:"not",message:this.translate("error_not")})),t.type)if(Array.isArray(t.type)){for(r=!1,a=0;a<t.type.length;a++)if(this._checkType(t.type[a],e)){r=!0;break}r||d.push({path:i,property:"type",message:this.translate("error_type_union")})}else this._checkType(t.type,e)||d.push({path:i,property:"type",message:this.translate("error_type",[t.type])});if(t.disallow)if(Array.isArray(t.disallow)){for(r=!0,a=0;a<t.disallow.length;a++)if(this._checkType(t.disallow[a],e)){r=!1;break}r||d.push({path:i,property:"disallow",message:this.translate("error_disallow_union")})}else this._checkType(t.disallow,e)&&d.push({path:i,property:"disallow",message:this.translate("error_disallow",[t.disallow])});if("number"==typeof e){if(t.multipleOf||t.divisibleBy){var f=t.multipleOf||t.divisibleBy;r=e/f===Math.floor(e/f),window.math?r=window.math.mod(window.math.bignumber(e),window.math.bignumber(f)).equals(0):window.Decimal&&(r=new window.Decimal(e).mod(new window.Decimal(f)).equals(0)),r||d.push({path:i,property:t.multipleOf?"multipleOf":"divisibleBy",message:this.translate("error_multipleOf",[f])})}t.hasOwnProperty("maximum")&&(r=t.exclusiveMaximum?e<t.maximum:e<=t.maximum,window.math?r=window.math[t.exclusiveMaximum?"smaller":"smallerEq"](window.math.bignumber(e),window.math.bignumber(t.maximum)):window.Decimal&&(r=new window.Decimal(e)[t.exclusiveMaximum?"lt":"lte"](new window.Decimal(t.maximum))),r||d.push({path:i,property:"maximum",message:this.translate(t.exclusiveMaximum?"error_maximum_excl":"error_maximum_incl",[t.maximum])})),t.hasOwnProperty("minimum")&&(r=t.exclusiveMinimum?e>t.minimum:e>=t.minimum,window.math?r=window.math[t.exclusiveMinimum?"larger":"largerEq"](window.math.bignumber(e),window.math.bignumber(t.minimum)):window.Decimal&&(r=new window.Decimal(e)[t.exclusiveMinimum?"gt":"gte"](new window.Decimal(t.minimum))),r||d.push({path:i,property:"minimum",message:this.translate(t.exclusiveMinimum?"error_minimum_excl":"error_minimum_incl",[t.minimum])}))}else if("string"==typeof e)t.maxLength&&(e+"").length>t.maxLength&&d.push({path:i,property:"maxLength",message:this.translate("error_maxLength",[t.maxLength])}),t.minLength&&(e+"").length<t.minLength&&d.push({path:i,property:"minLength",message:this.translate(1===t.minLength?"error_notempty":"error_minLength",[t.minLength])}),t.pattern&&(new RegExp(t.pattern).test(e)||d.push({path:i,property:"pattern",message:this.translate("error_pattern",[t.pattern])}));else if("object"==typeof e&&null!==e&&Array.isArray(e)){if(t.items)if(Array.isArray(t.items))for(a=0;a<e.length;a++)if(t.items[a])d=d.concat(this._validateSchema(t.items[a],e[a],i+"."+a));else{if(!0===t.additionalItems)break;if(!t.additionalItems){if(!1===t.additionalItems){d.push({path:i,property:"additionalItems",message:this.translate("error_additionalItems")});break}break}d=d.concat(this._validateSchema(t.additionalItems,e[a],i+"."+a))}else for(a=0;a<e.length;a++)d=d.concat(this._validateSchema(t.items,e[a],i+"."+a));if(t.maxItems&&e.length>t.maxItems&&d.push({path:i,property:"maxItems",message:this.translate("error_maxItems",[t.maxItems])}),t.minItems&&e.length<t.minItems&&d.push({path:i,property:"minItems",message:this.translate("error_minItems",[t.minItems])}),t.uniqueItems){var m={};for(a=0;a<e.length;a++){if(m[r=JSON.stringify(e[a])]){d.push({path:i,property:"uniqueItems",message:this.translate("error_uniqueItems")});break}m[r]=!0}}}else if("object"==typeof e&&null!==e){if(t.maxProperties){r=0;for(a in e)e.hasOwnProperty(a)&&r++;r>t.maxProperties&&d.push({path:i,property:"maxProperties",message:this.translate("error_maxProperties",[t.maxProperties])})}if(t.minProperties){r=0;for(a in e)e.hasOwnProperty(a)&&r++;r<t.minProperties&&d.push({path:i,property:"minProperties",message:this.translate("error_minProperties",[t.minProperties])})}if(t.required&&Array.isArray(t.required))for(a=0;a<t.required.length;a++)void 0===e[t.required[a]]&&d.push({path:i,property:"required",message:this.translate("error_required",[t.required[a]])});var g={};if(t.properties)for(a in t.properties)t.properties.hasOwnProperty(a)&&(g[a]=!0,d=d.concat(this._validateSchema(t.properties[a],e[a],i+"."+a)));if(t.patternProperties)for(a in t.patternProperties)if(t.patternProperties.hasOwnProperty(a)){var v=new RegExp(a);for(l in e)e.hasOwnProperty(l)&&v.test(l)&&(g[l]=!0,d=d.concat(this._validateSchema(t.patternProperties[a],e[l],i+"."+l)))}if(void 0!==t.additionalProperties||!this.jsoneditor.options.no_additional_properties||t.oneOf||t.anyOf||(t.additionalProperties=!1),void 0!==t.additionalProperties)for(a in e)if(e.hasOwnProperty(a)&&!g[a]){if(!t.additionalProperties){d.push({path:i,property:"additionalProperties",message:this.translate("error_additional_properties",[a])});break}if(!0===t.additionalProperties)break;d=d.concat(this._validateSchema(t.additionalProperties,e[a],i+"."+a))}if(t.dependencies)for(a in t.dependencies)if(t.dependencies.hasOwnProperty(a)&&void 0!==e[a])if(Array.isArray(t.dependencies[a]))for(l=0;l<t.dependencies[a].length;l++)void 0===e[t.dependencies[a][l]]&&d.push({path:i,property:"dependencies",message:this.translate("error_dependency",[t.dependencies[a][l]])});else d=d.concat(this._validateSchema(t.dependencies[a],e,i))}return n(o.defaults.custom_validators,function(s,n){d=d.concat(n.call(h,t,e,i))}),this.options.custom_validators&&n(this.options.custom_validators,function(s,n){d=d.concat(n.call(h,t,e,i))}),d},_checkType:function(t,e){return"string"==typeof t?"string"===t?"string"==typeof e:"number"===t?"number"==typeof e:"integer"===t?"number"==typeof e&&e===Math.floor(e):"boolean"===t?"boolean"==typeof e:"array"===t?Array.isArray(e):"object"===t?null!==e&&!Array.isArray(e)&&"object"==typeof e:"null"!==t||null===e:!this._validateSchema(t,e).length}}),o.AbstractEditor=t.extend({onChildEditorChange:function(t){this.onChange(!0)},notify:function(){this.path&&this.jsoneditor.notifyWatchers(this.path)},change:function(){this.parent?this.parent.onChildEditorChange(this):this.jsoneditor&&this.jsoneditor.onChange()},onChange:function(t){this.notify(),this.watch_listener&&this.watch_listener(),t&&this.change()},register:function(){this.jsoneditor.registerEditor(this),this.onChange()},unregister:function(){this.jsoneditor&&this.jsoneditor.unregisterEditor(this)},getNumColumns:function(){return 12},init:function(t){this.jsoneditor=t.jsoneditor,this.theme=this.jsoneditor.theme,this.template_engine=this.jsoneditor.template,this.iconlib=this.jsoneditor.iconlib,this.translate=this.jsoneditor.translate||o.defaults.translate,this.original_schema=t.schema,this.schema=this.jsoneditor.expandSchema(this.original_schema),this.options=s({},this.options||{},t.schema.options||{},t),t.path||this.schema.id||(this.schema.id="root"),this.path=t.path||"root",this.formname=t.formname||this.path.replace(/\.([^.]+)/g,"[$1]"),this.jsoneditor.options.form_name_root&&(this.formname=this.formname.replace(/^root\[/,this.jsoneditor.options.form_name_root+"[")),this.key=this.path.split(".").pop(),this.parent=t.parent,this.link_watchers=[],t.container&&this.setContainer(t.container)},setContainer:function(t){this.container=t,this.schema.id&&this.container.setAttribute("data-schemaid",this.schema.id),this.schema.type&&"string"==typeof this.schema.type&&this.container.setAttribute("data-schematype",this.schema.type),this.container.setAttribute("data-schemapath",this.path)},preBuild:function(){},build:function(){},postBuild:function(){this.setupWatchListeners(),this.addLinks(),this.setValue(this.getDefault(),!0),this.updateHeaderText(),this.register(),this.onWatchedFieldChange()},setupWatchListeners:function(){var t,e,i,s,n,r=this;if(this.watched={},this.schema.vars&&(this.schema.watch=this.schema.vars),this.watched_values={},this.watch_listener=function(){r.refreshWatchedFieldValues()&&r.onWatchedFieldChange()},this.register(),this.schema.hasOwnProperty("watch"))for(var o in this.schema.watch)if(this.schema.watch.hasOwnProperty(o)){if(t=this.schema.watch[o],Array.isArray(t)){if(t.length<2)continue;e=[t[0]].concat(t[1].split("."))}else e=t.split("."),r.theme.closest(r.container,'[data-schemaid="'+e[0]+'"]')||e.unshift("#");if("#"===(i=e.shift())&&(i=r.jsoneditor.schema.id||"root"),!(s=r.theme.closest(r.container,'[data-schemaid="'+i+'"]')))throw"Could not find ancestor node with id "+i;n=s.getAttribute("data-schemapath")+"."+e.join("."),r.jsoneditor.watch(n,r.watch_listener),r.watched[o]=n}this.schema.headerTemplate&&(this.header_template=this.jsoneditor.compileTemplate(this.schema.headerTemplate,this.template_engine))},addLinks:function(){if(!this.no_link_holder&&(this.link_holder=this.theme.getLinksHolder(),this.container.appendChild(this.link_holder),this.schema.links))for(var t=0;t<this.schema.links.length;t++)this.addLink(this.getLink(this.schema.links[t]))},getButton:function(t,e,i){var s="json-editor-btn-"+e;!(e=this.iconlib?this.iconlib.getIcon(e):null)&&i&&(t=i,i=null);var n=this.theme.getButton(t,e,i);return n.className+=" "+s+" ",n},setButtonText:function(t,e,i,s){return!(i=this.iconlib?this.iconlib.getIcon(i):null)&&s&&(e=s,s=null),this.theme.setButtonText(t,e,i,s)},addLink:function(t){this.link_holder&&this.link_holder.appendChild(t)},getLink:function(t){var e,i,s=(t.mediaType||"application/javascript").split("/")[0],n=this.jsoneditor.compileTemplate(t.href,this.template_engine),r=null;if(t.download&&(r=t.download),r&&!0!==r&&(r=this.jsoneditor.compileTemplate(r,this.template_engine)),"image"===s){e=this.theme.getBlockLinkHolder(),(i=document.createElement("a")).setAttribute("target","_blank");var o=document.createElement("img");this.theme.createImageLink(e,i,o),this.link_watchers.push(function(e){var s=n(e);i.setAttribute("href",s),i.setAttribute("title",t.rel||s),o.setAttribute("src",s)})}else if(["audio","video"].indexOf(s)>=0){e=this.theme.getBlockLinkHolder(),(i=this.theme.getBlockLink()).setAttribute("target","_blank");var a=document.createElement(s);a.setAttribute("controls","controls"),this.theme.createMediaLink(e,i,a),this.link_watchers.push(function(e){var s=n(e);i.setAttribute("href",s),i.textContent=t.rel||s,a.setAttribute("src",s)})}else i=e=this.theme.getBlockLink(),e.setAttribute("target","_blank"),e.textContent=t.rel,this.link_watchers.push(function(i){var s=n(i);e.setAttribute("href",s),e.textContent=t.rel||s});return r&&i&&(!0===r?i.setAttribute("download",""):this.link_watchers.push(function(t){i.setAttribute("download",r(t))})),t.class&&(i.className=i.className+" "+t.class),e},refreshWatchedFieldValues:function(){if(this.watched_values){var t,e,i={},s=!1;if(this.watched)for(var n in this.watched)this.watched.hasOwnProperty(n)&&(e=this.jsoneditor.getEditor(this.watched[n]),t=e?e.getValue():null,this.watched_values[n]!==t&&(s=!0),i[n]=t);return i.self=this.getValue(),this.watched_values.self!==i.self&&(s=!0),this.watched_values=i,s}},getWatchedFieldValues:function(){return this.watched_values},updateHeaderText:function(){if(this.header)if(this.header.children.length){for(var t=0;t<this.header.childNodes.length;t++)if(3===this.header.childNodes[t].nodeType){this.header.childNodes[t].nodeValue=this.getHeaderText();break}}else this.header.textContent=this.getHeaderText()},getHeaderText:function(t){return this.header_text?this.header_text:t?this.schema.title:this.getTitle()},onWatchedFieldChange:function(){var t;if(this.header_template){t=s(this.getWatchedFieldValues(),{key:this.key,i:this.key,i0:1*this.key,i1:1*this.key+1,title:this.getTitle()});var e=this.header_template(t);e!==this.header_text&&(this.header_text=e,this.updateHeaderText(),this.notify())}if(this.link_watchers.length){t=this.getWatchedFieldValues();for(var i=0;i<this.link_watchers.length;i++)this.link_watchers[i](t)}},setValue:function(t){this.value=t},getValue:function(){return this.value},refreshValue:function(){},getChildEditors:function(){return!1},destroy:function(){var t=this;this.unregister(this),n(this.watched,function(e,i){t.jsoneditor.unwatch(i,t.watch_listener)}),this.watched=null,this.watched_values=null,this.watch_listener=null,this.header_text=null,this.header_template=null,this.value=null,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.jsoneditor=null,this.schema=null,this.path=null,this.key=null,this.parent=null},getDefault:function(){if(this.schema.default)return this.schema.default;if(this.schema.enum)return this.schema.enum[0];var t=this.schema.type||this.schema.oneOf;if(t&&Array.isArray(t)&&(t=t[0]),t&&"object"==typeof t&&(t=t.type),t&&Array.isArray(t)&&(t=t[0]),"string"==typeof t){if("number"===t)return 0;if("boolean"===t)return!1;if("integer"===t)return 0;if("string"===t)return"";if("object"===t)return{};if("array"===t)return[]}return null},getTitle:function(){return this.schema.title||this.key},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},isEnabled:function(){return!this.disabled},isRequired:function(){return"boolean"==typeof this.schema.required?this.schema.required:this.parent&&this.parent.schema&&Array.isArray(this.parent.schema.required)?this.parent.schema.required.indexOf(this.key)>-1:!!this.jsoneditor.options.required_by_default},getDisplayText:function(t){var e=[],i={};n(t,function(t,e){e.title&&(i[e.title]=i[e.title]||0,i[e.title]++),e.description&&(i[e.description]=i[e.description]||0,i[e.description]++),e.format&&(i[e.format]=i[e.format]||0,i[e.format]++),e.type&&(i[e.type]=i[e.type]||0,i[e.type]++)}),n(t,function(t,s){var n;n="string"==typeof s?s:s.title&&i[s.title]<=1?s.title:s.format&&i[s.format]<=1?s.format:s.type&&i[s.type]<=1?s.type:s.description&&i[s.description]<=1?s.descripton:s.title?s.title:s.format?s.format:s.type?s.type:s.description?s.description:JSON.stringify(s).length<50?JSON.stringify(s):"type",e.push(n)});var s={};return n(e,function(t,n){s[n]=s[n]||0,s[n]++,i[n]>1&&(e[t]=n+" "+s[n])}),e},getOption:function(t){try{throw"getOption is deprecated"}catch(t){window.console.error(t)}return this.options[t]},showValidationErrors:function(t){}}),o.defaults.editors.null=o.AbstractEditor.extend({getValue:function(){return null},setValue:function(){this.onChange()},getNumColumns:function(){return 2}}),o.defaults.editors.string=o.AbstractEditor.extend({register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},setValue:function(t,e,i){if((!this.template||i)&&(null===t||void 0===t?t="":"object"==typeof t?t=JSON.stringify(t):"string"!=typeof t&&(t=""+t),t!==this.serialized)){var s=this.sanitize(t);if(this.input.value!==s){this.input.value=s,this.sceditor_instance?this.sceditor_instance.val(s):this.epiceditor?this.epiceditor.importFile(null,s):this.ace_editor&&this.ace_editor.setValue(s);var n=i||this.getValue()!==t;this.refreshValue(),e?this.is_dirty=!1:"change"===this.jsoneditor.options.show_errors&&(this.is_dirty=!0),this.adjust_height&&this.adjust_height(this.input),this.onChange(n)}}},getNumColumns:function(){var t,e=Math.ceil(Math.max(this.getTitle().length,this.schema.maxLength||0,this.schema.minLength||0)/5);return t="textarea"===this.input_type?6:["text","email"].indexOf(this.input_type)>=0?4:2,Math.min(12,Math.max(e,t))},build:function(){var t=this;if(this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.infoText&&(this.infoButton=this.theme.getInfoButton(this.options.infoText)),this.format=this.schema.format,!this.format&&this.schema.media&&this.schema.media.type&&(this.format=this.schema.media.type.replace(/(^(application|text)\/(x-)?(script\.)?)|(-source$)/g,"")),!this.format&&this.options.default_format&&(this.format=this.options.default_format),this.options.format&&(this.format=this.options.format),this.format)if("textarea"===this.format)this.input_type="textarea",this.input=this.theme.getTextareaInput();else if("range"===this.format){this.input_type="range";var e=this.schema.minimum||0,i=this.schema.maximum||Math.max(100,e+1),s=1;this.schema.multipleOf&&(e%this.schema.multipleOf&&(e=Math.ceil(e/this.schema.multipleOf)*this.schema.multipleOf),i%this.schema.multipleOf&&(i=Math.floor(i/this.schema.multipleOf)*this.schema.multipleOf),s=this.schema.multipleOf),this.input=this.theme.getRangeInput(e,i,s)}else["actionscript","batchfile","bbcode","c","c++","cpp","coffee","csharp","css","dart","django","ejs","erlang","golang","groovy","handlebars","haskell","haxe","html","ini","jade","java","javascript","json","less","lisp","lua","makefile","markdown","matlab","mysql","objectivec","pascal","perl","pgsql","php","python","r","ruby","sass","scala","scss","smarty","sql","stylus","svg","twig","vbscript","xml","yaml"].indexOf(this.format)>=0?(this.input_type=this.format,this.source_code=!0,this.input=this.theme.getTextareaInput()):(this.input_type=this.format,this.input=this.theme.getFormInputField(this.input_type));else this.input_type="text",this.input=this.theme.getFormInputField(this.input_type);void 0!==this.schema.maxLength&&this.input.setAttribute("maxlength",this.schema.maxLength),void 0!==this.schema.pattern?this.input.setAttribute("pattern",this.schema.pattern):void 0!==this.schema.minLength&&this.input.setAttribute("pattern",".{"+this.schema.minLength+",}"),this.options.compact?this.container.className+=" compact":this.options.input_width&&(this.input.style.width=this.options.input_width),(this.schema.readOnly||this.schema.readonly||this.schema.template)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener("change",function(e){if(e.preventDefault(),e.stopPropagation(),t.schema.template)this.value=t.value;else{var i=this.value,s=t.sanitize(i);i!==s&&(this.value=s),t.is_dirty=!0,t.refreshValue(),t.onChange(!0)}}),this.options.input_height&&(this.input.style.height=this.options.input_height),this.options.expand_height&&(this.adjust_height=function(t){if(t){var e,i=t.offsetHeight;if(t.offsetHeight<t.scrollHeight)for(e=0;t.offsetHeight<t.scrollHeight+3&&!(e>100);)e++,i++,t.style.height=i+"px";else{for(e=0;t.offsetHeight>=t.scrollHeight+3&&!(e>100);)e++,i--,t.style.height=i+"px";t.style.height=i+1+"px"}}},this.input.addEventListener("keyup",function(e){t.adjust_height(this)}),this.input.addEventListener("change",function(e){t.adjust_height(this)}),this.adjust_height()),this.format&&this.input.setAttribute("data-schemaformat",this.format),this.control=this.theme.getFormControl(this.label,this.input,this.description,this.infoButton),this.container.appendChild(this.control),window.requestAnimationFrame(function(){t.input.parentNode&&t.afterInputReady(),t.adjust_height&&t.adjust_height(t.input)}),this.schema.template?(this.template=this.jsoneditor.compileTemplate(this.schema.template,this.template_engine),this.refreshValue()):this.refreshValue()},enable:function(){this.always_disabled||(this.input.disabled=!1),this._super()},disable:function(){this.input.disabled=!0,this._super()},afterInputReady:function(){var t,e=this;if(this.source_code)if(this.options.wysiwyg&&["html","bbcode"].indexOf(this.input_type)>=0&&window.jQuery&&window.jQuery.fn&&window.jQuery.fn.sceditor)t=s({},{plugins:"html"===e.input_type?"xhtml":"bbcode",emoticonsEnabled:!1,width:"100%",height:300},o.plugins.sceditor,e.options.sceditor_options||{}),window.jQuery(e.input).sceditor(t),e.sceditor_instance=window.jQuery(e.input).sceditor("instance"),e.sceditor_instance.blur(function(){var t=window.jQuery("<div>"+e.sceditor_instance.val()+"</div>");window.jQuery("#sceditor-start-marker,#sceditor-end-marker,.sceditor-nlf",t).remove(),e.input.value=t.html(),e.value=e.input.value,e.is_dirty=!0,e.onChange(!0)});else if("markdown"===this.input_type&&window.EpicEditor)this.epiceditor_container=document.createElement("div"),this.input.parentNode.insertBefore(this.epiceditor_container,this.input),this.input.style.display="none",t=s({},o.plugins.epiceditor,{container:this.epiceditor_container,clientSideStorage:!1}),this.epiceditor=new window.EpicEditor(t).load(),this.epiceditor.importFile(null,this.getValue()),this.epiceditor.on("update",function(){var t=e.epiceditor.exportFile();e.input.value=t,e.value=t,e.is_dirty=!0,e.onChange(!0)});else if(window.ace){var i=this.input_type;"cpp"!==i&&"c++"!==i&&"c"!==i||(i="c_cpp"),this.ace_container=document.createElement("div"),this.ace_container.style.width="100%",this.ace_container.style.position="relative",this.ace_container.style.height="400px",this.input.parentNode.insertBefore(this.ace_container,this.input),this.input.style.display="none",this.ace_editor=window.ace.edit(this.ace_container),this.ace_editor.setValue(this.getValue()),o.plugins.ace.theme&&this.ace_editor.setTheme("ace/theme/"+o.plugins.ace.theme),(i=window.ace.require("ace/mode/"+i))&&this.ace_editor.getSession().setMode(new i.Mode),this.ace_editor.on("change",function(){var t=e.ace_editor.getValue();e.input.value=t,e.refreshValue(),e.is_dirty=!0,e.onChange(!0)})}e.theme.afterInputReady(e.input)},refreshValue:function(){this.value=this.input.value,"string"!=typeof this.value&&(this.value=""),this.serialized=this.value},destroy:function(){this.sceditor_instance?this.sceditor_instance.destroy():this.epiceditor?this.epiceditor.unload():this.ace_editor&&this.ace_editor.destroy(),this.template=null,this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this._super()},sanitize:function(t){return t},onWatchedFieldChange:function(){var t;this.template&&(t=this.getWatchedFieldValues(),this.setValue(this.template(t),!1,!0)),this._super()},showValidationErrors:function(t){var e=this;if("always"===this.jsoneditor.options.show_errors);else if(!this.is_dirty&&this.previous_error_setting===this.jsoneditor.options.show_errors)return;this.previous_error_setting=this.jsoneditor.options.show_errors;var i=[];n(t,function(t,s){s.path===e.path&&i.push(s.message)}),i.length?this.theme.addInputError(this.input,i.join(". ")+"."):this.theme.removeInputError(this.input)}}),o.defaults.editors.number=o.defaults.editors.string.extend({sanitize:function(t){return(t+"").replace(/[^0-9\.\-eE]/g,"")},getNumColumns:function(){return 2},getValue:function(){return 1*this.value}}),o.defaults.editors.integer=o.defaults.editors.number.extend({sanitize:function(t){return(t+="").replace(/[^0-9\-]/g,"")},getNumColumns:function(){return 2}}),o.defaults.editors.object=o.AbstractEditor.extend({getDefault:function(){return s({},this.schema.default||{})},getChildEditors:function(){return this.editors},register:function(){if(this._super(),this.editors)for(var t in this.editors)this.editors.hasOwnProperty(t)&&this.editors[t].register()},unregister:function(){if(this._super(),this.editors)for(var t in this.editors)this.editors.hasOwnProperty(t)&&this.editors[t].unregister()},getNumColumns:function(){return Math.max(Math.min(12,this.maxwidth),3)},enable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!1),this.addproperty_button&&(this.addproperty_button.disabled=!1),this._super(),this.editors)for(var t in this.editors)this.editors.hasOwnProperty(t)&&this.editors[t].enable()},disable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!0),this.addproperty_button&&(this.addproperty_button.disabled=!0),this.hideEditJSON(),this._super(),this.editors)for(var t in this.editors)this.editors.hasOwnProperty(t)&&this.editors[t].disable()},layoutEditors:function(){var t,e,i=this;if(this.row_container){var s;if(this.property_order=Object.keys(this.editors),this.property_order=this.property_order.sort(function(t,e){var s=i.editors[t].schema.propertyOrder,n=i.editors[e].schema.propertyOrder;return"number"!=typeof s&&(s=1e3),"number"!=typeof n&&(n=1e3),s-n}),"grid"===this.format){var r=[];for(n(this.property_order,function(t,e){var s=i.editors[e];if(!s.property_removed){for(var n=!1,o=s.options.hidden?0:s.options.grid_columns||s.getNumColumns(),a=s.options.hidden?0:s.container.offsetHeight,l=0;l<r.length;l++)r[l].width+o<=12&&(!a||.5*r[l].minh<a&&2*r[l].maxh>a)&&(n=l);!1===n&&(r.push({width:0,minh:999999,maxh:0,editors:[]}),n=r.length-1),r[n].editors.push({key:e,width:o,height:a}),r[n].width+=o,r[n].minh=Math.min(r[n].minh,a),r[n].maxh=Math.max(r[n].maxh,a)}}),t=0;t<r.length;t++)if(r[t].width<12){var o=!1,a=0;for(e=0;e<r[t].editors.length;e++)!1===o?o=e:r[t].editors[e].width>r[t].editors[o].width&&(o=e),r[t].editors[e].width*=12/r[t].width,r[t].editors[e].width=Math.floor(r[t].editors[e].width),a+=r[t].editors[e].width;a<12&&(r[t].editors[o].width+=12-a),r[t].width=12}if(this.layout===JSON.stringify(r))return!1;for(this.layout=JSON.stringify(r),s=document.createElement("div"),t=0;t<r.length;t++){var l=this.theme.getGridRow();for(s.appendChild(l),e=0;e<r[t].editors.length;e++){var h=r[t].editors[e].key,d=this.editors[h];d.options.hidden?d.container.style.display="none":this.theme.setGridColumnSize(d.container,r[t].editors[e].width),l.appendChild(d.container)}}}else s=document.createElement("div"),n(this.property_order,function(t,e){var n=i.editors[e];if(!n.property_removed){var r=i.theme.getGridRow();s.appendChild(r),n.options.hidden?n.container.style.display="none":i.theme.setGridColumnSize(n.container,12),r.appendChild(n.container)}});this.row_container.innerHTML="",this.row_container.appendChild(s)}},getPropertySchema:function(t){var e=this.schema.properties[t]||{};e=s({},e);var i=!!this.schema.properties[t];if(this.schema.patternProperties)for(var n in this.schema.patternProperties)if(this.schema.patternProperties.hasOwnProperty(n)){new RegExp(n).test(t)&&(e.allOf=e.allOf||[],e.allOf.push(this.schema.patternProperties[n]),i=!0)}return!i&&this.schema.additionalProperties&&"object"==typeof this.schema.additionalProperties&&(e=s({},this.schema.additionalProperties)),e},preBuild:function(){this._super(),this.editors={},this.cached_editors={};var t=this;if(this.format=this.options.layout||this.options.object_layout||this.schema.format||this.jsoneditor.options.object_layout||"normal",this.schema.properties=this.schema.properties||{},this.minwidth=0,this.maxwidth=0,this.options.table_row)n(this.schema.properties,function(e,i){var s=t.jsoneditor.getEditorClass(i);t.editors[e]=t.jsoneditor.createEditor(s,{jsoneditor:t.jsoneditor,schema:i,path:t.path+"."+e,parent:t,compact:!0,required:!0}),t.editors[e].preBuild();var n=t.editors[e].options.hidden?0:t.editors[e].options.grid_columns||t.editors[e].getNumColumns();t.minwidth+=n,t.maxwidth+=n}),this.no_link_holder=!0;else{if(this.options.table)throw"Not supported yet";this.schema.defaultProperties||(this.jsoneditor.options.display_required_only||this.options.display_required_only?(this.schema.defaultProperties=[],n(this.schema.properties,function(e,i){t.isRequired({key:e,schema:i})&&t.schema.defaultProperties.push(e)})):t.schema.defaultProperties=Object.keys(t.schema.properties)),t.maxwidth+=1,n(this.schema.defaultProperties,function(e,i){t.addObjectProperty(i,!0),t.editors[i]&&(t.minwidth=Math.max(t.minwidth,t.editors[i].options.grid_columns||t.editors[i].getNumColumns()),t.maxwidth+=t.editors[i].options.grid_columns||t.editors[i].getNumColumns())})}this.property_order=Object.keys(this.editors),this.property_order=this.property_order.sort(function(e,i){var s=t.editors[e].schema.propertyOrder,n=t.editors[i].schema.propertyOrder;return"number"!=typeof s&&(s=1e3),"number"!=typeof n&&(n=1e3),s-n})},build:function(){var t=this;if(this.options.table_row)this.editor_holder=this.container,n(this.editors,function(e,i){var s=t.theme.getTableCell();t.editor_holder.appendChild(s),i.setContainer(s),i.build(),i.postBuild(),t.editors[e].options.hidden&&(s.style.display="none"),t.editors[e].options.input_width&&(s.style.width=t.editors[e].options.input_width)});else{if(this.options.table)throw"Not supported yet";this.header=document.createElement("span"),this.header.textContent=this.getTitle(),this.title=this.theme.getHeader(this.header),this.container.appendChild(this.title),this.container.style.position="relative",this.editjson_holder=this.theme.getModal(),this.editjson_textarea=this.theme.getTextareaInput(),this.editjson_textarea.style.height="170px",this.editjson_textarea.style.width="300px",this.editjson_textarea.style.display="block",this.editjson_save=this.getButton("Save","save","Save"),this.editjson_save.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.saveJSON()}),this.editjson_cancel=this.getButton("Cancel","cancel","Cancel"),this.editjson_cancel.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.hideEditJSON()}),this.editjson_holder.appendChild(this.editjson_textarea),this.editjson_holder.appendChild(this.editjson_save),this.editjson_holder.appendChild(this.editjson_cancel),this.addproperty_holder=this.theme.getModal(),this.addproperty_list=document.createElement("div"),this.addproperty_list.style.width="295px",this.addproperty_list.style.maxHeight="160px",this.addproperty_list.style.padding="5px 0",this.addproperty_list.style.overflowY="auto",this.addproperty_list.style.overflowX="hidden",this.addproperty_list.style.paddingLeft="5px",this.addproperty_list.setAttribute("class","property-selector"),this.addproperty_add=this.getButton("add","add","add"),this.addproperty_input=this.theme.getFormInputField("text"),this.addproperty_input.setAttribute("placeholder","Property name..."),this.addproperty_input.style.width="220px",this.addproperty_input.style.marginBottom="0",this.addproperty_input.style.display="inline-block",this.addproperty_add.addEventListener("click",function(e){if(e.preventDefault(),e.stopPropagation(),t.addproperty_input.value){if(t.editors[t.addproperty_input.value])return void window.alert("there is already a property with that name");t.addObjectProperty(t.addproperty_input.value),t.editors[t.addproperty_input.value]&&t.editors[t.addproperty_input.value].disable(),t.onChange(!0)}}),this.addproperty_holder.appendChild(this.addproperty_list),this.addproperty_holder.appendChild(this.addproperty_input),this.addproperty_holder.appendChild(this.addproperty_add);var e=document.createElement("div");e.style.clear="both",this.addproperty_holder.appendChild(e),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement("div"),this.container.appendChild(this.error_holder),this.editor_holder=this.theme.getIndentedPanel(),this.container.appendChild(this.editor_holder),this.row_container=this.theme.getGridContainer(),this.editor_holder.appendChild(this.row_container),n(this.editors,function(e,i){var s=t.theme.getGridColumn();t.row_container.appendChild(s),i.setContainer(s),i.build(),i.postBuild()}),this.title_controls=this.theme.getHeaderButtonHolder(),this.editjson_controls=this.theme.getHeaderButtonHolder(),this.addproperty_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.title.appendChild(this.editjson_controls),this.title.appendChild(this.addproperty_controls),this.collapsed=!1,this.toggle_button=this.getButton("","collapse",this.translate("button_collapse")),this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.collapsed?(t.editor_holder.style.display="",t.collapsed=!1,t.setButtonText(t.toggle_button,"","collapse",t.translate("button_collapse"))):(t.editor_holder.style.display="none",t.collapsed=!0,t.setButtonText(t.toggle_button,"","expand",t.translate("button_expand")))}),this.options.collapsed&&r(this.toggle_button,"click"),this.schema.options&&void 0!==this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none"),this.editjson_button=this.getButton("JSON","edit","Edit JSON"),this.editjson_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.toggleEditJSON()}),this.editjson_controls.appendChild(this.editjson_button),this.editjson_controls.appendChild(this.editjson_holder),this.schema.options&&void 0!==this.schema.options.disable_edit_json?this.schema.options.disable_edit_json&&(this.editjson_button.style.display="none"):this.jsoneditor.options.disable_edit_json&&(this.editjson_button.style.display="none"),this.addproperty_button=this.getButton("Properties","edit","Object Properties"),this.addproperty_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.toggleAddProperty()}),this.addproperty_controls.appendChild(this.addproperty_button),this.addproperty_controls.appendChild(this.addproperty_holder),this.refreshAddProperties()}this.options.table_row?(this.editor_holder=this.container,n(this.property_order,function(e,i){t.editor_holder.appendChild(t.editors[i].container)})):(this.layoutEditors(),this.layoutEditors())},showEditJSON:function(){this.editjson_holder&&(this.hideAddProperty(),this.editjson_holder.style.left=this.editjson_button.offsetLeft+"px",this.editjson_holder.style.top=this.editjson_button.offsetTop+this.editjson_button.offsetHeight+"px",this.editjson_textarea.value=JSON.stringify(this.getValue(),null,2),this.disable(),this.editjson_holder.style.display="",this.editjson_button.disabled=!1,this.editing_json=!0)},hideEditJSON:function(){this.editjson_holder&&this.editing_json&&(this.editjson_holder.style.display="none",this.enable(),this.editing_json=!1)},saveJSON:function(){if(this.editjson_holder)try{var t=JSON.parse(this.editjson_textarea.value);this.setValue(t),this.hideEditJSON()}catch(t){throw window.alert("invalid JSON"),t}},toggleEditJSON:function(){this.editing_json?this.hideEditJSON():this.showEditJSON()},insertPropertyControlUsingPropertyOrder:function(t,e,i){var s;this.schema.properties[t]&&(s=this.schema.properties[t].propertyOrder),"number"!=typeof s&&(s=1e3),e.propertyOrder=s;for(var n=0;n<i.childNodes.length;n++){var r=i.childNodes[n];if(e.propertyOrder<r.propertyOrder){this.addproperty_list.insertBefore(e,r),e=null;break}}e&&this.addproperty_list.appendChild(e)},addPropertyCheckbox:function(t){var e,i,s,n,r=this;return(e=r.theme.getCheckbox()).style.width="auto",s=this.schema.properties[t]&&this.schema.properties[t].title?this.schema.properties[t].title:t,i=r.theme.getCheckboxLabel(s),(n=r.theme.getFormControl(i,e)).style.paddingBottom=n.style.marginBottom=n.style.paddingTop=n.style.marginTop=0,n.style.height="auto",this.insertPropertyControlUsingPropertyOrder(t,n,this.addproperty_list),e.checked=t in this.editors,e.addEventListener("change",function(){e.checked?r.addObjectProperty(t):r.removeObjectProperty(t),r.onChange(!0)}),r.addproperty_checkboxes[t]=e,e},showAddProperty:function(){this.addproperty_holder&&(this.hideEditJSON(),this.addproperty_holder.style.left=this.addproperty_button.offsetLeft+"px",this.addproperty_holder.style.top=this.addproperty_button.offsetTop+this.addproperty_button.offsetHeight+"px",this.disable(),this.adding_property=!0,this.addproperty_button.disabled=!1,this.addproperty_holder.style.display="",this.refreshAddProperties())},hideAddProperty:function(){this.addproperty_holder&&this.adding_property&&(this.addproperty_holder.style.display="none",this.enable(),this.adding_property=!1)},toggleAddProperty:function(){this.adding_property?this.hideAddProperty():this.showAddProperty()},removeObjectProperty:function(t){this.editors[t]&&(this.editors[t].unregister(),delete this.editors[t],this.refreshValue(),this.layoutEditors())},addObjectProperty:function(t,e){if(!this.editors[t]){if(this.cached_editors[t]){if(this.editors[t]=this.cached_editors[t],e)return;this.editors[t].register()}else{if(!(this.canHaveAdditionalProperties()||this.schema.properties&&this.schema.properties[t]))return;var i=this.getPropertySchema(t),s=this.jsoneditor.getEditorClass(i);if(this.editors[t]=this.jsoneditor.createEditor(s,{jsoneditor:this.jsoneditor,schema:i,path:this.path+"."+t,parent:this}),this.editors[t].preBuild(),!e){var n=this.theme.getChildEditorHolder();this.editor_holder.appendChild(n),this.editors[t].setContainer(n),this.editors[t].build(),this.editors[t].postBuild()}this.cached_editors[t]=this.editors[t]}e||(this.refreshValue(),this.layoutEditors())}},onChildEditorChange:function(t){this.refreshValue(),this._super(t)},canHaveAdditionalProperties:function(){return"boolean"==typeof this.schema.additionalProperties?this.schema.additionalProperties:!this.jsoneditor.options.no_additional_properties},destroy:function(){n(this.cached_editors,function(t,e){e.destroy()}),this.editor_holder&&(this.editor_holder.innerHTML=""),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.error_holder&&this.error_holder.parentNode&&this.error_holder.parentNode.removeChild(this.error_holder),this.editors=null,this.cached_editors=null,this.editor_holder&&this.editor_holder.parentNode&&this.editor_holder.parentNode.removeChild(this.editor_holder),this.editor_holder=null,this._super()},getValue:function(){var t=this._super();if(this.jsoneditor.options.remove_empty_properties||this.options.remove_empty_properties)for(var e in t)t.hasOwnProperty(e)&&(t[e]||delete t[e]);return t},refreshValue:function(){this.value={};for(var t in this.editors)this.editors.hasOwnProperty(t)&&(this.value[t]=this.editors[t].getValue());this.adding_property&&this.refreshAddProperties()},refreshAddProperties:function(){if(this.options.disable_properties||!1!==this.options.disable_properties&&this.jsoneditor.options.disable_properties)this.addproperty_controls.style.display="none";else{var t,e,i=0,s=!1;for(t in this.editors)this.editors.hasOwnProperty(t)&&i++;e=this.canHaveAdditionalProperties()&&!(void 0!==this.schema.maxProperties&&i>=this.schema.maxProperties),this.addproperty_checkboxes&&(this.addproperty_list.innerHTML=""),this.addproperty_checkboxes={};for(t in this.cached_editors)this.cached_editors.hasOwnProperty(t)&&(this.addPropertyCheckbox(t),this.isRequired(this.cached_editors[t])&&t in this.editors&&(this.addproperty_checkboxes[t].disabled=!0),void 0!==this.schema.minProperties&&i<=this.schema.minProperties?(this.addproperty_checkboxes[t].disabled=this.addproperty_checkboxes[t].checked,this.addproperty_checkboxes[t].checked||(s=!0)):t in this.editors?(s=!0,!0):e||this.schema.properties.hasOwnProperty(t)?(this.addproperty_checkboxes[t].disabled=!1,s=!0):this.addproperty_checkboxes[t].disabled=!0);this.canHaveAdditionalProperties()&&(s=!0);for(t in this.schema.properties)this.schema.properties.hasOwnProperty(t)&&(this.cached_editors[t]||(s=!0,this.addPropertyCheckbox(t)));s?this.canHaveAdditionalProperties()?this.addproperty_add.disabled=!e:(this.addproperty_add.style.display="none",this.addproperty_input.style.display="none"):(this.hideAddProperty(),this.addproperty_controls.style.display="none")}},isRequired:function(t){return"boolean"==typeof t.schema.required?t.schema.required:Array.isArray(this.schema.required)?this.schema.required.indexOf(t.key)>-1:!!this.jsoneditor.options.required_by_default},setValue:function(t,e){var i=this;("object"!=typeof(t=t||{})||Array.isArray(t))&&(t={}),n(this.cached_editors,function(s,n){void 0!==t[s]?(i.addObjectProperty(s),n.setValue(t[s],e)):e||i.isRequired(n)?n.setValue(n.getDefault(),e):i.removeObjectProperty(s)}),n(t,function(t,s){i.cached_editors[t]||(i.addObjectProperty(t),i.editors[t]&&i.editors[t].setValue(s,e))}),this.refreshValue(),this.layoutEditors(),this.onChange()},showValidationErrors:function(t){var e=this,i=[],s=[];n(t,function(t,n){n.path===e.path?i.push(n):s.push(n)}),this.error_holder&&(i.length?(this.error_holder.innerHTML="",this.error_holder.style.display="",n(i,function(t,i){e.error_holder.appendChild(e.theme.getErrorMessage(i.message))})):this.error_holder.style.display="none"),this.options.table_row&&(i.length?this.theme.addTableRowError(this.container):this.theme.removeTableRowError(this.container)),n(this.editors,function(t,e){e.showValidationErrors(s)})}}),o.defaults.editors.array=o.AbstractEditor.extend({getDefault:function(){return this.schema.default||[]},register:function(){if(this._super(),this.rows)for(var t=0;t<this.rows.length;t++)this.rows[t].register()},unregister:function(){if(this._super(),this.rows)for(var t=0;t<this.rows.length;t++)this.rows[t].unregister()},getNumColumns:function(){var t=this.getItemInfo(0);return this.tabs_holder?Math.max(Math.min(12,t.width+2),4):t.width},enable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!1),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!1),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!1),this.rows)for(var t=0;t<this.rows.length;t++)this.rows[t].enable(),this.rows[t].moveup_button&&(this.rows[t].moveup_button.disabled=!1),this.rows[t].movedown_button&&(this.rows[t].movedown_button.disabled=!1),this.rows[t].delete_button&&(this.rows[t].delete_button.disabled=!1);this._super()},disable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!0),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!0),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!0),this.rows)for(var t=0;t<this.rows.length;t++)this.rows[t].disable(),this.rows[t].moveup_button&&(this.rows[t].moveup_button.disabled=!0),this.rows[t].movedown_button&&(this.rows[t].movedown_button.disabled=!0),this.rows[t].delete_button&&(this.rows[t].delete_button.disabled=!0);this._super()},preBuild:function(){this._super(),this.rows=[],this.row_cache=[],this.hide_delete_buttons=this.options.disable_array_delete||this.jsoneditor.options.disable_array_delete,this.hide_delete_all_rows_buttons=this.hide_delete_buttons||this.options.disable_array_delete_all_rows||this.jsoneditor.options.disable_array_delete_all_rows,this.hide_delete_last_row_buttons=this.hide_delete_buttons||this.options.disable_array_delete_last_row||this.jsoneditor.options.disable_array_delete_last_row,this.hide_move_buttons=this.options.disable_array_reorder||this.jsoneditor.options.disable_array_reorder,this.hide_add_button=this.options.disable_array_add||this.jsoneditor.options.disable_array_add},build:function(){this.options.compact?(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.row_holder=document.createElement("div"),this.panel.appendChild(this.row_holder)):(this.header=document.createElement("span"),this.header.textContent=this.getTitle(),this.title=this.theme.getHeader(this.header),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement("div"),this.container.appendChild(this.error_holder),"tabs"===this.schema.format?(this.controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.controls),this.tabs_holder=this.theme.getTabHolder(),this.container.appendChild(this.tabs_holder),this.row_holder=this.theme.getTabContentHolder(this.tabs_holder),this.active_tab=null):(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.row_holder=document.createElement("div"),this.panel.appendChild(this.row_holder),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls))),this.addControls()},onChildEditorChange:function(t){this.refreshValue(),this.refreshTabs(!0),this._super(t)},getItemTitle:function(){if(!this.item_title)if(this.schema.items&&!Array.isArray(this.schema.items)){var t=this.jsoneditor.expandRefs(this.schema.items);this.item_title=t.title||"item"}else this.item_title="item";return this.item_title},getItemSchema:function(t){return Array.isArray(this.schema.items)?t>=this.schema.items.length?!0===this.schema.additionalItems?{}:this.schema.additionalItems?s({},this.schema.additionalItems):void 0:s({},this.schema.items[t]):this.schema.items?s({},this.schema.items):{}},getItemInfo:function(t){var e=this.getItemSchema(t);this.item_info=this.item_info||{};var i=JSON.stringify(e);return void 0!==this.item_info[i]?this.item_info[i]:(e=this.jsoneditor.expandRefs(e),this.item_info[i]={title:e.title||"item",default:e.default,width:12,child_editors:e.properties||e.items},this.item_info[i])},getElementEditor:function(t){var e=this.getItemInfo(t),i=this.getItemSchema(t);(i=this.jsoneditor.expandRefs(i)).title=e.title+" "+(t+1);var s,n=this.jsoneditor.getEditorClass(i);s=this.tabs_holder?this.theme.getTabContent():e.child_editors?this.theme.getChildEditorHolder():this.theme.getIndentedPanel(),this.row_holder.appendChild(s);var r=this.jsoneditor.createEditor(n,{jsoneditor:this.jsoneditor,schema:i,container:s,path:this.path+"."+t,parent:this,required:!0});return r.preBuild(),r.build(),r.postBuild(),r.title_controls||(r.array_controls=this.theme.getButtonHolder(),s.appendChild(r.array_controls)),r},destroy:function(){this.empty(!0),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.row_holder&&this.row_holder.parentNode&&this.row_holder.parentNode.removeChild(this.row_holder),this.controls&&this.controls.parentNode&&this.controls.parentNode.removeChild(this.controls),this.panel&&this.panel.parentNode&&this.panel.parentNode.removeChild(this.panel),this.rows=this.row_cache=this.title=this.description=this.row_holder=this.panel=this.controls=null,this._super()},empty:function(t){if(this.rows){var e=this;n(this.rows,function(i,s){t&&(s.tab&&s.tab.parentNode&&s.tab.parentNode.removeChild(s.tab),e.destroyRow(s,!0),e.row_cache[i]=null),e.rows[i]=null}),e.rows=[],t&&(e.row_cache=[])}},destroyRow:function(t,e){var i=t.container;e?(t.destroy(),i.parentNode&&i.parentNode.removeChild(i),t.tab&&t.tab.parentNode&&t.tab.parentNode.removeChild(t.tab)):(t.tab&&(t.tab.style.display="none"),i.style.display="none",t.unregister())},getMax:function(){return Array.isArray(this.schema.items)&&!1===this.schema.additionalItems?Math.min(this.schema.items.length,this.schema.maxItems||1/0):this.schema.maxItems||1/0},refreshTabs:function(t){var e=this;n(this.rows,function(i,s){s.tab&&(t?s.tab_text.textContent=s.getHeaderText():s.tab===e.active_tab?(e.theme.markTabActive(s.tab),s.container.style.display=""):(e.theme.markTabInactive(s.tab),s.container.style.display="none"))})},setValue:function(t,e){if(t=t||[],Array.isArray(t)||(t=[t]),JSON.stringify(t)!==this.serialized){if(this.schema.minItems)for(;t.length<this.schema.minItems;)t.push(this.getItemInfo(t.length).default);this.getMax()&&t.length>this.getMax()&&(t=t.slice(0,this.getMax()));var i=this;n(t,function(t,s){i.rows[t]?i.rows[t].setValue(s,e):i.row_cache[t]?(i.rows[t]=i.row_cache[t],i.rows[t].setValue(s,e),i.rows[t].container.style.display="",i.rows[t].tab&&(i.rows[t].tab.style.display=""),i.rows[t].register()):i.addRow(s,e)});for(var s=t.length;s<i.rows.length;s++)i.destroyRow(i.rows[s]),i.rows[s]=null;i.rows=i.rows.slice(0,t.length);var r=null;n(i.rows,function(t,e){if(e.tab===i.active_tab)return r=e.tab,!1}),!r&&i.rows.length&&(r=i.rows[0].tab),i.active_tab=r,i.refreshValue(e),i.refreshTabs(!0),i.refreshTabs(),i.onChange()}},refreshValue:function(t){var e=this,i=this.value?this.value.length:0;if(this.value=[],n(this.rows,function(t,i){e.value[t]=i.getValue()}),i!==this.value.length||t){var s=this.schema.minItems&&this.schema.minItems>=this.rows.length;n(this.rows,function(t,i){i.movedown_button&&(t===e.rows.length-1?i.movedown_button.style.display="none":i.movedown_button.style.display=""),i.delete_button&&(i.delete_button.style.display=s?"none":""),e.value[t]=i.getValue()});var r=!1;this.value.length?1===this.value.length?(this.remove_all_rows_button.style.display="none",s||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display="none":(this.delete_last_row_button.style.display="",r=!0)):(s||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display="none":(this.delete_last_row_button.style.display="",r=!0),s||this.hide_delete_all_rows_buttons?this.remove_all_rows_button.style.display="none":(this.remove_all_rows_button.style.display="",r=!0)):(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none"),this.getMax()&&this.getMax()<=this.rows.length||this.hide_add_button?this.add_row_button.style.display="none":(this.add_row_button.style.display="",r=!0),!this.collapsed&&r?this.controls.style.display="inline-block":this.controls.style.display="none"}},addRow:function(t,e){var i=this,s=this.rows.length;i.rows[s]=this.getElementEditor(s),i.row_cache[s]=i.rows[s],i.tabs_holder&&(i.rows[s].tab_text=document.createElement("span"),i.rows[s].tab_text.textContent=i.rows[s].getHeaderText(),i.rows[s].tab=i.theme.getTab(i.rows[s].tab_text),i.rows[s].tab.addEventListener("click",function(t){i.active_tab=i.rows[s].tab,i.refreshTabs(),t.preventDefault(),t.stopPropagation()}),i.theme.addTab(i.tabs_holder,i.rows[s].tab));var r=i.rows[s].title_controls||i.rows[s].array_controls;i.hide_delete_buttons||(i.rows[s].delete_button=this.getButton(i.getItemTitle(),"delete",this.translate("button_delete_row_title",[i.getItemTitle()])),i.rows[s].delete_button.className+=" delete",i.rows[s].delete_button.setAttribute("data-i",s),i.rows[s].delete_button.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var e=1*this.getAttribute("data-i"),s=i.getValue(),r=[],o=null;n(s,function(t,s){return t===e?void(i.rows[t].tab===i.active_tab&&(i.rows[t+1]?o=i.rows[t].tab:t&&(o=i.rows[t-1].tab))):void r.push(s)}),i.setValue(r),o&&(i.active_tab=o,i.refreshTabs()),i.onChange(!0)}),r&&r.appendChild(i.rows[s].delete_button)),s&&!i.hide_move_buttons&&(i.rows[s].moveup_button=this.getButton("","moveup",this.translate("button_move_up_title")),i.rows[s].moveup_button.className+=" moveup",i.rows[s].moveup_button.setAttribute("data-i",s),i.rows[s].moveup_button.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var e=1*this.getAttribute("data-i");if(!(e<=0)){var s=i.getValue(),n=s[e-1];s[e-1]=s[e],s[e]=n,i.setValue(s),i.active_tab=i.rows[e-1].tab,i.refreshTabs(),i.onChange(!0)}}),r&&r.appendChild(i.rows[s].moveup_button)),i.hide_move_buttons||(i.rows[s].movedown_button=this.getButton("","movedown",this.translate("button_move_down_title")),i.rows[s].movedown_button.className+=" movedown",i.rows[s].movedown_button.setAttribute("data-i",s),i.rows[s].movedown_button.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var e=1*this.getAttribute("data-i"),s=i.getValue();if(!(e>=s.length-1)){var n=s[e+1];s[e+1]=s[e],s[e]=n,i.setValue(s),i.active_tab=i.rows[e+1].tab,i.refreshTabs(),i.onChange(!0)}}),r&&r.appendChild(i.rows[s].movedown_button)),t&&i.rows[s].setValue(t,e),i.refreshTabs()},addControls:function(){var t=this;this.collapsed=!1,this.toggle_button=this.getButton("","collapse",this.translate("button_collapse")),this.title_controls.appendChild(this.toggle_button);var e=t.row_holder.style.display,i=t.controls.style.display;this.toggle_button.addEventListener("click",function(s){s.preventDefault(),s.stopPropagation(),t.collapsed?(t.collapsed=!1,t.panel&&(t.panel.style.display=""),t.row_holder.style.display=e,t.tabs_holder&&(t.tabs_holder.style.display=""),t.controls.style.display=i,t.setButtonText(this,"","collapse",t.translate("button_collapse"))):(t.collapsed=!0,t.row_holder.style.display="none",t.tabs_holder&&(t.tabs_holder.style.display="none"),t.controls.style.display="none",t.panel&&(t.panel.style.display="none"),t.setButtonText(this,"","expand",t.translate("button_expand")))}),this.options.collapsed&&r(this.toggle_button,"click"),this.schema.options&&void 0!==this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none"),this.add_row_button=this.getButton(this.getItemTitle(),"add",this.translate("button_add_row_title",[this.getItemTitle()])),this.add_row_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var i=t.rows.length;t.row_cache[i]?(t.rows[i]=t.row_cache[i],t.rows[i].setValue(t.rows[i].getDefault(),!0),t.rows[i].container.style.display="",t.rows[i].tab&&(t.rows[i].tab.style.display=""),t.rows[i].register()):t.addRow(),t.active_tab=t.rows[i].tab,t.refreshTabs(),t.refreshValue(),t.onChange(!0)}),t.controls.appendChild(this.add_row_button),this.delete_last_row_button=this.getButton(this.translate("button_delete_last",[this.getItemTitle()]),"delete",this.translate("button_delete_last_title",[this.getItemTitle()])),this.delete_last_row_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var i=t.getValue(),s=null;t.rows.length>1&&t.rows[t.rows.length-1].tab===t.active_tab&&(s=t.rows[t.rows.length-2].tab),i.pop(),t.setValue(i),s&&(t.active_tab=s,t.refreshTabs()),t.onChange(!0)}),t.controls.appendChild(this.delete_last_row_button),this.remove_all_rows_button=this.getButton(this.translate("button_delete_all"),"delete",this.translate("button_delete_all_title")),this.remove_all_rows_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.setValue([]),t.onChange(!0)}),t.controls.appendChild(this.remove_all_rows_button),t.tabs&&(this.add_row_button.style.width="100%",this.add_row_button.style.textAlign="left",this.add_row_button.style.marginBottom="3px",this.delete_last_row_button.style.width="100%",this.delete_last_row_button.style.textAlign="left",this.delete_last_row_button.style.marginBottom="3px",this.remove_all_rows_button.style.width="100%",this.remove_all_rows_button.style.textAlign="left",this.remove_all_rows_button.style.marginBottom="3px")},showValidationErrors:function(t){var e=this,i=[],s=[];n(t,function(t,n){n.path===e.path?i.push(n):s.push(n)}),this.error_holder&&(i.length?(this.error_holder.innerHTML="",this.error_holder.style.display="",n(i,function(t,i){e.error_holder.appendChild(e.theme.getErrorMessage(i.message))})):this.error_holder.style.display="none"),n(this.rows,function(t,e){e.showValidationErrors(s)})}}),o.defaults.editors.table=o.defaults.editors.array.extend({register:function(){if(this._super(),this.rows)for(var t=0;t<this.rows.length;t++)this.rows[t].register()},unregister:function(){if(this._super(),this.rows)for(var t=0;t<this.rows.length;t++)this.rows[t].unregister()},getNumColumns:function(){return Math.max(Math.min(12,this.width),3)},preBuild:function(){var t=this.jsoneditor.expandRefs(this.schema.items||{});this.item_title=t.title||"row",this.item_default=t.default||null,this.item_has_child_editors=t.properties||t.items,this.width=12,this._super()},build:function(){this.table=this.theme.getTable(),this.container.appendChild(this.table),this.thead=this.theme.getTableHead(),this.table.appendChild(this.thead),this.header_row=this.theme.getTableRow(),this.thead.appendChild(this.header_row),this.row_holder=this.theme.getTableBody(),this.table.appendChild(this.row_holder);var t=this.getElementEditor(0,!0);if(this.item_default=t.getDefault(),this.width=t.getNumColumns()+2,this.options.compact?(this.panel=document.createElement("div"),this.container.appendChild(this.panel)):(this.title=this.theme.getHeader(this.getTitle()),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.error_holder=document.createElement("div"),this.panel.appendChild(this.error_holder)),this.panel.appendChild(this.table),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.item_has_child_editors)for(var e=t.getChildEditors(),i=t.property_order||Object.keys(e),s=0;s<i.length;s++){var n=this.theme.getTableHeaderCell(e[i[s]].getTitle());e[i[s]].options.hidden&&(n.style.display="none"),this.header_row.appendChild(n)}else this.header_row.appendChild(this.theme.getTableHeaderCell(this.item_title));t.destroy(),this.row_holder.innerHTML="",this.controls_header_cell=this.theme.getTableHeaderCell(" "),this.header_row.appendChild(this.controls_header_cell),this.addControls()},onChildEditorChange:function(t){this.refreshValue(),this._super()},getItemDefault:function(){return s({},{default:this.item_default}).default},getItemTitle:function(){return this.item_title},getElementEditor:function(t,e){var i=s({},this.schema.items),n=this.jsoneditor.getEditorClass(i,this.jsoneditor),r=this.row_holder.appendChild(this.theme.getTableRow()),o=r;this.item_has_child_editors||(o=this.theme.getTableCell(),r.appendChild(o));var a=this.jsoneditor.createEditor(n,{jsoneditor:this.jsoneditor,schema:i,container:o,path:this.path+"."+t,parent:this,compact:!0,table_row:!0});return a.preBuild(),e||(a.build(),a.postBuild(),a.controls_cell=r.appendChild(this.theme.getTableCell()),a.row=r,a.table_controls=this.theme.getButtonHolder(),a.controls_cell.appendChild(a.table_controls),a.table_controls.style.margin=0,a.table_controls.style.padding=0),a},destroy:function(){this.innerHTML="",this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.row_holder&&this.row_holder.parentNode&&this.row_holder.parentNode.removeChild(this.row_holder),this.table&&this.table.parentNode&&this.table.parentNode.removeChild(this.table),this.panel&&this.panel.parentNode&&this.panel.parentNode.removeChild(this.panel),this.rows=this.title=this.description=this.row_holder=this.table=this.panel=null,this._super()},setValue:function(t,e){if(t=t||[],this.schema.minItems)for(;t.length<this.schema.minItems;)t.push(this.getItemDefault());if(this.schema.maxItems&&t.length>this.schema.maxItems&&(t=t.slice(0,this.schema.maxItems)),JSON.stringify(t)!==this.serialized){var i=!1,s=this;n(t,function(t,e){s.rows[t]?s.rows[t].setValue(e):(s.addRow(e),i=!0)});for(var r=t.length;r<s.rows.length;r++){var o=s.rows[r].container;s.item_has_child_editors||s.rows[r].row.parentNode.removeChild(s.rows[r].row),s.rows[r].destroy(),o.parentNode&&o.parentNode.removeChild(o),s.rows[r]=null,i=!0}s.rows=s.rows.slice(0,t.length),s.refreshValue(),(i||e)&&s.refreshRowButtons(),s.onChange()}},refreshRowButtons:function(){var t=this,e=this.schema.minItems&&this.schema.minItems>=this.rows.length,i=!1;n(this.rows,function(s,n){n.movedown_button&&(s===t.rows.length-1?n.movedown_button.style.display="none":(i=!0,n.movedown_button.style.display="")),n.delete_button&&(e?n.delete_button.style.display="none":(i=!0,n.delete_button.style.display="")),n.moveup_button&&(i=!0)}),n(this.rows,function(t,e){e.controls_cell.style.display=i?"":"none"}),this.controls_header_cell.style.display=i?"":"none";var s=!1;this.value.length?1===this.value.length?(this.table.style.display="",this.remove_all_rows_button.style.display="none",e||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display="none":(this.delete_last_row_button.style.display="",s=!0)):(this.table.style.display="",e||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display="none":(this.delete_last_row_button.style.display="",s=!0),e||this.hide_delete_all_rows_buttons?this.remove_all_rows_button.style.display="none":(this.remove_all_rows_button.style.display="",s=!0)):(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none",this.table.style.display="none"),this.schema.maxItems&&this.schema.maxItems<=this.rows.length||this.hide_add_button?this.add_row_button.style.display="none":(this.add_row_button.style.display="",s=!0),this.controls.style.display=s?"":"none"},refreshValue:function(){var t=this;this.value=[],n(this.rows,function(e,i){t.value[e]=i.getValue()}),this.serialized=JSON.stringify(this.value)},addRow:function(t){var e=this,i=this.rows.length;e.rows[i]=this.getElementEditor(i);var s=e.rows[i].table_controls;this.hide_delete_buttons||(e.rows[i].delete_button=this.getButton("","delete",this.translate("button_delete_row_title_short")),e.rows[i].delete_button.className+=" delete",e.rows[i].delete_button.setAttribute("data-i",i),e.rows[i].delete_button.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var i=1*this.getAttribute("data-i"),s=e.getValue(),r=[];n(s,function(t,e){t!==i&&r.push(e)}),e.setValue(r),e.onChange(!0)}),s.appendChild(e.rows[i].delete_button)),i&&!this.hide_move_buttons&&(e.rows[i].moveup_button=this.getButton("","moveup",this.translate("button_move_up_title")),e.rows[i].moveup_button.className+=" moveup",e.rows[i].moveup_button.setAttribute("data-i",i),e.rows[i].moveup_button.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var i=1*this.getAttribute("data-i");if(!(i<=0)){var s=e.getValue(),n=s[i-1];s[i-1]=s[i],s[i]=n,e.setValue(s),e.onChange(!0)}}),s.appendChild(e.rows[i].moveup_button)),this.hide_move_buttons||(e.rows[i].movedown_button=this.getButton("","movedown",this.translate("button_move_down_title")),e.rows[i].movedown_button.className+=" movedown",e.rows[i].movedown_button.setAttribute("data-i",i),e.rows[i].movedown_button.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var i=1*this.getAttribute("data-i"),s=e.getValue();if(!(i>=s.length-1)){var n=s[i+1];s[i+1]=s[i],s[i]=n,e.setValue(s),e.onChange(!0)}}),s.appendChild(e.rows[i].movedown_button)),t&&e.rows[i].setValue(t)},addControls:function(){var t=this;this.collapsed=!1,this.toggle_button=this.getButton("","collapse",this.translate("button_collapse")),this.title_controls&&(this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.collapsed?(t.collapsed=!1,t.panel.style.display="",t.setButtonText(this,"","collapse",t.translate("button_collapse"))):(t.collapsed=!0,t.panel.style.display="none",t.setButtonText(this,"","expand",t.translate("button_expand")))}),this.options.collapsed&&r(this.toggle_button,"click"),this.schema.options&&void 0!==this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none")),this.add_row_button=this.getButton(this.getItemTitle(),"add",this.translate("button_add_row_title",[this.getItemTitle()])),this.add_row_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.addRow(),t.refreshValue(),t.refreshRowButtons(),t.onChange(!0)}),t.controls.appendChild(this.add_row_button),this.delete_last_row_button=this.getButton(this.translate("button_delete_last",[this.getItemTitle()]),"delete",this.translate("button_delete_last_title",[this.getItemTitle()])),this.delete_last_row_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var i=t.getValue();i.pop(),t.setValue(i),t.onChange(!0)}),t.controls.appendChild(this.delete_last_row_button),this.remove_all_rows_button=this.getButton(this.translate("button_delete_all"),"delete",this.translate("button_delete_all_title")),this.remove_all_rows_button.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.setValue([]),t.onChange(!0)}),t.controls.appendChild(this.remove_all_rows_button)}}),o.defaults.editors.multiple=o.AbstractEditor.extend({register:function(){if(this.editors){for(var t=0;t<this.editors.length;t++)this.editors[t]&&this.editors[t].unregister();this.editors[this.type]&&this.editors[this.type].register()}this._super()},unregister:function(){if(this._super(),this.editors)for(var t=0;t<this.editors.length;t++)this.editors[t]&&this.editors[t].unregister()},getNumColumns:function(){return this.editors[this.type]?Math.max(this.editors[this.type].getNumColumns(),4):4},enable:function(){if(this.editors)for(var t=0;t<this.editors.length;t++)this.editors[t]&&this.editors[t].enable();this.switcher.disabled=!1,this._super()},disable:function(){if(this.editors)for(var t=0;t<this.editors.length;t++)this.editors[t]&&this.editors[t].disable();this.switcher.disabled=!0,this._super()},switchEditor:function(t){var e=this;this.editors[t]||this.buildChildEditor(t);var i=e.getValue();e.type=t,e.register(),n(e.editors,function(t,s){s&&(e.type===t?(e.keep_values&&s.setValue(i,!0),s.container.style.display=""):s.container.style.display="none")}),e.refreshValue(),e.refreshHeaderText()},buildChildEditor:function(t){var e,i=this,n=this.types[t],r=i.theme.getChildEditorHolder();i.editor_holder.appendChild(r),"string"==typeof n?(e=s({},i.schema)).type=n:(e=s({},i.schema,n),e=i.jsoneditor.expandRefs(e),n.required&&Array.isArray(n.required)&&i.schema.required&&Array.isArray(i.schema.required)&&(e.required=i.schema.required.concat(n.required)));var o=i.jsoneditor.getEditorClass(e);i.editors[t]=i.jsoneditor.createEditor(o,{jsoneditor:i.jsoneditor,schema:e,container:r,path:i.path,parent:i,required:!0}),i.editors[t].preBuild(),i.editors[t].build(),i.editors[t].postBuild(),i.editors[t].header&&(i.editors[t].header.style.display="none"),i.editors[t].option=i.switcher_options[t],r.addEventListener("change_header_text",function(){i.refreshHeaderText()}),t!==i.type&&(r.style.display="none")},preBuild:function(){if(this.types=[],this.type=0,this.editors=[],this.validators=[],this.keep_values=!0,void 0!==this.jsoneditor.options.keep_oneof_values&&(this.keep_values=this.jsoneditor.options.keep_oneof_values),void 0!==this.options.keep_oneof_values&&(this.keep_values=this.options.keep_oneof_values),this.schema.oneOf)this.oneOf=!0,this.types=this.schema.oneOf,delete this.schema.oneOf;else if(this.schema.anyOf)this.anyOf=!0,this.types=this.schema.anyOf,delete this.schema.anyOf;else{if(this.schema.type&&"any"!==this.schema.type)Array.isArray(this.schema.type)?this.types=this.schema.type:this.types=[this.schema.type];else if(this.types=["string","number","integer","boolean","object","array","null"],this.schema.disallow){var t=this.schema.disallow;"object"==typeof t&&Array.isArray(t)||(t=[t]);var e=[];n(this.types,function(i,s){-1===t.indexOf(s)&&e.push(s)}),this.types=e}delete this.schema.type}this.display_text=this.getDisplayText(this.types)},build:function(){var t=this,e=this.container;this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.container.appendChild(this.header),this.switcher=this.theme.getSwitcher(this.display_text),e.appendChild(this.switcher),this.switcher.addEventListener("change",function(e){e.preventDefault(),e.stopPropagation(),t.switchEditor(t.display_text.indexOf(this.value)),t.onChange(!0)}),this.editor_holder=document.createElement("div"),e.appendChild(this.editor_holder);var i={};t.jsoneditor.options.custom_validators&&(i.custom_validators=t.jsoneditor.options.custom_validators),this.switcher_options=this.theme.getSwitcherOptions(this.switcher),n(this.types,function(e,n){var r;t.editors[e]=!1,"string"==typeof n?(r=s({},t.schema)).type=n:(r=s({},t.schema,n),n.required&&Array.isArray(n.required)&&t.schema.required&&Array.isArray(t.schema.required)&&(r.required=t.schema.required.concat(n.required))),t.validators[e]=new o.Validator(t.jsoneditor,r,i)}),this.switchEditor(0)},onChildEditorChange:function(t){this.editors[this.type]&&(this.refreshValue(),this.refreshHeaderText()),this._super()},refreshHeaderText:function(){var t=this.getDisplayText(this.types);n(this.switcher_options,function(e,i){i.textContent=t[e]})},refreshValue:function(){this.value=this.editors[this.type].getValue()},setValue:function(t,e){var i=this;n(this.validators,function(e,s){if(!s.validate(t).length)return i.type=e,i.switcher.value=i.display_text[e],!1}),this.switchEditor(this.type),this.editors[this.type].setValue(t,e),this.refreshValue(),i.onChange()},destroy:function(){n(this.editors,function(t,e){e&&e.destroy()}),this.editor_holder&&this.editor_holder.parentNode&&this.editor_holder.parentNode.removeChild(this.editor_holder),this.switcher&&this.switcher.parentNode&&this.switcher.parentNode.removeChild(this.switcher),this._super()},showValidationErrors:function(t){var e=this;if(this.oneOf||this.anyOf){var i=this.oneOf?"oneOf":"anyOf";n(this.editors,function(r,o){if(o){var a=e.path+"."+i+"["+r+"]",l=[];n(t,function(t,i){if(i.path.substr(0,a.length)===a){var n=s({},i);n.path=e.path+n.path.substr(a.length),l.push(n)}}),o.showValidationErrors(l)}})}else n(this.editors,function(e,i){i&&i.showValidationErrors(t)})}}),o.defaults.editors.enum=o.AbstractEditor.extend({getNumColumns:function(){return 4},build:function(){this.container,this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.container.appendChild(this.title),this.options.enum_titles=this.options.enum_titles||[],this.enum=this.schema.enum,this.selected=0,this.select_options=[],this.html_values=[];for(var t=this,e=0;e<this.enum.length;e++)this.select_options[e]=this.options.enum_titles[e]||"Value "+(e+1),this.html_values[e]=this.getHTML(this.enum[e]);this.switcher=this.theme.getSwitcher(this.select_options),this.container.appendChild(this.switcher),this.display_area=this.theme.getIndentedPanel(),this.container.appendChild(this.display_area),this.options.hide_display&&(this.display_area.style.display="none"),this.switcher.addEventListener("change",function(){t.selected=t.select_options.indexOf(this.value),t.value=t.enum[t.selected],t.refreshValue(),t.onChange(!0)}),this.value=this.enum[0],this.refreshValue(),1===this.enum.length&&(this.switcher.style.display="none")},refreshValue:function(){var t=this;t.selected=-1;var e=JSON.stringify(this.value);return n(this.enum,function(i,s){if(e===JSON.stringify(s))return t.selected=i,!1}),t.selected<0?void t.setValue(t.enum[0]):(this.switcher.value=this.select_options[this.selected],void(this.display_area.innerHTML=this.html_values[this.selected]))},enable:function(){this.always_disabled||(this.switcher.disabled=!1),this._super()},disable:function(){this.switcher.disabled=!0,this._super()},getHTML:function(t){var e=this;if(null===t)return"<em>null</em>";if("object"==typeof t){var i="";return n(t,function(s,n){var r=e.getHTML(n);Array.isArray(t)||(r="<div><em>"+s+"</em>: "+r+"</div>"),i+="<li>"+r+"</li>"}),i=Array.isArray(t)?"<ol>"+i+"</ol>":"<ul style='margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;'>"+i+"</ul>"}return"boolean"==typeof t?t?"true":"false":"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t},setValue:function(t){this.value!==t&&(this.value=t,this.refreshValue(),this.onChange())},destroy:function(){this.display_area&&this.display_area.parentNode&&this.display_area.parentNode.removeChild(this.display_area),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.switcher&&this.switcher.parentNode&&this.switcher.parentNode.removeChild(this.switcher),this._super()}}),o.defaults.editors.select=o.AbstractEditor.extend({setValue:function(t,e){var i=t=this.typecast(t||"");this.enum_values.indexOf(i)<0&&(i=this.enum_values[0]),this.value!==i&&(this.input.value=this.enum_options[this.enum_values.indexOf(i)],this.select2&&this.select2.select2("val",this.input.value),this.value=i,this.onChange())},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},getNumColumns:function(){if(!this.enum_options)return 3;for(var t=this.getTitle().length,e=0;e<this.enum_options.length;e++)t=Math.max(t,this.enum_options[e].length+4);return Math.min(12,Math.max(t/7,2))},typecast:function(t){return"boolean"===this.schema.type?!!t:"number"===this.schema.type?1*t:"integer"===this.schema.type?Math.floor(1*t):""+t},getValue:function(){return this.value},preBuild:function(){var t,e=this;if(this.input_type="select",this.enum_options=[],this.enum_values=[],this.enum_display=[],this.schema.enum){var i=this.schema.options&&this.schema.options.enum_titles||[];n(this.schema.enum,function(t,s){e.enum_options[t]=""+s,e.enum_display[t]=""+(i[t]||s),e.enum_values[t]=e.typecast(s)}),this.isRequired()||(e.enum_display.unshift(" "),e.enum_options.unshift("undefined"),e.enum_values.unshift(void 0))}else if("boolean"===this.schema.type)e.enum_display=this.schema.options&&this.schema.options.enum_titles||["true","false"],e.enum_options=["1",""],e.enum_values=[!0,!1],this.isRequired()||(e.enum_display.unshift(" "),e.enum_options.unshift("undefined"),e.enum_values.unshift(void 0));else{if(!this.schema.enumSource)throw"'select' editor requires the enum property to be set.";if(this.enumSource=[],this.enum_display=[],this.enum_options=[],this.enum_values=[],Array.isArray(this.schema.enumSource))for(t=0;t<this.schema.enumSource.length;t++)"string"==typeof this.schema.enumSource[t]?this.enumSource[t]={source:this.schema.enumSource[t]}:Array.isArray(this.schema.enumSource[t])?this.enumSource[t]=this.schema.enumSource[t]:this.enumSource[t]=s({},this.schema.enumSource[t]);else this.schema.enumValue?this.enumSource=[{source:this.schema.enumSource,value:this.schema.enumValue}]:this.enumSource=[{source:this.schema.enumSource}];for(t=0;t<this.enumSource.length;t++)this.enumSource[t].value&&(this.enumSource[t].value=this.jsoneditor.compileTemplate(this.enumSource[t].value,this.template_engine)),this.enumSource[t].title&&(this.enumSource[t].title=this.jsoneditor.compileTemplate(this.enumSource[t].title,this.template_engine)),this.enumSource[t].filter&&(this.enumSource[t].filter=this.jsoneditor.compileTemplate(this.enumSource[t].filter,this.template_engine))}},build:function(){var t=this;this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.infoText&&(this.infoButton=this.theme.getInfoButton(this.options.infoText)),this.options.compact&&(this.container.className+=" compact"),this.input=this.theme.getSelectInput(this.enum_options),this.theme.setSelectOptions(this.input,this.enum_options,this.enum_display),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener("change",function(e){e.preventDefault(),e.stopPropagation(),t.onInputChange()}),this.control=this.theme.getFormControl(this.label,this.input,this.description,this.infoButton),this.container.appendChild(this.control),this.value=this.enum_values[0]},onInputChange:function(){var t,e=this.input.value;(t=-1===this.enum_options.indexOf(e)?this.enum_values[0]:this.enum_values[this.enum_options.indexOf(e)])!==this.value&&(this.value=t,this.onChange(!0))},setupSelect2:function(){if(window.jQuery&&window.jQuery.fn&&window.jQuery.fn.select2&&(this.enum_options.length>2||this.enum_options.length&&this.enumSource)){var t=s({},o.plugins.select2);this.schema.options&&this.schema.options.select2_options&&(t=s(t,this.schema.options.select2_options)),this.select2=window.jQuery(this.input).select2(t);var e=this;this.select2.on("select2-blur",function(){e.input.value=e.select2.select2("val"),e.onInputChange()}),this.select2.on("change",function(){e.input.value=e.select2.select2("val"),e.onInputChange()})}else this.select2=null},postBuild:function(){this._super(),this.theme.afterInputReady(this.input),this.setupSelect2()},onWatchedFieldChange:function(){var t,e;if(this.enumSource){t=this.getWatchedFieldValues();for(var i=[],s=[],n=0;n<this.enumSource.length;n++)if(Array.isArray(this.enumSource[n]))i=i.concat(this.enumSource[n]),s=s.concat(this.enumSource[n]);else{var r=[];if(r=Array.isArray(this.enumSource[n].source)?this.enumSource[n].source:t[this.enumSource[n].source]){if(this.enumSource[n].slice&&(r=Array.prototype.slice.apply(r,this.enumSource[n].slice)),this.enumSource[n].filter){var o=[];for(e=0;e<r.length;e++)this.enumSource[n].filter({i:e,item:r[e],watched:t})&&o.push(r[e]);r=o}var a=[],l=[];for(e=0;e<r.length;e++){var h=r[e];this.enumSource[n].value?l[e]=this.enumSource[n].value({i:e,item:h}):l[e]=r[e],this.enumSource[n].title?a[e]=this.enumSource[n].title({i:e,item:h}):a[e]=l[e]}i=i.concat(l),s=s.concat(a)}}var d=this.value;this.theme.setSelectOptions(this.input,i,s),this.enum_options=i,this.enum_display=s,this.enum_values=i,this.select2&&this.select2.select2("destroy"),-1!==i.indexOf(d)?(this.input.value=d,this.value=d):(this.input.value=i[0],this.value=i[0]||"",this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange(),this.jsoneditor.notifyWatchers(this.path)),this.setupSelect2()}this._super()},enable:function(){this.always_disabled||(this.input.disabled=!1,this.select2&&this.select2.select2("enable",!0)),this._super()},disable:function(){this.input.disabled=!0,this.select2&&this.select2.select2("enable",!1),this._super()},destroy:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.select2&&(this.select2.select2("destroy"),this.select2=null),this._super()}}),o.defaults.editors.selectize=o.AbstractEditor.extend({setValue:function(t,e){var i=t=this.typecast(t||"");this.enum_values.indexOf(i)<0&&(i=this.enum_values[0]),this.value!==i&&(this.input.value=this.enum_options[this.enum_values.indexOf(i)],this.selectize&&this.selectize[0].selectize.addItem(i),this.value=i,this.onChange())},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},getNumColumns:function(){if(!this.enum_options)return 3;for(var t=this.getTitle().length,e=0;e<this.enum_options.length;e++)t=Math.max(t,this.enum_options[e].length+4);return Math.min(12,Math.max(t/7,2))},typecast:function(t){return"boolean"===this.schema.type?!!t:"number"===this.schema.type?1*t:"integer"===this.schema.type?Math.floor(1*t):""+t},getValue:function(){return this.value},preBuild:function(){var t,e=this;if(this.input_type="select",this.enum_options=[],this.enum_values=[],this.enum_display=[],this.schema.enum){var i=this.schema.options&&this.schema.options.enum_titles||[];n(this.schema.enum,function(t,s){e.enum_options[t]=""+s,e.enum_display[t]=""+(i[t]||s),e.enum_values[t]=e.typecast(s)})}else if("boolean"===this.schema.type)e.enum_display=this.schema.options&&this.schema.options.enum_titles||["true","false"],e.enum_options=["1","0"],e.enum_values=[!0,!1];else{if(!this.schema.enumSource)throw"'select' editor requires the enum property to be set.";if(this.enumSource=[],this.enum_display=[],this.enum_options=[],this.enum_values=[],Array.isArray(this.schema.enumSource))for(t=0;t<this.schema.enumSource.length;t++)"string"==typeof this.schema.enumSource[t]?this.enumSource[t]={source:this.schema.enumSource[t]}:Array.isArray(this.schema.enumSource[t])?this.enumSource[t]=this.schema.enumSource[t]:this.enumSource[t]=s({},this.schema.enumSource[t]);else this.schema.enumValue?this.enumSource=[{source:this.schema.enumSource,value:this.schema.enumValue}]:this.enumSource=[{source:this.schema.enumSource}];for(t=0;t<this.enumSource.length;t++)this.enumSource[t].value&&(this.enumSource[t].value=this.jsoneditor.compileTemplate(this.enumSource[t].value,this.template_engine)),this.enumSource[t].title&&(this.enumSource[t].title=this.jsoneditor.compileTemplate(this.enumSource[t].title,this.template_engine)),this.enumSource[t].filter&&(this.enumSource[t].filter=this.jsoneditor.compileTemplate(this.enumSource[t].filter,this.template_engine))}},build:function(){var t=this;this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.infoText&&(this.infoButton=this.theme.getInfoButton(this.options.infoText)),this.options.compact&&(this.container.className+=" compact"),this.input=this.theme.getSelectInput(this.enum_options),this.theme.setSelectOptions(this.input,this.enum_options,this.enum_display),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener("change",function(e){e.preventDefault(),e.stopPropagation(),t.onInputChange()}),this.control=this.theme.getFormControl(this.label,this.input,this.description,this.infoButton),this.container.appendChild(this.control),this.value=this.enum_values[0]},onInputChange:function(){var t=this.input.value;-1===this.enum_options.indexOf(t)&&this.enum_options[0],this.value=this.enum_values[this.enum_options.indexOf(t)],this.onChange(!0)},setupSelectize:function(){var t=this;if(window.jQuery&&window.jQuery.fn&&window.jQuery.fn.selectize&&(this.enum_options.length>=2||this.enum_options.length&&this.enumSource)){var e=s({},o.plugins.selectize);this.schema.options&&this.schema.options.selectize_options&&(e=s(e,this.schema.options.selectize_options)),this.selectize=window.jQuery(this.input).selectize(s(e,{create:!0,onChange:function(){t.onInputChange()}}))}else this.selectize=null},postBuild:function(){this._super(),this.theme.afterInputReady(this.input),this.setupSelectize()},onWatchedFieldChange:function(){var t,e;if(this.enumSource){t=this.getWatchedFieldValues();for(var i=[],s=[],n=0;n<this.enumSource.length;n++)if(Array.isArray(this.enumSource[n]))i=i.concat(this.enumSource[n]),s=s.concat(this.enumSource[n]);else if(t[this.enumSource[n].source]){var r=t[this.enumSource[n].source];if(this.enumSource[n].slice&&(r=Array.prototype.slice.apply(r,this.enumSource[n].slice)),this.enumSource[n].filter){var o=[];for(e=0;e<r.length;e++)this.enumSource[n].filter({i:e,item:r[e]})&&o.push(r[e]);r=o}var a=[],l=[];for(e=0;e<r.length;e++){var h=r[e];this.enumSource[n].value?l[e]=this.enumSource[n].value({i:e,item:h}):l[e]=r[e],this.enumSource[n].title?a[e]=this.enumSource[n].title({i:e,item:h}):a[e]=l[e]}i=i.concat(l),s=s.concat(a)}var d=this.value;this.theme.setSelectOptions(this.input,i,s),this.enum_options=i,this.enum_display=s,this.enum_values=i,-1!==i.indexOf(d)?(this.input.value=d,this.value=d):(this.input.value=i[0],this.value=i[0]||"",this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange(),this.jsoneditor.notifyWatchers(this.path)),this.selectize?this.updateSelectizeOptions(i):this.setupSelectize(),this._super()}},updateSelectizeOptions:function(t){var e=this.selectize[0].selectize,i=this;e.off(),e.clearOptions();for(var s in t)e.addOption({value:t[s],text:t[s]});e.addItem(this.value),e.on("change",function(){i.onInputChange()})},enable:function(){this.always_disabled||(this.input.disabled=!1,this.selectize&&this.selectize[0].selectize.unlock()),this._super()},disable:function(){this.input.disabled=!0,this.selectize&&this.selectize[0].selectize.lock(),this._super()},destroy:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.selectize&&(this.selectize[0].selectize.destroy(),this.selectize=null),this._super()}}),o.defaults.editors.multiselect=o.AbstractEditor.extend({preBuild:function(){var t;this._super(),this.select_options={},this.select_values={};var e=this.jsoneditor.expandRefs(this.schema.items||{}),i=e.enum||[],s=e.options?e.options.enum_titles||[]:[];for(this.option_keys=[],this.option_titles=[],t=0;t<i.length;t++)this.sanitize(i[t])===i[t]&&(this.option_keys.push(i[t]+""),this.option_titles.push((s[t]||i[t])+""),this.select_values[i[t]+""]=i[t])},build:function(){var t,e=this;if(this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),!this.schema.format&&this.option_keys.length<8||"checkbox"===this.schema.format){for(this.input_type="checkboxes",this.inputs={},this.controls={},t=0;t<this.option_keys.length;t++){this.inputs[this.option_keys[t]]=this.theme.getCheckbox(),this.select_options[this.option_keys[t]]=this.inputs[this.option_keys[t]];var i=this.theme.getCheckboxLabel(this.option_titles[t]);this.controls[this.option_keys[t]]=this.theme.getFormControl(i,this.inputs[this.option_keys[t]])}this.control=this.theme.getMultiCheckboxHolder(this.controls,this.label,this.description)}else{for(this.input_type="select",this.input=this.theme.getSelectInput(this.option_keys),this.theme.setSelectOptions(this.input,this.option_keys,this.option_titles),this.input.multiple=!0,this.input.size=Math.min(10,this.option_keys.length),t=0;t<this.option_keys.length;t++)this.select_options[this.option_keys[t]]=this.input.children[t];(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.control=this.theme.getFormControl(this.label,this.input,this.description)}this.container.appendChild(this.control),this.control.addEventListener("change",function(i){i.preventDefault(),i.stopPropagation();var s=[];for(t=0;t<e.option_keys.length;t++)(e.select_options[e.option_keys[t]].selected||e.select_options[e.option_keys[t]].checked)&&s.push(e.select_values[e.option_keys[t]]);e.updateValue(s),e.onChange(!0)})},setValue:function(t,e){var i;for("object"!=typeof(t=t||[])?t=[t]:Array.isArray(t)||(t=[]),i=0;i<t.length;i++)"string"!=typeof t[i]&&(t[i]+="");for(i in this.select_options)this.select_options.hasOwnProperty(i)&&(this.select_options[i]["select"===this.input_type?"selected":"checked"]=-1!==t.indexOf(i));this.updateValue(t),this.onChange()},setupSelect2:function(){if(window.jQuery&&window.jQuery.fn&&window.jQuery.fn.select2){var t=window.jQuery.extend({},o.plugins.select2);this.schema.options&&this.schema.options.select2_options&&(t=s(t,this.schema.options.select2_options)),this.select2=window.jQuery(this.input).select2(t);var e=this;this.select2.on("select2-blur",function(){var t=e.select2.select2("val");e.value=t,e.onChange(!0)})}else this.select2=null},onInputChange:function(){this.value=this.input.value,this.onChange(!0)},postBuild:function(){this._super(),this.setupSelect2()},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},getNumColumns:function(){var t=this.getTitle().length;for(var e in this.select_values)this.select_values.hasOwnProperty(e)&&(t=Math.max(t,(this.select_values[e]+"").length+4));return Math.min(12,Math.max(t/7,2))},updateValue:function(t){for(var e=!1,i=[],s=0;s<t.length;s++)if(this.select_options[t[s]+""]){var n=this.sanitize(this.select_values[t[s]]);i.push(n),n!==t[s]&&(e=!0)}else e=!0;return this.value=i,this.select2&&this.select2.select2("val",this.value),e},sanitize:function(t){return"number"===this.schema.items.type?1*t:"integer"===this.schema.items.type?Math.floor(1*t):""+t},enable:function(){if(!this.always_disabled){if(this.input)this.input.disabled=!1;else if(this.inputs)for(var t in this.inputs)this.inputs.hasOwnProperty(t)&&(this.inputs[t].disabled=!1);this.select2&&this.select2.select2("enable",!0)}this._super()},disable:function(){if(this.input)this.input.disabled=!0;else if(this.inputs)for(var t in this.inputs)this.inputs.hasOwnProperty(t)&&(this.inputs[t].disabled=!0);this.select2&&this.select2.select2("enable",!1),this._super()},destroy:function(){this.select2&&(this.select2.select2("destroy"),this.select2=null),this._super()}}),o.defaults.editors.base64=o.AbstractEditor.extend({getNumColumns:function(){return 4},build:function(){var t=this;if(this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.options.infoText&&(this.infoButton=this.theme.getInfoButton(this.options.infoText)),this.input=this.theme.getFormInputField("hidden"),this.container.appendChild(this.input),!this.schema.readOnly&&!this.schema.readonly){if(!window.FileReader)throw"FileReader required for base64 editor";this.uploader=this.theme.getFormInputField("file"),this.uploader.addEventListener("change",function(e){if(e.preventDefault(),e.stopPropagation(),this.files&&this.files.length){var i=new FileReader;i.onload=function(e){t.value=e.target.result,t.refreshPreview(),t.onChange(!0),i=null},i.readAsDataURL(this.files[0])}})}this.preview=this.theme.getFormInputDescription(this.schema.description),this.container.appendChild(this.preview),this.control=this.theme.getFormControl(this.label,this.uploader||this.input,this.preview,this.infoButton),this.container.appendChild(this.control)},refreshPreview:function(){if(this.last_preview!==this.value&&(this.last_preview=this.value,this.preview.innerHTML="",this.value)){var t=this.value.match(/^data:([^;,]+)[;,]/);if(t&&(t=t[1]),t){if(this.preview.innerHTML="<strong>Type:</strong> "+t+", <strong>Size:</strong> "+Math.floor((this.value.length-this.value.split(",")[0].length-1)/1.33333)+" bytes","image"===t.substr(0,5)){this.preview.innerHTML+="<br>";var e=document.createElement("img");e.style.maxWidth="100%",e.style.maxHeight="100px",e.src=this.value,this.preview.appendChild(e)}}else this.preview.innerHTML="<em>Invalid data URI</em>"}},enable:function(){this.uploader&&(this.uploader.disabled=!1),this._super()},disable:function(){this.uploader&&(this.uploader.disabled=!0),this._super()},setValue:function(t){this.value!==t&&(this.value=t,this.input.value=this.value,this.refreshPreview(),this.onChange())},destroy:function(){this.preview&&this.preview.parentNode&&this.preview.parentNode.removeChild(this.preview),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.uploader&&this.uploader.parentNode&&this.uploader.parentNode.removeChild(this.uploader),this._super()}}),o.defaults.editors.upload=o.AbstractEditor.extend({getNumColumns:function(){return 4},build:function(){var t=this;if(this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.input=this.theme.getFormInputField("hidden"),this.container.appendChild(this.input),!this.schema.readOnly&&!this.schema.readonly){if(!this.jsoneditor.options.upload)throw"Upload handler required for upload editor";this.uploader=this.theme.getFormInputField("file"),this.uploader.addEventListener("change",function(e){if(e.preventDefault(),e.stopPropagation(),this.files&&this.files.length){var i=new FileReader;i.onload=function(e){t.preview_value=e.target.result,t.refreshPreview(),t.onChange(!0),i=null},i.readAsDataURL(this.files[0])}})}var e=this.schema.description;e||(e=""),this.preview=this.theme.getFormInputDescription(e),this.container.appendChild(this.preview),this.control=this.theme.getFormControl(this.label,this.uploader||this.input,this.preview),this.container.appendChild(this.control)},refreshPreview:function(){if(this.last_preview!==this.preview_value&&(this.last_preview=this.preview_value,this.preview.innerHTML="",this.preview_value)){var t=this,e=this.preview_value.match(/^data:([^;,]+)[;,]/);e&&(e=e[1]),e||(e="unknown");var i=this.uploader.files[0];if(this.preview.innerHTML="<strong>Type:</strong> "+e+", <strong>Size:</strong> "+i.size+" bytes","image"===e.substr(0,5)){this.preview.innerHTML+="<br>";var s=document.createElement("img");s.style.maxWidth="100%",s.style.maxHeight="100px",s.src=this.preview_value,this.preview.appendChild(s)}this.preview.innerHTML+="<br>";var n=this.getButton("Upload","upload","Upload");this.preview.appendChild(n),n.addEventListener("click",function(e){e.preventDefault(),n.setAttribute("disabled","disabled"),t.theme.removeInputError(t.uploader),t.theme.getProgressBar&&(t.progressBar=t.theme.getProgressBar(),t.preview.appendChild(t.progressBar)),t.jsoneditor.options.upload(t.path,i,{success:function(e){t.setValue(e),t.parent?t.parent.onChildEditorChange(t):t.jsoneditor.onChange(),t.progressBar&&t.preview.removeChild(t.progressBar),n.removeAttribute("disabled")},failure:function(e){t.theme.addInputError(t.uploader,e),t.progressBar&&t.preview.removeChild(t.progressBar),n.removeAttribute("disabled")},updateProgress:function(e){t.progressBar&&(e?t.theme.updateProgressBar(t.progressBar,e):t.theme.updateProgressBarUnknown(t.progressBar))}})})}},enable:function(){this.uploader&&(this.uploader.disabled=!1),this._super()},disable:function(){this.uploader&&(this.uploader.disabled=!0),this._super()},setValue:function(t){this.value!==t&&(this.value=t,this.input.value=this.value,this.onChange())},destroy:function(){this.preview&&this.preview.parentNode&&this.preview.parentNode.removeChild(this.preview),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.uploader&&this.uploader.parentNode&&this.uploader.parentNode.removeChild(this.uploader),this._super()}}),o.defaults.editors.checkbox=o.AbstractEditor.extend({setValue:function(t,e){this.value=!!t,this.input.checked=this.value,this.onChange()},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},getNumColumns:function(){return Math.min(12,Math.max(this.getTitle().length/7,2))},build:function(){var t=this;this.options.compact||(this.label=this.header=this.theme.getCheckboxLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.infoText&&(this.infoButton=this.theme.getInfoButton(this.options.infoText)),this.options.compact&&(this.container.className+=" compact"),this.input=this.theme.getCheckbox(),this.control=this.theme.getFormControl(this.label,this.input,this.description,this.infoButton),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener("change",function(e){e.preventDefault(),e.stopPropagation(),t.value=this.checked,t.onChange(!0)}),this.container.appendChild(this.control)},enable:function(){this.always_disabled||(this.input.disabled=!1),this._super()},disable:function(){this.input.disabled=!0,this._super()},destroy:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this._super()}}),o.defaults.editors.arraySelectize=o.AbstractEditor.extend({build:function(){this.title=this.theme.getFormInputLabel(this.getTitle()),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.error_holder=document.createElement("div"),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description)),this.input=document.createElement("select"),this.input.setAttribute("multiple","multiple");var t=this.theme.getFormControl(this.title,this.input,this.description);this.container.appendChild(t),this.container.appendChild(this.error_holder),window.jQuery(this.input).selectize({delimiter:!1,createOnBlur:!0,create:!0})},postBuild:function(){var t=this;this.input.selectize.on("change",function(e){t.refreshValue(),t.onChange(!0)})},destroy:function(){this.empty(!0),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this._super()},empty:function(t){},setValue:function(t,e){var i=this;t=t||[],Array.isArray(t)||(t=[t]),this.input.selectize.clearOptions(),this.input.selectize.clear(!0),t.forEach(function(t){i.input.selectize.addOption({text:t,value:t})}),this.input.selectize.setValue(t),this.refreshValue(e)},refreshValue:function(t){this.value=this.input.selectize.getValue()},showValidationErrors:function(t){var e=this,i=[],s=[];n(t,function(t,n){n.path===e.path?i.push(n):s.push(n)}),this.error_holder&&(i.length?(this.error_holder.innerHTML="",this.error_holder.style.display="",n(i,function(t,i){e.error_holder.appendChild(e.theme.getErrorMessage(i.message))})):this.error_holder.style.display="none")}});var a,l=(a=document.documentElement).matches?"matches":a.webkitMatchesSelector?"webkitMatchesSelector":a.mozMatchesSelector?"mozMatchesSelector":a.msMatchesSelector?"msMatchesSelector":a.oMatchesSelector?"oMatchesSelector":void 0;o.AbstractTheme=t.extend({getContainer:function(){return document.createElement("div")},getFloatRightLinkHolder:function(){var t=document.createElement("div");return t.style=t.style||{},t.style.cssFloat="right",t.style.marginLeft="10px",t},getModal:function(){var t=document.createElement("div");return t.style.backgroundColor="white",t.style.border="1px solid black",t.style.boxShadow="3px 3px black",t.style.position="absolute",t.style.zIndex="10",t.style.display="none",t},getGridContainer:function(){return document.createElement("div")},getGridRow:function(){var t=document.createElement("div");return t.className="row",t},getGridColumn:function(){return document.createElement("div")},setGridColumnSize:function(t,e){},getLink:function(t){var e=document.createElement("a");return e.setAttribute("href","#"),e.appendChild(document.createTextNode(t)),e},disableHeader:function(t){t.style.color="#ccc"},disableLabel:function(t){t.style.color="#ccc"},enableHeader:function(t){t.style.color=""},enableLabel:function(t){t.style.color=""},getInfoButton:function(t){var e=document.createElement("span");e.innerText="ⓘ",e.style.fontSize="16px",e.style.fontWeight="bold",e.style.padding=".25rem",e.style.position="relative",e.style.display="inline-block";var i=document.createElement("span");return i.style.fontSize="12px",e.style.fontWeight="normal",i.style["font-family"]="sans-serif",i.style.visibility="hidden",i.style["background-color"]="rgba(50, 50, 50, .75)",i.style.margin="0 .25rem",i.style.color="#FAFAFA",i.style.padding=".5rem 1rem",i.style["border-radius"]=".25rem",i.style.width="20rem",i.style.position="absolute",i.innerText=t,e.onmouseover=function(){i.style.visibility="visible"},e.onmouseleave=function(){i.style.visibility="hidden"},e.appendChild(i),e},getFormInputLabel:function(t){var e=document.createElement("label");return e.appendChild(document.createTextNode(t)),e},getCheckboxLabel:function(t){var e=this.getFormInputLabel(t);return e.style.fontWeight="normal",e},getHeader:function(t){var e=document.createElement("h3");return"string"==typeof t?e.textContent=t:e.appendChild(t),e},getCheckbox:function(){var t=this.getFormInputField("checkbox");return t.style.display="inline-block",t.style.width="auto",t},getMultiCheckboxHolder:function(t,e,i){var s=document.createElement("div");e&&(e.style.display="block",s.appendChild(e));for(var n in t)t.hasOwnProperty(n)&&(t[n].style.display="inline-block",t[n].style.marginRight="20px",s.appendChild(t[n]));return i&&s.appendChild(i),s},getSelectInput:function(t){var e=document.createElement("select");return t&&this.setSelectOptions(e,t),e},getSwitcher:function(t){var e=this.getSelectInput(t);return e.style.backgroundColor="transparent",e.style.display="inline-block",e.style.fontStyle="italic",e.style.fontWeight="normal",e.style.height="auto",e.style.marginBottom=0,e.style.marginLeft="5px",e.style.padding="0 0 0 3px",e.style.width="auto",e},getSwitcherOptions:function(t){return t.getElementsByTagName("option")},setSwitcherOptions:function(t,e,i){this.setSelectOptions(t,e,i)},setSelectOptions:function(t,e,i){i=i||[],t.innerHTML="";for(var s=0;s<e.length;s++){var n=document.createElement("option");n.setAttribute("value",e[s]),n.textContent=i[s]||e[s],t.appendChild(n)}},getTextareaInput:function(){var t=document.createElement("textarea");return t.style=t.style||{},t.style.width="100%",t.style.height="300px",t.style.boxSizing="border-box",t},getRangeInput:function(t,e,i){var s=this.getFormInputField("range");return s.setAttribute("min",t),s.setAttribute("max",e),s.setAttribute("step",i),s},getFormInputField:function(t){var e=document.createElement("input");return e.setAttribute("type",t),e},afterInputReady:function(t){},getFormControl:function(t,e,i,s){var n=document.createElement("div");return n.className="form-control",t&&n.appendChild(t),"checkbox"===e.type?(t.insertBefore(e,t.firstChild),s&&t.appendChild(s)):(s&&t.appendChild(s),n.appendChild(e)),i&&n.appendChild(i),n},getIndentedPanel:function(){var t=document.createElement("div");return t.style=t.style||{},t.style.paddingLeft="10px",t.style.marginLeft="10px",t.style.borderLeft="1px solid #ccc",t},getChildEditorHolder:function(){return document.createElement("div")},getDescription:function(t){var e=document.createElement("p");return e.innerHTML=t,e},getCheckboxDescription:function(t){return this.getDescription(t)},getFormInputDescription:function(t){return this.getDescription(t)},getHeaderButtonHolder:function(){return this.getButtonHolder()},getButtonHolder:function(){return document.createElement("div")},getButton:function(t,e,i){var s=document.createElement("button");return s.type="button",this.setButtonText(s,t,e,i),s},setButtonText:function(t,e,i,s){t.innerHTML="",i&&(t.appendChild(i),t.innerHTML+=" "),t.appendChild(document.createTextNode(e)),s&&t.setAttribute("title",s)},getTable:function(){return document.createElement("table")},getTableRow:function(){return document.createElement("tr")},getTableHead:function(){return document.createElement("thead")},getTableBody:function(){return document.createElement("tbody")},getTableHeaderCell:function(t){var e=document.createElement("th");return e.textContent=t,e},getTableCell:function(){return document.createElement("td")},getErrorMessage:function(t){var e=document.createElement("p");return e.style=e.style||{},e.style.color="red",e.appendChild(document.createTextNode(t)),e},addInputError:function(t,e){},removeInputError:function(t){},addTableRowError:function(t){},removeTableRowError:function(t){},getTabHolder:function(){var t=document.createElement("div");return t.innerHTML="<div style='float: left; width: 130px;' class='tabs'></div><div class='content' style='margin-left: 130px;'></div><div style='clear:both;'></div>",t},applyStyles:function(t,e){t.style=t.style||{};for(var i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},closest:function(t,e){for(;t&&t!==document;){if(!t[l])return!1;if(t[l](e))return t;t=t.parentNode}return!1},getTab:function(t){var e=document.createElement("div");return e.appendChild(t),e.style=e.style||{},this.applyStyles(e,{border:"1px solid #ccc",borderWidth:"1px 0 1px 1px",textAlign:"center",lineHeight:"30px",borderRadius:"5px",borderBottomRightRadius:0,borderTopRightRadius:0,fontWeight:"bold",cursor:"pointer"}),e},getTabContentHolder:function(t){return t.children[1]},getTabContent:function(){return this.getIndentedPanel()},markTabActive:function(t){this.applyStyles(t,{opacity:1,background:"white"})},markTabInactive:function(t){this.applyStyles(t,{opacity:.5,background:""})},addTab:function(t,e){t.children[0].appendChild(e)},getBlockLink:function(){var t=document.createElement("a");return t.style.display="block",t},getBlockLinkHolder:function(){return document.createElement("div")},getLinksHolder:function(){return document.createElement("div")},createMediaLink:function(t,e,i){t.appendChild(e),i.style.width="100%",t.appendChild(i)},createImageLink:function(t,e,i){t.appendChild(e),e.appendChild(i)}}),o.defaults.themes.bootstrap2=o.AbstractTheme.extend({getRangeInput:function(t,e,i){return this._super(t,e,i)},getGridContainer:function(){var t=document.createElement("div");return t.className="container-fluid",t},getGridRow:function(){var t=document.createElement("div");return t.className="row-fluid",t},getFormInputLabel:function(t){var e=this._super(t);return e.style.display="inline-block",e.style.fontWeight="bold",e},setGridColumnSize:function(t,e){t.className="span"+e},getSelectInput:function(t){var e=this._super(t);return e.style.width="auto",e.style.maxWidth="98%",e},getFormInputField:function(t){var e=this._super(t);return e.style.width="98%",e},afterInputReady:function(t){t.controlgroup||(t.controlgroup=this.closest(t,".control-group"),t.controls=this.closest(t,".controls"),this.closest(t,".compact")&&(t.controlgroup.className=t.controlgroup.className.replace(/control-group/g,"").replace(/[ ]{2,}/g," "),t.controls.className=t.controlgroup.className.replace(/controls/g,"").replace(/[ ]{2,}/g," "),t.style.marginBottom=0))},getIndentedPanel:function(){var t=document.createElement("div");return t.className="well well-small",t.style.paddingBottom=0,t},getInfoButton:function(t){var e=document.createElement("span");e.className="icon-info-sign pull-right",e.style.padding=".25rem",e.style.position="relative",e.style.display="inline-block";var i=document.createElement("span");return i.style["font-family"]="sans-serif",i.style.visibility="hidden",i.style["background-color"]="rgba(50, 50, 50, .75)",i.style.margin="0 .25rem",i.style.color="#FAFAFA",i.style.padding=".5rem 1rem",i.style["border-radius"]=".25rem",i.style.width="25rem",i.style.transform="translateX(-27rem) translateY(-.5rem)",i.style.position="absolute",i.innerText=t,e.onmouseover=function(){i.style.visibility="visible"},e.onmouseleave=function(){i.style.visibility="hidden"},e.appendChild(i),e},getFormInputDescription:function(t){var e=document.createElement("p");return e.className="help-inline",e.textContent=t,e},getFormControl:function(t,e,i,s){var n=document.createElement("div");n.className="control-group";var r=document.createElement("div");return r.className="controls",t&&"checkbox"===e.getAttribute("type")?(n.appendChild(r),t.className+=" checkbox",t.appendChild(e),r.appendChild(t),s&&r.appendChild(s),r.style.height="30px"):(t&&(t.className+=" control-label",n.appendChild(t)),s&&r.appendChild(s),r.appendChild(e),n.appendChild(r)),i&&r.appendChild(i),n},getHeaderButtonHolder:function(){var t=this.getButtonHolder();return t.style.marginLeft="10px",t},getButtonHolder:function(){var t=document.createElement("div");return t.className="btn-group",t},getButton:function(t,e,i){var s=this._super(t,e,i);return s.className+=" btn btn-default",s},getTable:function(){var t=document.createElement("table");return t.className="table table-bordered",t.style.width="auto",t.style.maxWidth="none",t},addInputError:function(t,e){t.controlgroup&&t.controls&&(t.controlgroup.className+=" error",t.errmsg?t.errmsg.style.display="":(t.errmsg=document.createElement("p"),t.errmsg.className="help-block errormsg",t.controls.appendChild(t.errmsg)),t.errmsg.textContent=e)},removeInputError:function(t){t.errmsg&&(t.errmsg.style.display="none",t.controlgroup.className=t.controlgroup.className.replace(/\s?error/g,""))},getTabHolder:function(){var t=document.createElement("div");return t.className="tabbable tabs-left",t.innerHTML="<ul class='nav nav-tabs span2' style='margin-right: 0;'></ul><div class='tab-content span10' style='overflow:visible;'></div>",t},getTab:function(t){var e=document.createElement("li"),i=document.createElement("a");return i.setAttribute("href","#"),i.appendChild(t),e.appendChild(i),e},getTabContentHolder:function(t){return t.children[1]},getTabContent:function(){var t=document.createElement("div");return t.className="tab-pane active",t},markTabActive:function(t){t.className+=" active"},markTabInactive:function(t){t.className=t.className.replace(/\s?active/g,"")},addTab:function(t,e){t.children[0].appendChild(e)},getProgressBar:function(){var t=document.createElement("div");t.className="progress";var e=document.createElement("div");return e.className="bar",e.style.width="0%",t.appendChild(e),t},updateProgressBar:function(t,e){t&&(t.firstChild.style.width=e+"%")},updateProgressBarUnknown:function(t){t&&(t.className="progress progress-striped active",t.firstChild.style.width="100%")}}),o.defaults.themes.bootstrap3=o.AbstractTheme.extend({getSelectInput:function(t){var e=this._super(t);return e.className+="form-control",e},setGridColumnSize:function(t,e){t.className="col-md-"+e},afterInputReady:function(t){t.controlgroup||(t.controlgroup=this.closest(t,".form-group"),this.closest(t,".compact")&&(t.controlgroup.style.marginBottom=0))},getTextareaInput:function(){var t=document.createElement("textarea");return t.className="form-control",t},getRangeInput:function(t,e,i){return this._super(t,e,i)},getFormInputField:function(t){var e=this._super(t);return"checkbox"!==t&&(e.className+="form-control"),e},getFormControl:function(t,e,i,s){var n=document.createElement("div");return t&&"checkbox"===e.type?(n.className+=" checkbox",t.appendChild(e),t.style.fontSize="14px",n.style.marginTop="0",s&&n.appendChild(s),n.appendChild(t),e.style.position="relative",e.style.cssFloat="left"):(n.className+=" form-group",t&&(t.className+=" control-label",n.appendChild(t)),s&&n.appendChild(s),n.appendChild(e)),i&&n.appendChild(i),n},getIndentedPanel:function(){var t=document.createElement("div");return t.className="well well-sm",t.style.paddingBottom=0,t},getInfoButton:function(t){var e=document.createElement("span");e.className="glyphicon glyphicon-info-sign pull-right",e.style.padding=".25rem",e.style.position="relative",e.style.display="inline-block";var i=document.createElement("span");return i.style["font-family"]="sans-serif",i.style.visibility="hidden",i.style["background-color"]="rgba(50, 50, 50, .75)",i.style.margin="0 .25rem",i.style.color="#FAFAFA",i.style.padding=".5rem 1rem",i.style["border-radius"]=".25rem",i.style.width="25rem",i.style.transform="translateX(-27rem) translateY(-.5rem)",i.style.position="absolute",i.innerText=t,e.onmouseover=function(){i.style.visibility="visible"},e.onmouseleave=function(){i.style.visibility="hidden"},e.appendChild(i),e},getFormInputDescription:function(t){var e=document.createElement("p");return e.className="help-block",e.innerHTML=t,e},getHeaderButtonHolder:function(){var t=this.getButtonHolder();return t.style.marginLeft="10px",t},getButtonHolder:function(){var t=document.createElement("div");return t.className="btn-group",t},getButton:function(t,e,i){var s=this._super(t,e,i);return s.className+="btn btn-default",s},getTable:function(){var t=document.createElement("table");return t.className="table table-bordered",t.style.width="auto",t.style.maxWidth="none",t},addInputError:function(t,e){t.controlgroup&&(t.controlgroup.className+=" has-error",t.errmsg?t.errmsg.style.display="":(t.errmsg=document.createElement("p"),t.errmsg.className="help-block errormsg",t.controlgroup.appendChild(t.errmsg)),t.errmsg.textContent=e)},removeInputError:function(t){t.errmsg&&(t.errmsg.style.display="none",t.controlgroup.className=t.controlgroup.className.replace(/\s?has-error/g,""))},getTabHolder:function(){var t=document.createElement("div");return t.innerHTML="<div class='tabs list-group col-md-2'></div><div class='col-md-10'></div>",t.className="rows",t},getTab:function(t){var e=document.createElement("a");return e.className="list-group-item",e.setAttribute("href","#"),e.appendChild(t),e},markTabActive:function(t){t.className+=" active"},markTabInactive:function(t){t.className=t.className.replace(/\s?active/g,"")},getProgressBar:function(){var t=document.createElement("div");t.className="progress";var e=document.createElement("div");return e.className="progress-bar",e.setAttribute("role","progressbar"),e.setAttribute("aria-valuenow",0),e.setAttribute("aria-valuemin",0),e.setAttribute("aria-valuenax",100),e.innerHTML="0%",t.appendChild(e),t},updateProgressBar:function(t,e){if(t){var i=t.firstChild,s=e+"%";i.setAttribute("aria-valuenow",e),i.style.width=s,i.innerHTML=s}},updateProgressBarUnknown:function(t){if(t){var e=t.firstChild;t.className="progress progress-striped active",e.removeAttribute("aria-valuenow"),e.style.width="100%",e.innerHTML=""}}}),o.defaults.themes.foundation=o.AbstractTheme.extend({getChildEditorHolder:function(){var t=document.createElement("div");return t.style.marginBottom="15px",t},getSelectInput:function(t){var e=this._super(t);return e.style.minWidth="none",e.style.padding="5px",e.style.marginTop="3px",e},getSwitcher:function(t){var e=this._super(t);return e.style.paddingRight="8px",e},afterInputReady:function(t){this.closest(t,".compact")&&(t.style.marginBottom=0),t.group=this.closest(t,".form-control")},getFormInputLabel:function(t){var e=this._super(t);return e.style.display="inline-block",e},getFormInputField:function(t){var e=this._super(t);return e.style.width="100%",e.style.marginBottom="checkbox"===t?"0":"12px",e},getFormInputDescription:function(t){var e=document.createElement("p");return e.textContent=t,e.style.marginTop="-10px",e.style.fontStyle="italic",e},getIndentedPanel:function(){var t=document.createElement("div");return t.className="panel",t.style.paddingBottom=0,t},getHeaderButtonHolder:function(){var t=this.getButtonHolder();return t.style.display="inline-block",t.style.marginLeft="10px",t.style.verticalAlign="middle",t},getButtonHolder:function(){var t=document.createElement("div");return t.className="button-group",t},getButton:function(t,e,i){var s=this._super(t,e,i);return s.className+=" small button",s},addInputError:function(t,e){t.group&&(t.group.className+=" error",t.errmsg?t.errmsg.style.display="":(t.insertAdjacentHTML("afterend",'<small class="error"></small>'),t.errmsg=t.parentNode.getElementsByClassName("error")[0]),t.errmsg.textContent=e)},removeInputError:function(t){t.errmsg&&(t.group.className=t.group.className.replace(/ error/g,""),t.errmsg.style.display="none")},getProgressBar:function(){var t=document.createElement("div");t.className="progress";var e=document.createElement("span");return e.className="meter",e.style.width="0%",t.appendChild(e),t},updateProgressBar:function(t,e){t&&(t.firstChild.style.width=e+"%")},updateProgressBarUnknown:function(t){t&&(t.firstChild.style.width="100%")}}),o.defaults.themes.foundation3=o.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var t=this._super();return t.style.fontSize=".6em",t},getFormInputLabel:function(t){var e=this._super(t);return e.style.fontWeight="bold",e},getTabHolder:function(){var t=document.createElement("div");return t.className="row",t.innerHTML="<dl class='tabs vertical two columns'></dl><div class='tabs-content ten columns'></div>",t},setGridColumnSize:function(t,e){t.className="columns "+["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"][e]},getTab:function(t){var e=document.createElement("dd"),i=document.createElement("a");return i.setAttribute("href","#"),i.appendChild(t),e.appendChild(i),e},getTabContentHolder:function(t){return t.children[1]},getTabContent:function(){var t=document.createElement("div");return t.className="content active",t.style.paddingLeft="5px",t},markTabActive:function(t){t.className+=" active"},markTabInactive:function(t){t.className=t.className.replace(/\s*active/g,"")},addTab:function(t,e){t.children[0].appendChild(e)}}),o.defaults.themes.foundation4=o.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var t=this._super();return t.style.fontSize=".6em",t},setGridColumnSize:function(t,e){t.className="columns large-"+e},getFormInputDescription:function(t){var e=this._super(t);return e.style.fontSize=".8rem",e},getFormInputLabel:function(t){var e=this._super(t);return e.style.fontWeight="bold",e}}),o.defaults.themes.foundation5=o.defaults.themes.foundation.extend({getFormInputDescription:function(t){var e=this._super(t);return e.style.fontSize=".8rem",e},setGridColumnSize:function(t,e){t.className="columns medium-"+e},getButton:function(t,e,i){var s=this._super(t,e,i);return s.className=s.className.replace(/\s*small/g,"")+" tiny",s},getTabHolder:function(){var t=document.createElement("div");return t.innerHTML="<dl class='tabs vertical'></dl><div class='tabs-content vertical'></div>",t},getTab:function(t){var e=document.createElement("dd"),i=document.createElement("a");return i.setAttribute("href","#"),i.appendChild(t),e.appendChild(i),e},getTabContentHolder:function(t){return t.children[1]},getTabContent:function(){var t=document.createElement("div");return t.className="content active",t.style.paddingLeft="5px",t},markTabActive:function(t){t.className+=" active"},markTabInactive:function(t){t.className=t.className.replace(/\s*active/g,"")},addTab:function(t,e){t.children[0].appendChild(e)}}),o.defaults.themes.foundation6=o.defaults.themes.foundation5.extend({getIndentedPanel:function(){var t=document.createElement("div");return t.className="callout secondary",t},getButtonHolder:function(){var t=document.createElement("div");return t.className="button-group tiny",t.style.marginBottom=0,t},getFormInputLabel:function(t){var e=this._super(t);return e.style.display="block",e},getFormControl:function(t,e,i,s){var n=document.createElement("div");return n.className="form-control",t&&n.appendChild(t),"checkbox"===e.type?t.insertBefore(e,t.firstChild):t?(s&&t.appendChild(s),t.appendChild(e)):(s&&n.appendChild(s),n.appendChild(e)),i&&t.appendChild(i),n},addInputError:function(t,e){if(t.group){if(t.group.className+=" error",t.errmsg)t.errmsg.style.display="",t.className="";else{var i=document.createElement("span");i.className="form-error is-visible",t.group.getElementsByTagName("label")[0].appendChild(i),t.className=t.className+" is-invalid-input",t.errmsg=i}t.errmsg.textContent=e}},removeInputError:function(t){t.errmsg&&(t.className=t.className.replace(/ is-invalid-input/g,""),t.errmsg.parentNode&&t.errmsg.parentNode.removeChild(t.errmsg))}}),o.defaults.themes.html=o.AbstractTheme.extend({getFormInputLabel:function(t){var e=this._super(t);return e.style.display="block",e.style.marginBottom="3px",e.style.fontWeight="bold",e},getFormInputDescription:function(t){var e=this._super(t);return e.style.fontSize=".8em",e.style.margin=0,e.style.display="inline-block",e.style.fontStyle="italic",e},getIndentedPanel:function(){var t=this._super();return t.style.border="1px solid #ddd",t.style.padding="5px",t.style.margin="5px",t.style.borderRadius="3px",t},getChildEditorHolder:function(){var t=this._super();return t.style.marginBottom="8px",t},getHeaderButtonHolder:function(){var t=this.getButtonHolder();return t.style.display="inline-block",t.style.marginLeft="10px",t.style.fontSize=".8em",t.style.verticalAlign="middle",t},getTable:function(){var t=this._super();return t.style.borderBottom="1px solid #ccc",t.style.marginBottom="5px",t},addInputError:function(t,e){if(t.style.borderColor="red",t.errmsg)t.errmsg.style.display="block";else{var i=this.closest(t,".form-control");t.errmsg=document.createElement("div"),t.errmsg.setAttribute("class","errmsg"),t.errmsg.style=t.errmsg.style||{},t.errmsg.style.color="red",i.appendChild(t.errmsg)}t.errmsg.innerHTML="",t.errmsg.appendChild(document.createTextNode(e))},removeInputError:function(t){t.style.borderColor="",t.errmsg&&(t.errmsg.style.display="none")},getProgressBar:function(){var t=document.createElement("progress");return t.setAttribute("max",100),t.setAttribute("value",0),t},updateProgressBar:function(t,e){t&&t.setAttribute("value",e)},updateProgressBarUnknown:function(t){t&&t.removeAttribute("value")}}),o.defaults.themes.jqueryui=o.AbstractTheme.extend({getTable:function(){var t=this._super();return t.setAttribute("cellpadding",5),t.setAttribute("cellspacing",0),t},getTableHeaderCell:function(t){var e=this._super(t);return e.className="ui-state-active",e.style.fontWeight="bold",e},getTableCell:function(){var t=this._super();return t.className="ui-widget-content",t},getHeaderButtonHolder:function(){var t=this.getButtonHolder();return t.style.marginLeft="10px",t.style.fontSize=".6em",t.style.display="inline-block",t},getFormInputDescription:function(t){var e=this.getDescription(t);return e.style.marginLeft="10px",e.style.display="inline-block",e},getFormControl:function(t,e,i,s){var n=this._super(t,e,i,s);return"checkbox"===e.type?(n.style.lineHeight="25px",n.style.padding="3px 0"):n.style.padding="4px 0 8px 0",n},getDescription:function(t){var e=document.createElement("span");return e.style.fontSize=".8em",e.style.fontStyle="italic",e.textContent=t,e},getButtonHolder:function(){var t=document.createElement("div");return t.className="ui-buttonset",t.style.fontSize=".7em",t},getFormInputLabel:function(t){var e=document.createElement("label");return e.style.fontWeight="bold",e.style.display="block",e.textContent=t,e},getButton:function(t,e,i){var s=document.createElement("button");s.className="ui-button ui-widget ui-state-default ui-corner-all",e&&!t?(s.className+=" ui-button-icon-only",e.className+=" ui-button-icon-primary ui-icon-primary",s.appendChild(e)):e?(s.className+=" ui-button-text-icon-primary",e.className+=" ui-button-icon-primary ui-icon-primary",s.appendChild(e)):s.className+=" ui-button-text-only";var n=document.createElement("span");return n.className="ui-button-text",n.textContent=t||i||".",s.appendChild(n),s.setAttribute("title",i),s},setButtonText:function(t,e,i,s){t.innerHTML="",t.className="ui-button ui-widget ui-state-default ui-corner-all",i&&!e?(t.className+=" ui-button-icon-only",i.className+=" ui-button-icon-primary ui-icon-primary",t.appendChild(i)):i?(t.className+=" ui-button-text-icon-primary",i.className+=" ui-button-icon-primary ui-icon-primary",t.appendChild(i)):t.className+=" ui-button-text-only";var n=document.createElement("span");n.className="ui-button-text",n.textContent=e||s||".",t.appendChild(n),t.setAttribute("title",s)},getIndentedPanel:function(){var t=document.createElement("div");return t.className="ui-widget-content ui-corner-all",t.style.padding="1em 1.4em",t.style.marginBottom="20px",t},afterInputReady:function(t){t.controls||(t.controls=this.closest(t,".form-control"))},addInputError:function(t,e){t.controls&&(t.errmsg?t.errmsg.style.display="":(t.errmsg=document.createElement("div"),t.errmsg.className="ui-state-error",t.controls.appendChild(t.errmsg)),t.errmsg.textContent=e)},removeInputError:function(t){t.errmsg&&(t.errmsg.style.display="none")},markTabActive:function(t){t.className=t.className.replace(/\s*ui-widget-header/g,"")+" ui-state-active"},markTabInactive:function(t){t.className=t.className.replace(/\s*ui-state-active/g,"")+" ui-widget-header"}}),o.defaults.themes.barebones=o.AbstractTheme.extend({getFormInputLabel:function(t){return this._super(t)},getFormInputDescription:function(t){return this._super(t)},getIndentedPanel:function(){return this._super()},getChildEditorHolder:function(){return this._super()},getHeaderButtonHolder:function(){return this.getButtonHolder()},getTable:function(){return this._super()},addInputError:function(t,e){if(t.errmsg)t.errmsg.style.display="block";else{var i=this.closest(t,".form-control");t.errmsg=document.createElement("div"),t.errmsg.setAttribute("class","errmsg"),i.appendChild(t.errmsg)}t.errmsg.innerHTML="",t.errmsg.appendChild(document.createTextNode(e))},removeInputError:function(t){t.style.borderColor="",t.errmsg&&(t.errmsg.style.display="none")},getProgressBar:function(){var t=document.createElement("progress");return t.setAttribute("max",100),t.setAttribute("value",0),t},updateProgressBar:function(t,e){t&&t.setAttribute("value",e)},updateProgressBarUnknown:function(t){t&&t.removeAttribute("value")}}),o.AbstractIconLib=t.extend({mapping:{collapse:"",expand:"",delete:"",edit:"",add:"",cancel:"",save:"",moveup:"",movedown:""},icon_prefix:"",getIconClass:function(t){return this.mapping[t]?this.icon_prefix+this.mapping[t]:null},getIcon:function(t){var e=this.getIconClass(t);if(!e)return null;var i=document.createElement("i");return i.className=e,i}}),o.defaults.iconlibs.bootstrap2=o.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-up",delete:"trash",edit:"pencil",add:"plus",cancel:"ban-circle",save:"ok",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"icon-"}),o.defaults.iconlibs.bootstrap3=o.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-right",delete:"remove",edit:"pencil",add:"plus",cancel:"floppy-remove",save:"floppy-saved",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"glyphicon glyphicon-"}),o.defaults.iconlibs.fontawesome3=o.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-right",delete:"remove",edit:"pencil",add:"plus",cancel:"ban-circle",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"icon-"}),o.defaults.iconlibs.fontawesome4=o.AbstractIconLib.extend({mapping:{collapse:"caret-square-o-down",expand:"caret-square-o-right",delete:"times",edit:"pencil",add:"plus",cancel:"ban",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"fa fa-"}),o.defaults.iconlibs.foundation2=o.AbstractIconLib.extend({mapping:{collapse:"minus",expand:"plus",delete:"remove",edit:"edit",add:"add-doc",cancel:"error",save:"checkmark",moveup:"up-arrow",movedown:"down-arrow"},icon_prefix:"foundicon-"}),o.defaults.iconlibs.foundation3=o.AbstractIconLib.extend({mapping:{collapse:"minus",expand:"plus",delete:"x",edit:"pencil",add:"page-add",cancel:"x-circle",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"fi-"}),o.defaults.iconlibs.jqueryui=o.AbstractIconLib.extend({mapping:{collapse:"triangle-1-s",expand:"triangle-1-e",delete:"trash",edit:"pencil",add:"plusthick",cancel:"closethick",save:"disk",moveup:"arrowthick-1-n",movedown:"arrowthick-1-s"},icon_prefix:"ui-icon ui-icon-"}),o.defaults.templates.default=function(){return{compile:function(t){var e=t.match(/{{\s*([a-zA-Z0-9\-_ \.]+)\s*}}/g),i=e&&e.length;if(!i)return function(){return t};for(var s=[],n=function(t){var i,n,r=e[t].replace(/[{}]+/g,"").trim().split("."),o=r.length;o>1?i=function(e){for(n=e,t=0;t<o&&(n=n[r[t]]);t++);return n}:(r=r[0],i=function(t){return t[r]});s.push({s:e[t],r:i})},r=0;r<i;r++)n(r);return function(e){var n,o=t+"";for(r=0;r<i;r++)n=s[r],o=o.replace(n.s,n.r(e));return o}}}},o.defaults.templates.ejs=function(){return!!window.EJS&&{compile:function(t){var e=new window.EJS({text:t});return function(t){return e.render(t)}}}},o.defaults.templates.handlebars=function(){return window.Handlebars},o.defaults.templates.hogan=function(){return!!window.Hogan&&{compile:function(t){var e=window.Hogan.compile(t);return function(t){return e.render(t)}}}},o.defaults.templates.markup=function(){return!(!window.Mark||!window.Mark.up)&&{compile:function(t){return function(e){return window.Mark.up(t,e)}}}},o.defaults.templates.mustache=function(){return!!window.Mustache&&{compile:function(t){return function(e){return window.Mustache.render(t,e)}}}},o.defaults.templates.swig=function(){return window.swig},o.defaults.templates.underscore=function(){return!!window._&&{compile:function(t){return function(e){return window._.template(t,e)}}}},o.defaults.theme="html",o.defaults.template="default",o.defaults.options={},o.defaults.translate=function(t,e){var i=o.defaults.languages[o.defaults.language];if(!i)throw"Unknown language "+o.defaults.language;var s=i[t]||o.defaults.languages[o.defaults.default_language][t];if(void 0===s)throw"Unknown translate string "+t;if(e)for(var n=0;n<e.length;n++)s=s.replace(new RegExp("\\{\\{"+n+"}}","g"),e[n]);return s},o.defaults.default_language="en",o.defaults.language=o.defaults.default_language,o.defaults.languages.en={error_notset:"Property must be set",error_notempty:"Value required",error_enum:"Value must be one of the enumerated values",error_anyOf:"Value must validate against at least one of the provided schemas",error_oneOf:"Value must validate against exactly one of the provided schemas. It currently validates against {{0}} of the schemas.",error_not:"Value must not validate against the provided schema",error_type_union:"Value must be one of the provided types",error_type:"Value must be of type {{0}}",error_disallow_union:"Value must not be one of the provided disallowed types",error_disallow:"Value must not be of type {{0}}",error_multipleOf:"Value must be a multiple of {{0}}",error_maximum_excl:"Value must be less than {{0}}",error_maximum_incl:"Value must be at most {{0}}",error_minimum_excl:"Value must be greater than {{0}}",error_minimum_incl:"Value must be at least {{0}}",error_maxLength:"Value must be at most {{0}} characters long",error_minLength:"Value must be at least {{0}} characters long",error_pattern:"Value must match the pattern {{0}}",error_additionalItems:"No additional items allowed in this array",error_maxItems:"Value must have at most {{0}} items",error_minItems:"Value must have at least {{0}} items",error_uniqueItems:"Array must have unique items",error_maxProperties:"Object must have at most {{0}} properties",error_minProperties:"Object must have at least {{0}} properties",error_required:"Object is missing the required property '{{0}}'",error_additional_properties:"No additional properties allowed, but property {{0}} is set",error_dependency:"Must have property {{0}}",button_delete_all:"All",button_delete_all_title:"Delete All",button_delete_last:"Last {{0}}",button_delete_last_title:"Delete Last {{0}}",button_add_row_title:"Add {{0}}",button_move_down_title:"Move down",button_move_up_title:"Move up",button_delete_row_title:"Delete {{0}}",button_delete_row_title_short:"Delete",button_collapse:"Collapse",button_expand:"Expand"},o.plugins={ace:{theme:""},epiceditor:{},sceditor:{},select2:{},selectize:{}},n(o.defaults.editors,function(t,e){o.defaults.editors[t].options=e.options||{}}),o.defaults.resolvers.unshift(function(t){if("string"!=typeof t.type)return"multiple"}),o.defaults.resolvers.unshift(function(t){if(!t.type&&t.properties)return"object"}),o.defaults.resolvers.unshift(function(t){if("string"==typeof t.type)return t.type}),o.defaults.resolvers.unshift(function(t){if("boolean"===t.type)return"checkbox"===t.format||t.options&&t.options.checkbox?"checkbox":o.plugins.selectize.enable?"selectize":"select"}),o.defaults.resolvers.unshift(function(t){if("any"===t.type)return"multiple"}),o.defaults.resolvers.unshift(function(t){if("string"===t.type&&t.media&&"base64"===t.media.binaryEncoding)return"base64"}),o.defaults.resolvers.unshift(function(t){if("string"===t.type&&"url"===t.format&&t.options&&!0===t.options.upload&&window.FileReader)return"upload"}),o.defaults.resolvers.unshift(function(t){if("array"==t.type&&"table"==t.format)return"table"}),o.defaults.resolvers.unshift(function(t){if(t.enumSource)return o.plugins.selectize.enable?"selectize":"select"}),o.defaults.resolvers.unshift(function(t){if(t.enum){if("array"===t.type||"object"===t.type)return"enum";if("number"===t.type||"integer"===t.type||"string"===t.type)return o.plugins.selectize.enable?"selectize":"select"}}),o.defaults.resolvers.unshift(function(t){if("array"===t.type&&t.items&&!Array.isArray(t.items)&&t.uniqueItems&&["string","number","integer"].indexOf(t.items.type)>=0){if(t.items.enum)return"multiselect";if(o.plugins.selectize.enable&&"string"===t.items.type)return"arraySelectize"}}),o.defaults.resolvers.unshift(function(t){if(t.oneOf||t.anyOf)return"multiple"}),function(){if(window.jQuery||window.Zepto){var t=window.jQuery||window.Zepto;t.jsoneditor=o.defaults,t.fn.jsoneditor=function(t){var e=this,i=this.data("jsoneditor");if("value"===t){if(!i)throw"Must initialize jsoneditor before getting/setting the value";if(!(arguments.length>1))return i.getValue();i.setValue(arguments[1])}else{if("validate"===t){if(!i)throw"Must initialize jsoneditor before validating";return arguments.length>1?i.validate(arguments[1]):i.validate()}"destroy"===t?i&&(i.destroy(),this.data("jsoneditor",null)):(i&&i.destroy(),i=new o(this.get(0),t),this.data("jsoneditor",i),i.on("change",function(){e.trigger("change")}),i.on("ready",function(){e.trigger("ready")}))}return this}}}(),window.JSONEditor=o}();var jsonlint=function(){var t,e,i,s={},n=(e={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,i,s,n,r,o){var a=r.length-1;switch(n){case 1:this.$=t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(t);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=r[a-1];case 13:this.$={};break;case 14:this.$=r[a-1];break;case 15:this.$=[r[a-2],r[a]];break;case 16:this.$={},this.$[r[a][0]]=r[a][1];break;case 17:this.$=r[a-2],r[a-2][r[a][0]]=r[a][1];break;case 18:this.$=[];break;case 19:this.$=r[a-1];break;case 20:this.$=[r[a]];break;case 21:this.$=r[a-2],r[a-2].push(r[a])}},table:[{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],12:1,13:2,15:7,16:8,17:[1,14],23:[1,15]},{1:[3]},{14:[1,16]},{14:[2,7],18:[2,7],22:[2,7],24:[2,7]},{14:[2,8],18:[2,8],22:[2,8],24:[2,8]},{14:[2,9],18:[2,9],22:[2,9],24:[2,9]},{14:[2,10],18:[2,10],22:[2,10],24:[2,10]},{14:[2,11],18:[2,11],22:[2,11],24:[2,11]},{14:[2,12],18:[2,12],22:[2,12],24:[2,12]},{14:[2,3],18:[2,3],22:[2,3],24:[2,3]},{14:[2,4],18:[2,4],22:[2,4],24:[2,4]},{14:[2,5],18:[2,5],22:[2,5],24:[2,5]},{14:[2,1],18:[2,1],21:[2,1],22:[2,1],24:[2,1]},{14:[2,2],18:[2,2],22:[2,2],24:[2,2]},{3:20,4:[1,12],18:[1,17],19:18,20:19},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:23,15:7,16:8,17:[1,14],23:[1,15],24:[1,21],25:22},{1:[2,6]},{14:[2,13],18:[2,13],22:[2,13],24:[2,13]},{18:[1,24],22:[1,25]},{18:[2,16],22:[2,16]},{21:[1,26]},{14:[2,18],18:[2,18],22:[2,18],24:[2,18]},{22:[1,28],24:[1,27]},{22:[2,20],24:[2,20]},{14:[2,14],18:[2,14],22:[2,14],24:[2,14]},{3:20,4:[1,12],20:29},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:30,15:7,16:8,17:[1,14],23:[1,15]},{14:[2,19],18:[2,19],22:[2,19],24:[2,19]},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:31,15:7,16:8,17:[1,14],23:[1,15]},{18:[2,17],22:[2,17]},{18:[2,15],22:[2,15]},{22:[2,21],24:[2,21]}],defaultActions:{16:[2,6]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return"number"!=typeof(t=i.lexer.lex()||1)&&(t=i.symbols_[t]||t),t}var i=this,s=[0],n=[null],r=[],o=this.table,a="",l=0,h=0,d=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;r.push(u),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var c,p,f,m,g,v,y,_,b,w,x={};;){if(f=s[s.length-1],this.defaultActions[f]?m=this.defaultActions[f]:(null==c&&(c=e()),m=o[f]&&o[f][c]),void 0===m||!m.length||!m[0]){if(!d){b=[];for(v in o[f])this.terminals_[v]&&v>2&&b.push("'"+this.terminals_[v]+"'");var C="";C=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+b.join(", ")+", got '"+this.terminals_[c]+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==c?"end of input":"'"+(this.terminals_[c]||c)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[c]||c,line:this.lexer.yylineno,loc:u,expected:b})}if(3==d){if(1==c)throw new Error(C||"Parsing halted.");h=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,u=this.lexer.yylloc,c=e()}for(;!(2..toString()in o[f]);){if(0==f)throw new Error(C||"Parsing halted.");w=1,s.length=s.length-2*w,n.length=n.length-w,r.length=r.length-w,f=s[s.length-1]}p=c,c=2,m=o[f=s[s.length-1]]&&o[f][2],d=3}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+c);switch(m[0]){case 1:s.push(c),n.push(this.lexer.yytext),r.push(this.lexer.yylloc),s.push(m[1]),c=null,p?(c=p,p=null):(h=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,u=this.lexer.yylloc,d>0&&d--);break;case 2:if(y=this.productions_[m[1]][1],x.$=n[n.length-y],x._$={first_line:r[r.length-(y||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(y||1)].first_column,last_column:r[r.length-1].last_column},void 0!==(g=this.performAction.call(x,a,h,l,this.yy,m[1],n,r)))return g;y&&(s=s.slice(0,-1*y*2),n=n.slice(0,-1*y),r=r.slice(0,-1*y)),s.push(this.productions_[m[1]][0]),n.push(x.$),r.push(x._$),_=o[s[s.length-2]][s[s.length-1]],s.push(_);break;case 3:return!0}}return!0}},(t={EOF:1,parseError:function(t,e){if(!this.yy.parseError)throw new Error(t);this.yy.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.match+=t,this.matched+=t,t.match(/\n/)&&this.yylineno++,this._input=this._input.slice(1),t},unput:function(t){return this._input=t+this._input,this},more:function(){return this._more=!0,this},less:function(t){this._input=this.match.slice(t)+this._input},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;var t,e,i,s,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),o=0;o<r.length&&(!(i=this._input.match(this.rules[r[o]]))||e&&!(i[0].length>e[0].length)||(e=i,s=o,this.options.flex));o++);return e?((n=e[0].match(/\n.*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-1:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,r[s],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:void this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}}).options={},t.performAction=function(t,e,i,s){switch(i){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},t.rules=[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],t.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}},i=t,e.lexer=i,e);return void 0!==s&&(s.parser=n,s.parse=function(){return n.parse.apply(n,arguments)},s.main=function(t){if(!t[1])throw new Error("Usage: "+t[0]+" FILE");if("undefined"!=typeof process)var e=(!0)("fs").readFileSync((!0)("path").join(process.cwd(),t[1]),"utf8");else{var i=(!0)("file").path((!0)("file").cwd());e=i.join(t[1]).read({charset:"utf-8"})}return s.parser.parse(e)},!1===(!0).main&&s.main("undefined"!=typeof process?process.argv.slice(1):(!0)("system").args)),s}();!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){var e="CodeMirror-lint-markers";function i(t){t.parentNode&&t.parentNode.removeChild(t)}function s(e,s,n){var r=function(e,i){var s=document.createElement("div");function n(e){if(!s.parentNode)return t.off(document,"mousemove",n);s.style.top=Math.max(0,e.clientY-s.offsetHeight-5)+"px",s.style.left=e.clientX+5+"px"}return s.className="CodeMirror-lint-tooltip",s.appendChild(i.cloneNode(!0)),document.body.appendChild(s),t.on(document,"mousemove",n),n(e),null!=s.style.opacity&&(s.style.opacity=1),s}(e,s);function o(){var e;t.off(n,"mouseout",o),r&&((e=r).parentNode&&(null==e.style.opacity&&i(e),e.style.opacity=0,setTimeout(function(){i(e)},600)),r=null)}var a=setInterval(function(){if(r)for(var t=n;;t=t.parentNode){if(t&&11==t.nodeType&&(t=t.host),t==document.body)return;if(!t){o();break}}if(!r)return clearInterval(a)},400);t.on(n,"mouseout",o)}function n(t,e,i){this.marked=[],this.options=e,this.timeout=null,this.hasGutter=i,this.onMouseOver=function(e){!function(t,e){var i=e.target||e.srcElement;if(!/\bCodeMirror-lint-mark-/.test(i.className))return;for(var n=i.getBoundingClientRect(),r=(n.left+n.right)/2,o=(n.top+n.bottom)/2,l=t.findMarksAt(t.coordsChar({left:r,top:o},"client")),h=[],d=0;d<l.length;++d){var u=l[d].__annotation;u&&h.push(u)}h.length&&function(t,e){for(var i=e.target||e.srcElement,n=document.createDocumentFragment(),r=0;r<t.length;r++){var o=t[r];n.appendChild(a(o))}s(e,n,i)}(h,e)}(t,e)},this.waitingFor=0}function r(t){var i=t.state.lint;i.hasGutter&&t.clearGutter(e);for(var s=0;s<i.marked.length;++s)i.marked[s].clear();i.marked.length=0}function o(e,i,n,r){var o=document.createElement("div"),a=o;return o.className="CodeMirror-lint-marker-"+i,n&&((a=o.appendChild(document.createElement("div"))).className="CodeMirror-lint-marker-multiple"),0!=r&&t.on(a,"mouseover",function(t){s(t,e,a)}),o}function a(t){var e=t.severity;e||(e="error");var i=document.createElement("div");return i.className="CodeMirror-lint-message-"+e,i.appendChild(document.createTextNode(t.message)),i}function l(e){var i=e.state.lint.options,s=i.options||i,n=i.getAnnotations||e.getHelper(t.Pos(0,0),"lint");n&&(i.async||n.async?function(e,i,s){var n=e.state.lint,r=++n.waitingFor;function o(){r=-1,e.off("change",o)}e.on("change",o),i(e.getValue(),function(i,s){e.off("change",o),n.waitingFor==r&&(s&&i instanceof t&&(i=s),h(e,i))},s,e)}(e,n,s):h(e,n(e.getValue(),s,e)))}function h(t,i){r(t);for(var s,n=t.state.lint,l=n.options,h=function(t){for(var e=[],i=0;i<t.length;++i){var s=t[i],n=s.from.line;(e[n]||(e[n]=[])).push(s)}return e}(i),d=0;d<h.length;++d){var u=h[d];if(u){for(var c=null,p=n.hasGutter&&document.createDocumentFragment(),f=0;f<u.length;++f){var m=u[f],g=m.severity;g||(g="error"),c="error"==(s=c)?s:g,l.formatAnnotation&&(m=l.formatAnnotation(m)),n.hasGutter&&p.appendChild(a(m)),m.to&&n.marked.push(t.markText(m.from,m.to,{className:"CodeMirror-lint-mark-"+g,__annotation:m}))}n.hasGutter&&t.setGutterMarker(d,e,o(p,c,u.length>1,n.options.tooltips))}}l.onUpdateLinting&&l.onUpdateLinting(i,h,t)}function d(t){var e=t.state.lint;e&&(clearTimeout(e.timeout),e.timeout=setTimeout(function(){l(t)},e.options.delay||500))}t.defineOption("lint",!1,function(i,s,o){if(o&&o!=t.Init&&(r(i),!1!==i.state.lint.options.lintOnChange&&i.off("change",d),t.off(i.getWrapperElement(),"mouseover",i.state.lint.onMouseOver),clearTimeout(i.state.lint.timeout),delete i.state.lint),s){for(var a=i.getOption("gutters"),h=!1,u=0;u<a.length;++u)a[u]==e&&(h=!0);var c=i.state.lint=new n(i,(p=s)instanceof Function?{getAnnotations:p}:(p&&!0!==p||(p={}),p),h);!1!==c.options.lintOnChange&&i.on("change",d),0!=c.options.tooltips&&t.on(i.getWrapperElement(),"mouseover",c.onMouseOver),l(i)}var p}),t.defineExtension("performLint",function(){this.state.lint&&l(this)})}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){var e=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),i=t.Pos,s={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function n(t,e,n,o){var a=t.getLineHandle(e.line),l=e.ch-1,h=l>=0&&s[a.text.charAt(l)]||s[a.text.charAt(++l)];if(!h)return null;var d=">"==h.charAt(1)?1:-1;if(n&&d>0!=(l==e.ch))return null;var u=t.getTokenTypeAt(i(e.line,l+1)),c=r(t,i(e.line,l+(d>0?1:0)),d,u||null,o);return null==c?null:{from:i(e.line,l),to:c&&c.pos,match:c&&c.ch==h.charAt(0),forward:d>0}}function r(t,e,n,r,o){for(var a=o&&o.maxScanLineLength||1e4,l=o&&o.maxScanLines||1e3,h=[],d=o&&o.bracketRegex?o.bracketRegex:/[(){}[\]]/,u=n>0?Math.min(e.line+l,t.lastLine()+1):Math.max(t.firstLine()-1,e.line-l),c=e.line;c!=u;c+=n){var p=t.getLine(c);if(p){var f=n>0?0:p.length-1,m=n>0?p.length:-1;if(!(p.length>a))for(c==e.line&&(f=e.ch-(n<0?1:0));f!=m;f+=n){var g=p.charAt(f);if(d.test(g)&&(void 0===r||t.getTokenTypeAt(i(c,f+1))==r))if(">"==s[g].charAt(1)==n>0)h.push(g);else{if(!h.length)return{pos:i(c,f),ch:g};h.pop()}}}}return c-n!=(n>0?t.lastLine():t.firstLine())&&null}function o(t,s,r){for(var o=t.state.matchBrackets.maxHighlightLineLength||1e3,a=[],l=t.listSelections(),h=0;h<l.length;h++){var d=l[h].empty()&&n(t,l[h].head,!1,r);if(d&&t.getLine(d.from.line).length<=o){var u=d.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";a.push(t.markText(d.from,i(d.from.line,d.from.ch+1),{className:u})),d.to&&t.getLine(d.to.line).length<=o&&a.push(t.markText(d.to,i(d.to.line,d.to.ch+1),{className:u}))}}if(a.length){e&&t.state.focused&&t.focus();var c=function(){t.operation(function(){for(var t=0;t<a.length;t++)a[t].clear()})};if(!s)return c;setTimeout(c,800)}}var a=null;function l(t){t.operation(function(){a&&(a(),a=null),a=o(t,!1,t.state.matchBrackets)})}t.defineOption("matchBrackets",!1,function(e,i,s){s&&s!=t.Init&&e.off("cursorActivity",l),i&&(e.state.matchBrackets="object"==typeof i?i:{},e.on("cursorActivity",l))}),t.defineExtension("matchBrackets",function(){o(this,!0)}),t.defineExtension("findMatchingBracket",function(t,e,i){return n(this,t,e,i)}),t.defineExtension("scanForBracket",function(t,e,i,s){return r(this,t,e,i,s)})}),function(t,e){"function"==typeof define&&define.amd?define("jQuery.extendext",["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(t){t.extendext=function(){var e,i,s,n,r,o,a=arguments[0]||{},l=1,h=arguments.length,d=!1,u="default";for("boolean"==typeof a&&(d=a,a=arguments[l++]||{}),"string"==typeof a&&("concat"!==(u=a.toLowerCase())&&"replace"!==u&&"extend"!==u&&(u="default"),a=arguments[l++]||{}),"object"==typeof a||t.isFunction(a)||(a={}),l===h&&(a=this,l--);l<h;l++)if(null!==(e=arguments[l]))if(t.isArray(e)&&"default"!==u)switch(o=a&&t.isArray(a)?a:[],u){case"concat":a=o.concat(t.extend(d,[],e));break;case"replace":a=t.extend(d,[],e);break;case"extend":e.forEach(function(e,i){if("object"==typeof e){var s=t.isArray(e)?[]:{};o[i]=t.extendext(d,u,o[i]||s,e)}else-1===o.indexOf(e)&&o.push(e)}),a=o}else for(i in e)s=a[i],n=e[i],a!==n&&(d&&n&&(t.isPlainObject(n)||(r=t.isArray(n)))?(r?(r=!1,o=s&&t.isArray(s)?s:[]):o=s&&t.isPlainObject(s)?s:{},a[i]=t.extendext(d,u,o,n)):void 0!==n&&(a[i]=n));return a}}),function(){function t(t){return t.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var e,i={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};i.encodeHTMLSource=function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}},e=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=i:"function"==typeof define&&define.amd?define("doT",function(){return i}):e.doT=i;var s={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},n=/$^/;i.template=function(r,o,a){var l,h,d=(o=o||i.templateSettings).append?s.append:s.split,u=0,c=o.use||o.define?function t(e,i,s){return("string"==typeof i?i:i.toString()).replace(e.define||n,function(t,i,n,r){return 0===i.indexOf("def.")&&(i=i.substring(4)),i in s||(":"===n?(e.defineParams&&r.replace(e.defineParams,function(t,e,n){s[i]={arg:e,text:n}}),i in s||(s[i]=r)):new Function("def","def['"+i+"']="+r)(s)),""}).replace(e.use||n,function(i,n){e.useParams&&(n=n.replace(e.useParams,function(t,e,i,n){if(s[i]&&s[i].arg&&n){var r=(i+":"+n).replace(/'|\\/g,"_");return s.__exp=s.__exp||{},s.__exp[r]=s[i].text.replace(new RegExp("(^|[^\\w$])"+s[i].arg+"([^\\w$])","g"),"$1"+n+"$2"),e+"def.__exp['"+r+"']"}}));var r=new Function("def","return "+n)(s);return r?t(e,r,s):r})}(o,r,a||{}):r;c=("var out='"+(o.strip?c.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):c).replace(/'|\\/g,"\\$&").replace(o.interpolate||n,function(e,i){return d.start+t(i)+d.end}).replace(o.encode||n,function(e,i){return l=!0,d.startencode+t(i)+d.end}).replace(o.conditional||n,function(e,i,s){return i?s?"';}else if("+t(s)+"){out+='":"';}else{out+='":s?"';if("+t(s)+"){out+='":"';}out+='"}).replace(o.iterate||n,function(e,i,s,n){return i?(u+=1,h=n||"i"+u,i=t(i),"';var arr"+u+"="+i+";if(arr"+u+"){var "+s+","+h+"=-1,l"+u+"=arr"+u+".length-1;while("+h+"<l"+u+"){"+s+"=arr"+u+"["+h+"+=1];out+='"):"';} } out+='"}).replace(o.evaluate||n,function(e,i){return"';"+t(i)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),l&&(o.selfcontained||!e||e._encodeHTML||(e._encodeHTML=i.encodeHTMLSource(o.doNotSkipEncoded)),c="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+i.encodeHTMLSource.toString()+"("+(o.doNotSkipEncoded||"")+"));"+c);try{return new Function(o.varname,c)}catch(t){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+c),t}},i.compile=function(t,e){return i.template(t,null,e)}}(),function(t,e){"function"==typeof define&&define.amd?define("query-builder",["jquery","dot/doT","jquery-extendext"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery"),require("dot/doT"),require("jquery-extendext")):e(t.jQuery,t.doT)}(this,function(t,e){function i(){this.root=null,this.$=t(this)}function s(t){for(var e=Object.keys(t),i=0,s=e.length;i<s;i++)if("$or"==e[i].toLowerCase()||"$and"==e[i].toLowerCase())return e[i]}function n(t,e,i){var s,n,r=o.selectors;(s=e.closest(r.rule_container)).length&&(n="moveAfter"),n||(s=e.closest(r.group_header)).length&&(s=e.closest(r.group_container),n="moveAtBegin"),n||(s=e.closest(r.group_container)).length&&(n="moveAtEnd"),n&&(t[n](i.getModel(s)),i&&t instanceof d&&i.setRuleInputValue(t,t.value))}function r(t){var e=t.match(/(question_mark|numbered|named)(?:\((.)\))?/);return e||(e=[null,"question_mark",void 0]),e}var o=function(s,n){s[0].queryBuilder=this,this.$el=s,this.settings=t.extendext(!0,"replace",{},o.DEFAULTS,n),this.model=new i,this.status={id:null,generated_id:!1,group_id:0,rule_id:0,has_optgroup:!1,has_operator_optgroup:!1},this.filters=this.settings.filters,this.icons=this.settings.icons,this.operators=this.settings.operators,this.templates=this.settings.templates,this.plugins=this.settings.plugins,this.lang=null,void 0===o.regional.en&&a.error("Config",'"i18n/en.js" not loaded.'),this.lang=t.extendext(!0,"replace",{},o.regional.en,o.regional[this.settings.lang_code],this.settings.lang),!1===this.settings.allow_groups?this.settings.allow_groups=0:!0===this.settings.allow_groups&&(this.settings.allow_groups=-1),Object.keys(this.templates).forEach(function(t){this.templates[t]||(this.templates[t]=o.templates[t]),"string"==typeof this.templates[t]&&(this.templates[t]=e.template(this.templates[t]))},this),this.$el.attr("id")||(this.$el.attr("id","qb_"+Math.floor(99999*Math.random())),this.status.generated_id=!0),this.status.id=this.$el.attr("id"),this.$el.addClass("query-builder form-inline"),this.filters=this.checkFilters(this.filters),this.operators=this.checkOperators(this.operators),this.bindEvents(),this.initPlugins()};t.extend(o.prototype,{trigger:function(e){var i=new t.Event(this._tojQueryEvent(e),{builder:this});return this.$el.triggerHandler(i,Array.prototype.slice.call(arguments,1)),i},change:function(e,i){var s=new t.Event(this._tojQueryEvent(e,!0),{builder:this,value:i});return this.$el.triggerHandler(s,Array.prototype.slice.call(arguments,2)),s.value},on:function(t,e){return this.$el.on(this._tojQueryEvent(t),e),this},off:function(t,e){return this.$el.off(this._tojQueryEvent(t),e),this},once:function(t,e){return this.$el.one(this._tojQueryEvent(t),e),this},_tojQueryEvent:function(t,e){return t.split(" ").map(function(t){return t+".queryBuilder"+(e?".filter":"")}).join(" ")}}),o.types={string:"string",integer:"number",double:"number",date:"datetime",time:"datetime",datetime:"datetime",boolean:"boolean"},o.inputs=["text","number","textarea","radio","checkbox","select"],o.modifiable_options=["display_errors","allow_groups","allow_empty","default_condition","default_filter"],o.selectors={group_container:".rules-group-container",rule_container:".rule-container",filter_container:".rule-filter-container",operator_container:".rule-operator-container",value_container:".rule-value-container",error_container:".error-container",condition_container:".rules-group-header .group-conditions",rule_header:".rule-header",group_header:".rules-group-header",group_actions:".group-actions",rule_actions:".rule-actions",rules_list:".rules-group-body>.rules-list",group_condition:".rules-group-header [name$=_cond]",rule_filter:".rule-filter-container [name$=_filter]",rule_operator:".rule-operator-container [name$=_operator]",rule_value:".rule-value-container [name*=_value_]",add_rule:"[data-add=rule]",delete_rule:"[data-delete=rule]",add_group:"[data-add=group]",delete_group:"[data-delete=group]"},o.templates={},o.regional={},o.OPERATORS={equal:{type:"equal",nb_inputs:1,multiple:!1,apply_to:["string","number","datetime","boolean"]},not_equal:{type:"not_equal",nb_inputs:1,multiple:!1,apply_to:["string","number","datetime","boolean"]},in:{type:"in",nb_inputs:1,multiple:!0,apply_to:["string","number","datetime"]},not_in:{type:"not_in",nb_inputs:1,multiple:!0,apply_to:["string","number","datetime"]},less:{type:"less",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},less_or_equal:{type:"less_or_equal",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},greater:{type:"greater",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},greater_or_equal:{type:"greater_or_equal",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},between:{type:"between",nb_inputs:2,multiple:!1,apply_to:["number","datetime"]},not_between:{type:"not_between",nb_inputs:2,multiple:!1,apply_to:["number","datetime"]},begins_with:{type:"begins_with",nb_inputs:1,multiple:!1,apply_to:["string"]},not_begins_with:{type:"not_begins_with",nb_inputs:1,multiple:!1,apply_to:["string"]},contains:{type:"contains",nb_inputs:1,multiple:!1,apply_to:["string"]},not_contains:{type:"not_contains",nb_inputs:1,multiple:!1,apply_to:["string"]},ends_with:{type:"ends_with",nb_inputs:1,multiple:!1,apply_to:["string"]},not_ends_with:{type:"not_ends_with",nb_inputs:1,multiple:!1,apply_to:["string"]},is_empty:{type:"is_empty",nb_inputs:0,multiple:!1,apply_to:["string"]},is_not_empty:{type:"is_not_empty",nb_inputs:0,multiple:!1,apply_to:["string"]},is_null:{type:"is_null",nb_inputs:0,multiple:!1,apply_to:["string","number","datetime","boolean"]},is_not_null:{type:"is_not_null",nb_inputs:0,multiple:!1,apply_to:["string","number","datetime","boolean"]}},o.DEFAULTS={filters:[],plugins:[],sort_filters:!1,display_errors:!0,allow_groups:-1,allow_empty:!1,conditions:["AND","OR"],default_condition:"AND",inputs_separator:" , ",select_placeholder:"------",display_empty_filter:!0,default_filter:null,optgroups:{},default_rule_flags:{filter_readonly:!1,operator_readonly:!1,value_readonly:!1,no_delete:!1},default_group_flags:{condition_readonly:!1,no_add_rule:!1,no_add_group:!1,no_delete:!1},templates:{group:null,rule:null,filterSelect:null,operatorSelect:null},lang_code:"en",lang:{},operators:["equal","not_equal","in","not_in","less","less_or_equal","greater","greater_or_equal","between","not_between","begins_with","not_begins_with","contains","not_contains","ends_with","not_ends_with","is_empty","is_not_empty","is_null","is_not_null"],icons:{add_group:"glyphicon glyphicon-plus-sign",add_rule:"glyphicon glyphicon-plus",remove_group:"glyphicon glyphicon-remove",remove_rule:"glyphicon glyphicon-remove",error:"glyphicon glyphicon-warning-sign"}},o.plugins={},o.defaults=function(e){return"object"!=typeof e?"string"==typeof e?"object"==typeof o.DEFAULTS[e]?t.extend(!0,{},o.DEFAULTS[e]):o.DEFAULTS[e]:t.extend(!0,{},o.DEFAULTS):void t.extendext(!0,"replace",o.DEFAULTS,e)},o.define=function(t,e,i){o.plugins[t]={fct:e,def:i||{}}},o.extend=function(e){t.extend(o.prototype,e)},o.prototype.initPlugins=function(){if(this.plugins){if(t.isArray(this.plugins)){var e={};this.plugins.forEach(function(t){e[t]=null}),this.plugins=e}Object.keys(this.plugins).forEach(function(e){e in o.plugins?(this.plugins[e]=t.extend(!0,{},o.plugins[e].def,this.plugins[e]||{}),o.plugins[e].fct.call(this,this.plugins[e])):a.error("Config",'Unable to find plugin "{0}"',e)},this)}},o.prototype.getPluginOptions=function(t,e){var i;return this.plugins&&this.plugins[t]?i=this.plugins[t]:o.plugins[t]&&(i=o.plugins[t].def),i?e?i[e]:i:void a.error("Config",'Unable to find plugin "{0}"',t)},o.prototype.init=function(t){this.trigger("afterInit"),t?(this.setRules(t),delete this.settings.rules):this.setRoot(!0)},o.prototype.checkFilters=function(t){var e=[];if(t&&0!==t.length||a.error("Config","Missing filters list"),t.forEach(function(t,i){switch(t.id||a.error("Config","Missing filter {0} id",i),-1!=e.indexOf(t.id)&&a.error("Config",'Filter "{0}" already defined',t.id),e.push(t.id),t.type?o.types[t.type]||a.error("Config",'Invalid type "{0}"',t.type):t.type="string",t.input?"function"!=typeof t.input&&-1==o.inputs.indexOf(t.input)&&a.error("Config",'Invalid input "{0}"',t.input):t.input="number"===o.types[t.type]?"number":"text",t.operators&&t.operators.forEach(function(t){"string"!=typeof t&&a.error("Config","Filter operators must be global operators types (string)")}),t.field||(t.field=t.id),t.label||(t.label=t.field),t.optgroup?(this.status.has_optgroup=!0,this.settings.optgroups[t.optgroup]||(this.settings.optgroups[t.optgroup]=t.optgroup)):t.optgroup=null,t.input){case"radio":case"checkbox":(!t.values||t.values.length<1)&&a.error("Config",'Missing filter "{0}" values',t.id);break;case"select":t.placeholder&&(void 0===t.placeholder_value&&(t.placeholder_value=-1),a.iterateOptions(t.values,function(e){e==t.placeholder_value&&a.error("Config",'Placeholder of filter "{0}" overlaps with one of its values',t.id)}))}},this),this.settings.sort_filters)if("function"==typeof this.settings.sort_filters)t.sort(this.settings.sort_filters);else{var i=this;t.sort(function(t,e){return i.translate(t.label).localeCompare(i.translate(e.label))})}return this.status.has_optgroup&&(t=a.groupSort(t,"optgroup")),t},o.prototype.checkOperators=function(e){var i=[];return e.forEach(function(s,n){"string"==typeof s?(o.OPERATORS[s]||a.error("Config",'Unknown operator "{0}"',s),e[n]=s=t.extendext(!0,"replace",{},o.OPERATORS[s])):(s.type||a.error("Config",'Missing "type" for operator {0}',n),o.OPERATORS[s.type]&&(e[n]=s=t.extendext(!0,"replace",{},o.OPERATORS[s.type],s)),void 0!==s.nb_inputs&&void 0!==s.apply_to||a.error("Config",'Missing "nb_inputs" and/or "apply_to" for operator "{0}"',s.type)),-1!=i.indexOf(s.type)&&a.error("Config",'Operator "{0}" already defined',s.type),i.push(s.type),s.optgroup?(this.status.has_operator_optgroup=!0,this.settings.optgroups[s.optgroup]||(this.settings.optgroups[s.optgroup]=s.optgroup)):s.optgroup=null},this),this.status.has_operator_optgroup&&(e=a.groupSort(e,"optgroup")),e},o.prototype.bindEvents=function(){var e=this,i=o.selectors;this.$el.on("change.queryBuilder",i.group_condition,function(){if(t(this).is(":checked")){var s=t(this).closest(i.group_container);e.getModel(s).condition=t(this).val()}}),this.$el.on("change.queryBuilder",i.rule_filter,function(){var s=t(this).closest(i.rule_container);e.getModel(s).filter=e.getFilterById(t(this).val())}),this.$el.on("change.queryBuilder",i.rule_operator,function(){var s=t(this).closest(i.rule_container);e.getModel(s).operator=e.getOperatorByType(t(this).val())}),this.$el.on("click.queryBuilder",i.add_rule,function(){var s=t(this).closest(i.group_container);e.addRule(e.getModel(s))}),this.$el.on("click.queryBuilder",i.delete_rule,function(){var s=t(this).closest(i.rule_container);e.deleteRule(e.getModel(s))}),0!==this.settings.allow_groups&&(this.$el.on("click.queryBuilder",i.add_group,function(){var s=t(this).closest(i.group_container);e.addGroup(e.getModel(s))}),this.$el.on("click.queryBuilder",i.delete_group,function(){var s=t(this).closest(i.group_container);e.deleteGroup(e.getModel(s))})),this.model.on({drop:function(t,i){i.$el.remove(),e.refreshGroupsConditions()},add:function(t,i,s,n){0===n?s.$el.prependTo(i.$el.find(">"+o.selectors.rules_list)):s.$el.insertAfter(i.rules[n-1].$el),e.refreshGroupsConditions()},move:function(t,i,s,n){i.$el.detach(),0===n?i.$el.prependTo(s.$el.find(">"+o.selectors.rules_list)):i.$el.insertAfter(s.rules[n-1].$el),e.refreshGroupsConditions()},update:function(t,i,s,n,r){if(i instanceof d)switch(s){case"error":e.updateError(i);break;case"flags":e.applyRuleFlags(i);break;case"filter":e.updateRuleFilter(i,r);break;case"operator":e.updateRuleOperator(i,r);break;case"value":e.updateRuleValue(i,r)}else switch(s){case"error":e.updateError(i);break;case"flags":e.applyGroupFlags(i);break;case"condition":e.updateGroupCondition(i,r)}}})},o.prototype.setRoot=function(e,i,s){e=void 0===e||!0===e;var n=this.nextGroupId(),r=t(this.getGroupTemplate(n,1));return this.$el.append(r),this.model.root=new h(null,r),this.model.root.model=this.model,this.model.root.data=i,this.model.root.__.flags=t.extend({},this.settings.default_group_flags,s),this.trigger("afterAddGroup",this.model.root),this.model.root.condition=this.settings.default_condition,e&&this.addRule(this.model.root),this.model.root},o.prototype.addGroup=function(e,i,s,n){i=void 0===i||!0===i;var r=e.level+1;if(this.trigger("beforeAddGroup",e,i,r).isDefaultPrevented())return null;var o=this.nextGroupId(),a=t(this.getGroupTemplate(o,r)),l=e.addGroup(a);return l.data=s,l.__.flags=t.extend({},this.settings.default_group_flags,n),this.trigger("afterAddGroup",l),this.trigger("rulesChanged"),l.condition=this.settings.default_condition,i&&this.addRule(l),l},o.prototype.deleteGroup=function(t){if(t.isRoot())return!1;if(this.trigger("beforeDeleteGroup",t).isDefaultPrevented())return!1;var e=!0;return t.each("reverse",function(t){e&=this.deleteRule(t)},function(t){e&=this.deleteGroup(t)},this),e&&(t.drop(),this.trigger("afterDeleteGroup"),this.trigger("rulesChanged")),e},o.prototype.updateGroupCondition=function(e,i){e.$el.find(">"+o.selectors.group_condition).each(function(){var i=t(this);i.prop("checked",i.val()===e.condition),i.parent().toggleClass("active",i.val()===e.condition)}),this.trigger("afterUpdateGroupCondition",e,i),this.trigger("rulesChanged")},o.prototype.refreshGroupsConditions=function(){!function t(e){(!e.flags||e.flags&&!e.flags.condition_readonly)&&e.$el.find(">"+o.selectors.group_condition).prop("disabled",e.rules.length<=1).parent().toggleClass("disabled",e.rules.length<=1),e.each(null,function(e){t(e)},this)}(this.model.root)},o.prototype.addRule=function(e,i,s){if(this.trigger("beforeAddRule",e).isDefaultPrevented())return null;var n=this.nextRuleId(),r=t(this.getRuleTemplate(n)),o=e.addRule(r);return void 0!==i&&(o.data=i),o.__.flags=t.extend({},this.settings.default_rule_flags,s),this.trigger("afterAddRule",o),this.trigger("rulesChanged"),this.createRuleFilters(o),!this.settings.default_filter&&this.settings.display_empty_filter||(o.filter=this.change("getDefaultFilter",this.getFilterById(this.settings.default_filter||this.filters[0].id),o)),o},o.prototype.deleteRule=function(t){return!t.flags.no_delete&&(!this.trigger("beforeDeleteRule",t).isDefaultPrevented()&&(t.drop(),this.trigger("afterDeleteRule"),this.trigger("rulesChanged"),!0))},o.prototype.createRuleFilters=function(e){var i=this.change("getRuleFilters",this.filters,e),s=t(this.getRuleFilterSelect(e,i));e.$el.find(o.selectors.filter_container).html(s),this.trigger("afterCreateRuleFilters",e)},o.prototype.createRuleOperators=function(e){var i=e.$el.find(o.selectors.operator_container).empty();if(e.filter){var s=this.getOperators(e.filter),n=t(this.getRuleOperatorSelect(e,s));i.html(n),e.filter.default_operator?e.__.operator=this.getOperatorByType(e.filter.default_operator):e.__.operator=s[0],e.$el.find(o.selectors.rule_operator).val(e.operator.type),this.trigger("afterCreateRuleOperators",e,s)}},o.prototype.createRuleInput=function(e){var i=e.$el.find(o.selectors.value_container).empty();if(e.__.value=void 0,e.filter&&e.operator&&0!==e.operator.nb_inputs){for(var s=this,n=t(),r=e.filter,a=0;a<e.operator.nb_inputs;a++){var l=t(this.getRuleInput(e,a));a>0&&i.append(this.settings.inputs_separator),i.append(l),n=n.add(l)}i.show(),n.on("change "+(r.input_event||""),function(){this._updating_input||(e._updating_value=!0,e.value=s.getRuleInputValue(e),e._updating_value=!1)}),r.plugin&&n[r.plugin](r.plugin_config||{}),this.trigger("afterCreateRuleInput",e),void 0!==r.default_value?e.value=r.default_value:(e._updating_value=!0,e.value=s.getRuleInputValue(e),e._updating_value=!1)}},o.prototype.updateRuleFilter=function(t,e){this.createRuleOperators(t),this.createRuleInput(t),t.$el.find(o.selectors.rule_filter).val(t.filter?t.filter.id:"-1"),e&&t.filter&&e.id!==t.filter.id&&(t.data=void 0),this.trigger("afterUpdateRuleFilter",t,e),this.trigger("rulesChanged")},o.prototype.updateRuleOperator=function(t,e){var i=t.$el.find(o.selectors.value_container),s=t.value;t.operator&&0!==t.operator.nb_inputs?(i.show(),!i.is(":empty")&&e&&t.operator.nb_inputs===e.nb_inputs&&t.operator.optgroup===e.optgroup||this.createRuleInput(t)):(i.hide(),t.__.value=void 0),t.operator&&t.$el.find(o.selectors.rule_operator).val(t.operator.type),this.trigger("afterUpdateRuleOperator",t,e),this.trigger("rulesChanged"),this.updateRuleValue(t,s)},o.prototype.updateRuleValue=function(t,e){t._updating_value||this.setRuleInputValue(t,t.value),this.trigger("afterUpdateRuleValue",t,e),this.trigger("rulesChanged")},o.prototype.applyRuleFlags=function(t){var e=t.flags,i=o.selectors;e.filter_readonly&&t.$el.find(i.rule_filter).prop("disabled",!0),e.operator_readonly&&t.$el.find(i.rule_operator).prop("disabled",!0),e.value_readonly&&t.$el.find(i.rule_value).prop("disabled",!0),e.no_delete&&t.$el.find(i.delete_rule).remove(),this.trigger("afterApplyRuleFlags",t)},o.prototype.applyGroupFlags=function(t){var e=t.flags,i=o.selectors;e.condition_readonly&&t.$el.find(">"+i.group_condition).prop("disabled",!0).parent().addClass("readonly"),e.no_add_rule&&t.$el.find(i.add_rule).remove(),e.no_add_group&&t.$el.find(i.add_group).remove(),e.no_delete&&t.$el.find(i.delete_group).remove(),this.trigger("afterApplyGroupFlags",t)},o.prototype.clearErrors=function(t){(t=t||this.model.root)&&(t.error=null,t instanceof h&&t.each(function(t){t.error=null},function(t){this.clearErrors(t)},this))},o.prototype.updateError=function(t){if(this.settings.display_errors)if(null===t.error)t.$el.removeClass("has-error");else{var e=this.translate("errors",t.error[0]);e=a.fmt(e,t.error.slice(1)),e=this.change("displayError",e,t.error,t),t.$el.addClass("has-error").find(o.selectors.error_container).eq(0).attr("title",e)}},o.prototype.triggerValidationError=function(e,i,s){t.isArray(i)||(i=[i]),this.trigger("validationError",e,i,s).isDefaultPrevented()||(e.error=i)},o.prototype.destroy=function(){this.trigger("beforeDestroy"),this.status.generated_id&&this.$el.removeAttr("id"),this.clear(),this.model=null,this.$el.off(".queryBuilder").removeClass("query-builder").removeData("queryBuilder"),delete this.$el[0].queryBuilder},o.prototype.reset=function(){this.trigger("beforeReset").isDefaultPrevented()||(this.status.group_id=1,this.status.rule_id=0,this.model.root.empty(),this.addRule(this.model.root),this.trigger("afterReset"),this.trigger("rulesChanged"))},o.prototype.clear=function(){this.trigger("beforeClear").isDefaultPrevented()||(this.status.group_id=0,this.status.rule_id=0,this.model.root&&(this.model.root.drop(),this.model.root=null),this.trigger("afterClear"),this.trigger("rulesChanged"))},o.prototype.setOptions=function(e){t.each(e,function(t,e){-1!==o.modifiable_options.indexOf(t)&&(this.settings[t]=e)}.bind(this))},o.prototype.getModel=function(e){return e?e instanceof l?e:t(e).data("queryBuilderModel"):this.model.root},o.prototype.validate=function(e){e=t.extend({skip_empty:!1},e),this.clearErrors();var i=this,s=function t(s){var n=0,r=0;return s.each(function(t){if(t.filter||!e.skip_empty){if(!t.filter)return i.triggerValidationError(t,"no_filter",null),void r++;if(!t.operator)return i.triggerValidationError(t,"no_operator",null),void r++;if(0!==t.operator.nb_inputs){var s=i.validateValue(t,t.value);if(!0!==s)return i.triggerValidationError(t,s,t.value),void r++}n++}},function(e){var i=t(e);!0===i?n++:!1===i&&r++}),!(r>0)&&(0===n&&!s.isRoot()&&e.skip_empty?null:!!(0!==n||i.settings.allow_empty&&s.isRoot())||(i.triggerValidationError(s,"empty_group",null),!1))}(this.model.root);return this.change("validate",s)},o.prototype.getRules=function(e){e=t.extend({get_flags:!1,allow_invalid:!1,skip_empty:!1},e);var i=this.validate(e);if(!i&&!e.allow_invalid)return null;var s=this,n=function i(n){var r={condition:n.condition,rules:[]};if(n.data&&(r.data=t.extendext(!0,"replace",{},n.data)),e.get_flags){var o=s.getGroupFlags(n.flags,"all"===e.get_flags);t.isEmptyObject(o)||(r.flags=o)}return n.each(function(i){if(i.filter||!e.skip_empty){var n=null;i.operator&&0===i.operator.nb_inputs||(n=i.value);var o={id:i.filter?i.filter.id:null,field:i.filter?i.filter.field:null,type:i.filter?i.filter.type:null,input:i.filter?i.filter.input:null,operator:i.operator?i.operator.type:null,value:n};if((i.filter&&i.filter.data||i.data)&&(o.data=t.extendext(!0,"replace",{},i.filter.data,i.data)),e.get_flags){var a=s.getRuleFlags(i.flags,"all"===e.get_flags);t.isEmptyObject(a)||(o.flags=a)}r.rules.push(s.change("ruleToJson",o,i))}},function(t){var s=i(t);0===s.rules.length&&e.skip_empty||r.rules.push(s)},this),s.change("groupToJson",r,n)}(this.model.root);return n.valid=i,this.change("getRules",n)},o.prototype.setRules=function(e,i){i=t.extend({allow_invalid:!1},i),t.isArray(e)&&(e={condition:this.settings.default_condition,rules:e}),e&&e.rules&&(0!==e.rules.length||this.settings.allow_empty)||a.error("RulesParse","Incorrect data object passed"),this.clear(),this.setRoot(!1,e.data,this.parseGroupFlags(e)),this.applyGroupFlags(this.model.root);var s=this;!function t(e,n){null!==n&&(void 0===e.condition?e.condition=s.settings.default_condition:-1==s.settings.conditions.indexOf(e.condition)&&(a.error(!i.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition),e.condition=s.settings.default_condition),n.condition=e.condition,e.rules.forEach(function(e){var r;if(void 0!==e.rules)if(-1!==s.settings.allow_groups&&s.settings.allow_groups<n.level)a.error(!i.allow_invalid,"RulesParse","No more than {0} groups are allowed",s.settings.allow_groups),s.reset();else{if(null===(r=s.addGroup(n,!1,e.data,s.parseGroupFlags(e))))return;s.applyGroupFlags(r),t(e,r)}else{if(e.empty||(void 0===e.id&&(a.error(!i.allow_invalid,"RulesParse","Missing rule field id"),e.empty=!0),void 0===e.operator&&(e.operator="equal")),null===(r=s.addRule(n,e.data,s.parseRuleFlags(e))))return;e.empty||(r.filter=s.getFilterById(e.id,!i.allow_invalid)),r.filter&&(r.operator=s.getOperatorByType(e.operator,!i.allow_invalid),r.operator||(r.operator=s.getOperators(r.filter)[0])),r.operator&&0!==r.operator.nb_inputs&&(void 0!==e.value?r.value=e.value:void 0!==r.filter.default_value&&(r.value=r.filter.default_value)),s.applyRuleFlags(r),s.change("jsonToRule",r,e)!=r&&a.error("RulesParse","Plugin tried to change rule reference")}}),s.change("jsonToGroup",n,e)!=n&&a.error("RulesParse","Plugin tried to change group reference"))}(e=this.change("setRules",e,i),this.model.root),this.trigger("afterSetRules")},o.prototype.validateValue=function(t,e){var i,s=t.filter.validation||{};return i=s.callback?s.callback.call(this,e,t):this._validateValue(t,e),this.change("validateValue",i,e,t)},o.prototype._validateValue=function(e,i){var s,n,r=e.filter,l=e.operator,h=r.validation||{},d=!0;1===e.operator.nb_inputs&&(i=[i]);for(var u=0;u<l.nb_inputs;u++){if(!l.multiple&&t.isArray(i[u])&&i[u].length>1){d=["operator_not_multiple",l.type,this.translate("operators",l.type)];break}switch(r.input){case"radio":if(void 0===i[u]||0===i[u].length){h.allow_empty_value||(d=["radio_empty"]);break}break;case"checkbox":if(void 0===i[u]||0===i[u].length){h.allow_empty_value||(d=["checkbox_empty"]);break}break;case"select":if(void 0===i[u]||0===i[u].length||r.placeholder&&i[u]==r.placeholder_value){h.allow_empty_value||(d=["select_empty"]);break}break;default:n=t.isArray(i[u])?i[u]:[i[u]];for(var c=0;c<n.length;c++){switch(o.types[r.type]){case"string":if(void 0===n[c]||0===n[c].length){h.allow_empty_value||(d=["string_empty"]);break}if(void 0!==h.min&&n[c].length<parseInt(h.min)){d=[this.getValidationMessage(h,"min","string_exceed_min_length"),h.min];break}if(void 0!==h.max&&n[c].length>parseInt(h.max)){d=[this.getValidationMessage(h,"max","string_exceed_max_length"),h.max];break}if(h.format&&("string"==typeof h.format&&(h.format=new RegExp(h.format)),!h.format.test(n[c]))){d=[this.getValidationMessage(h,"format","string_invalid_format"),h.format];break}break;case"number":if(void 0===n[c]||0===n[c].length){h.allow_empty_value||(d=["number_nan"]);break}if(isNaN(n[c])){d=["number_nan"];break}if("integer"==r.type){if(parseInt(n[c])!=n[c]){d=["number_not_integer"];break}}else if(parseFloat(n[c])!=n[c]){d=["number_not_double"];break}if(void 0!==h.min&&n[c]<parseFloat(h.min)){d=[this.getValidationMessage(h,"min","number_exceed_min"),h.min];break}if(void 0!==h.max&&n[c]>parseFloat(h.max)){d=[this.getValidationMessage(h,"max","number_exceed_max"),h.max];break}if(void 0!==h.step&&"any"!==h.step){var p=(n[c]/h.step).toPrecision(14);if(parseInt(p)!=p){d=[this.getValidationMessage(h,"step","number_wrong_step"),h.step];break}}break;case"datetime":if(void 0===n[c]||0===n[c].length){h.allow_empty_value||(d=["datetime_empty"]);break}if(h.format){"moment"in window||a.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com");var f=moment(n[c],h.format);if(!f.isValid()){d=[this.getValidationMessage(h,"format","datetime_invalid"),h.format];break}if(h.min&&f<moment(h.min,h.format)){d=[this.getValidationMessage(h,"min","datetime_exceed_min"),h.min];break}if(h.max&&f>moment(h.max,h.format)){d=[this.getValidationMessage(h,"max","datetime_exceed_max"),h.max];break}}break;case"boolean":if(void 0===n[c]||0===n[c].length){h.allow_empty_value||(d=["boolean_not_valid"]);break}if("true"!==(s=(""+n[c]).trim().toLowerCase())&&"false"!==s&&"1"!==s&&"0"!==s&&1!==n[c]&&0!==n[c]){d=["boolean_not_valid"];break}}if(!0!==d)break}}if(!0!==d)break}if(("between"===e.operator.type||"not_between"===e.operator.type)&&2===i.length)switch(o.types[r.type]){case"number":i[0]>i[1]&&(d=["number_between_invalid",i[0],i[1]]);break;case"datetime":h.format&&("moment"in window||a.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com"),moment(i[0],h.format).isAfter(moment(i[1],h.format))&&(d=["datetime_between_invalid",i[0],i[1]]))}return d},o.prototype.nextGroupId=function(){return this.status.id+"_group_"+this.status.group_id++},o.prototype.nextRuleId=function(){return this.status.id+"_rule_"+this.status.rule_id++},o.prototype.getOperators=function(t){"string"==typeof t&&(t=this.getFilterById(t));for(var e=[],i=0,s=this.operators.length;i<s;i++){if(t.operators){if(-1==t.operators.indexOf(this.operators[i].type))continue}else if(-1==this.operators[i].apply_to.indexOf(o.types[t.type]))continue;e.push(this.operators[i])}return t.operators&&e.sort(function(e,i){return t.operators.indexOf(e.type)-t.operators.indexOf(i.type)}),this.change("getOperators",e,t)},o.prototype.getFilterById=function(t,e){if("-1"==t)return null;for(var i=0,s=this.filters.length;i<s;i++)if(this.filters[i].id==t)return this.filters[i];return a.error(!1!==e,"UndefinedFilter",'Undefined filter "{0}"',t),null},o.prototype.getOperatorByType=function(t,e){if("-1"==t)return null;for(var i=0,s=this.operators.length;i<s;i++)if(this.operators[i].type==t)return this.operators[i];return a.error(!1!==e,"UndefinedOperator",'Undefined operator "{0}"',t),null},o.prototype.getRuleInputValue=function(e){var i=e.filter,s=e.operator,n=[];if(i.valueGetter)n=i.valueGetter.call(this,e);else{for(var r=e.$el.find(o.selectors.value_container),l=0;l<s.nb_inputs;l++){var h,d=a.escapeElementId(e.id+"_value_"+l);switch(i.input){case"radio":n.push(r.find("[name="+d+"]:checked").val());break;case"checkbox":h=[],r.find("[name="+d+"]:checked").each(function(){h.push(t(this).val())}),n.push(h);break;case"select":i.multiple?(h=[],r.find("[name="+d+"] option:selected").each(function(){h.push(t(this).val())}),n.push(h)):n.push(r.find("[name="+d+"] option:selected").val());break;default:n.push(r.find("[name="+d+"]").val())}}s.multiple&&i.value_separator&&(n=n.map(function(t){return t.split(i.value_separator)})),1===s.nb_inputs&&(n=n[0]),i.valueParser&&(n=i.valueParser.call(this,e,n))}return this.change("getRuleValue",n,e)},o.prototype.setRuleInputValue=function(e,i){var s=e.filter,n=e.operator;if(s&&n){if(this._updating_input=!0,s.valueSetter)s.valueSetter.call(this,e,i);else{var r=e.$el.find(o.selectors.value_container);1==n.nb_inputs&&(i=[i]);for(var l=0;l<n.nb_inputs;l++){var h=a.escapeElementId(e.id+"_value_"+l);switch(s.input){case"radio":r.find("[name="+h+'][value="'+i[l]+'"]').prop("checked",!0).trigger("change");break;case"checkbox":t.isArray(i[l])||(i[l]=[i[l]]),i[l].forEach(function(t){r.find("[name="+h+'][value="'+t+'"]').prop("checked",!0).trigger("change")});break;default:n.multiple&&s.value_separator&&t.isArray(i[l])&&(i[l]=i[l].join(s.value_separator)),r.find("[name="+h+"]").val(i[l]).trigger("change")}}}this._updating_input=!1}},o.prototype.parseRuleFlags=function(e){var i=t.extend({},this.settings.default_rule_flags);return e.readonly&&t.extend(i,{filter_readonly:!0,operator_readonly:!0,value_readonly:!0,no_delete:!0}),e.flags&&t.extend(i,e.flags),this.change("parseRuleFlags",i,e)},o.prototype.getRuleFlags=function(e,i){if(i)return t.extend({},e);var s={};return t.each(this.settings.default_rule_flags,function(t,i){e[t]!==i&&(s[t]=e[t])}),s},o.prototype.parseGroupFlags=function(e){var i=t.extend({},this.settings.default_group_flags);return e.readonly&&t.extend(i,{condition_readonly:!0,no_add_rule:!0,no_add_group:!0,no_delete:!0}),e.flags&&t.extend(i,e.flags),this.change("parseGroupFlags",i,e)},o.prototype.getGroupFlags=function(e,i){if(i)return t.extend({},e);var s={};return t.each(this.settings.default_group_flags,function(t,i){e[t]!==i&&(s[t]=e[t])}),s},o.prototype.translate=function(t,e){var i;return e||(e=t,t=void 0),i="object"==typeof e?e[this.settings.lang_code]||e.en:(t?this.lang[t]:this.lang)[e]||e,this.change("translate",i,e,t)},o.prototype.getValidationMessage=function(t,e,i){return t.messages&&t.messages[e]||i},o.templates.group='<dl id="{{= it.group_id }}" class="rules-group-container">   <dt class="rules-group-header">     <div class="btn-group pull-right group-actions">       <button type="button" class="btn btn-xs btn-success" data-add="rule">         <i class="{{= it.icons.add_rule }}"></i> {{= it.translate("add_rule") }}       </button>       {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}         <button type="button" class="btn btn-xs btn-success" data-add="group">           <i class="{{= it.icons.add_group }}"></i> {{= it.translate("add_group") }}         </button>       {{?}}       {{? it.level>1 }}         <button type="button" class="btn btn-xs btn-danger" data-delete="group">           <i class="{{= it.icons.remove_group }}"></i> {{= it.translate("delete_group") }}         </button>       {{?}}     </div>     <div class="btn-group group-conditions">       {{~ it.conditions: condition }}         <label class="btn btn-xs btn-primary">           <input type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}"> {{= it.translate("conditions", condition) }}         </label>       {{~}}     </div>     {{? it.settings.display_errors }}       <div class="error-container"><i class="{{= it.icons.error }}"></i></div>     {{?}}   </dt>   <dd class=rules-group-body>     <ul class=rules-list></ul>   </dd> </dl>',o.templates.rule='<li id="{{= it.rule_id }}" class="rule-container">   <div class="rule-header">     <div class="btn-group pull-right rule-actions">       <button type="button" class="btn btn-xs btn-danger" data-delete="rule">         <i class="{{= it.icons.remove_rule }}"></i> {{= it.translate("delete_rule") }}       </button>     </div>   </div>   {{? it.settings.display_errors }}     <div class="error-container"><i class="{{= it.icons.error }}"></i></div>   {{?}}   <div class="rule-filter-container"></div>   <div class="rule-operator-container"></div>   <div class="rule-value-container"></div> </li>',o.templates.filterSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.rule.id }}_filter">   {{? it.settings.display_empty_filter }}     <option value="-1">{{= it.settings.select_placeholder }}</option>   {{?}}   {{~ it.filters: filter }}     {{? optgroup !== filter.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = filter.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= filter.id }}">{{= it.translate(filter.label) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>',o.templates.operatorSelect='{{? it.operators.length === 1 }} <span> {{= it.translate("operators", it.operators[0].type) }} </span> {{?}} {{ var optgroup = null; }} <select class="form-control {{? it.operators.length === 1 }}hide{{?}}" name="{{= it.rule.id }}_operator">   {{~ it.operators: operator }}     {{? optgroup !== operator.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = operator.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= operator.type }}">{{= it.translate("operators", operator.type) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>',o.prototype.getGroupTemplate=function(t,e){var i=this.templates.group({builder:this,group_id:t,level:e,conditions:this.settings.conditions,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getGroupTemplate",i,e)},o.prototype.getRuleTemplate=function(t){var e=this.templates.rule({builder:this,rule_id:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleTemplate",e)},o.prototype.getRuleFilterSelect=function(t,e){var i=this.templates.filterSelect({builder:this,rule:t,filters:e,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleFilterSelect",i,t,e)},o.prototype.getRuleOperatorSelect=function(t,e){var i=this.templates.operatorSelect({builder:this,rule:t,operators:e,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleOperatorSelect",i,t,e)},o.prototype.getRuleInput=function(t,e){var i=t.filter,s=t.filter.validation||{},n=t.id+"_value_"+e,r=i.vertical?" class=block":"",o="";if("function"==typeof i.input)o=i.input.call(this,t,n);else switch(i.input){case"radio":case"checkbox":a.iterateOptions(i.values,function(t,e){o+="<label"+r+'><input type="'+i.input+'" name="'+n+'" value="'+t+'"> '+e+"</label> "});break;case"select":o+='<select class="form-control" name="'+n+'"'+(i.multiple?" multiple":"")+">",i.placeholder&&(o+='<option value="'+i.placeholder_value+'" disabled selected>'+i.placeholder+"</option>"),a.iterateOptions(i.values,function(t,e){o+='<option value="'+t+'">'+e+"</option> "}),o+="</select>";break;case"textarea":o+='<textarea class="form-control" name="'+n+'"',i.size&&(o+=' cols="'+i.size+'"'),i.rows&&(o+=' rows="'+i.rows+'"'),void 0!==s.min&&(o+=' minlength="'+s.min+'"'),void 0!==s.max&&(o+=' maxlength="'+s.max+'"'),i.placeholder&&(o+=' placeholder="'+i.placeholder+'"'),o+="></textarea>";break;case"number":o+='<input class="form-control" type="number" name="'+n+'"',void 0!==s.step&&(o+=' step="'+s.step+'"'),void 0!==s.min&&(o+=' min="'+s.min+'"'),void 0!==s.max&&(o+=' max="'+s.max+'"'),i.placeholder&&(o+=' placeholder="'+i.placeholder+'"'),i.size&&(o+=' size="'+i.size+'"'),o+=">";break;default:o+='<input class="form-control" type="text" name="'+n+'"',i.placeholder&&(o+=' placeholder="'+i.placeholder+'"'),"string"===i.type&&void 0!==s.min&&(o+=' minlength="'+s.min+'"'),"string"===i.type&&void 0!==s.max&&(o+=' maxlength="'+s.max+'"'),i.size&&(o+=' size="'+i.size+'"'),o+=">"}return this.change("getRuleInput",o,t,n)};var a={};o.utils=a,a.iterateOptions=function(e,i){e&&(t.isArray(e)?e.forEach(function(e){t.isPlainObject(e)?t.each(e,function(t,e){return i(t,e),!1}):i(e,e)}):t.each(e,function(t,e){i(t,e)}))},a.fmt=function(t,e){return Array.isArray(e)||(e=Array.prototype.slice.call(arguments,1)),t.replace(/{([0-9]+)}/g,function(t,i){return e[parseInt(i)]})},a.error=function(){var t=0,e="boolean"!=typeof arguments[t]||arguments[t++],i=arguments[t++],s=arguments[t++],n=Array.isArray(arguments[t])?arguments[t]:Array.prototype.slice.call(arguments,t);if(e){var r=new Error(a.fmt(s,n));throw r.name=i+"Error",r.args=n,r}console.error(i+"Error: "+a.fmt(s,n))},a.changeType=function(t,e,i){switch(e){case"integer":return parseInt(t);case"double":return parseFloat(t);case"boolean":var s="true"===t.trim().toLowerCase()||"1"===t.trim()||1===t;return i?s?1:0:s;default:return t}},a.escapeString=function(t){return"string"!=typeof t?t:t.replace(/[\0\n\r\b\\\'\"]/g,function(t){switch(t){case"\0":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";default:return"\\"+t}}).replace(/\t/g,"\\t").replace(/\x1a/g,"\\Z")},a.escapeRegExp=function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},a.escapeElementId=function(t){return t?t.replace(/(\\)?([:.\[\],])/g,function(t,e,i){return e?t:"\\"+i}):t},a.groupSort=function(t,e){var i=[],s=[];return t.forEach(function(t){var n;t[e]?-1==(n=i.lastIndexOf(t[e]))?n=i.length:n++:n=i.length,i.splice(n,0,t[e]),s.splice(n,0,t)}),s},a.defineModelProperties=function(e,i){i.forEach(function(i){Object.defineProperty(e.prototype,i,{enumerable:!0,get:function(){return this.__[i]},set:function(e){var s=null!==this.__[i]&&"object"==typeof this.__[i]?t.extend({},this.__[i]):this.__[i];this.__[i]=e,null!==this.model&&this.model.trigger("update",this,i,e,s)}})})},t.extend(i.prototype,{trigger:function(e){var i=new t.Event(e);return this.$.triggerHandler(i,Array.prototype.slice.call(arguments,1)),i},on:function(){return this.$.on.apply(this.$,Array.prototype.slice.call(arguments)),this},off:function(){return this.$.off.apply(this.$,Array.prototype.slice.call(arguments)),this},once:function(){return this.$.one.apply(this.$,Array.prototype.slice.call(arguments)),this}});var l=function(t,e){return this instanceof l?(Object.defineProperty(this,"__",{value:{}}),e.data("queryBuilderModel",this),this.__.level=1,this.__.error=null,this.__.flags={},this.__.data=void 0,this.$el=e,this.id=e[0].id,this.model=null,void(this.parent=t)):new l(t,e)};a.defineModelProperties(l,["level","error","data","flags"]),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){return this.__.parent},set:function(t){this.__.parent=t,this.level=null===t?1:t.level+1,this.model=null===t?null:t.model}}),l.prototype.isRoot=function(){return 1===this.level},l.prototype.getPos=function(){return this.isRoot()?-1:this.parent.getNodePos(this)},l.prototype.drop=function(){var t=this.model;this.parent&&this.parent.removeNode(this),this.$el.removeData("queryBuilderModel"),null!==t&&t.trigger("drop",this)},l.prototype.moveAfter=function(t){this.isRoot()||this.move(t.parent,t.getPos()+1)},l.prototype.moveAtBegin=function(t){this.isRoot()||(void 0===t&&(t=this.parent),this.move(t,0))},l.prototype.moveAtEnd=function(t){this.isRoot()||(void 0===t&&(t=this.parent),this.move(t,0===t.length()?0:t.length()-1))},l.prototype.move=function(t,e){this.isRoot()||("number"==typeof t&&(e=t,t=this.parent),this.parent.removeNode(this),t.insertNode(this,e,!1),null!==this.model&&this.model.trigger("move",this,t,e))};var h=function(t,e){return this instanceof h?(l.call(this,t,e),this.rules=[],void(this.__.condition=null)):new h(t,e)};h.prototype=Object.create(l.prototype),h.prototype.constructor=h,a.defineModelProperties(h,["condition"]),h.prototype.empty=function(){this.each("reverse",function(t){t.drop()},function(t){t.drop()})},h.prototype.drop=function(){this.empty(),l.prototype.drop.call(this)},h.prototype.length=function(){return this.rules.length},h.prototype.insertNode=function(t,e,i){return void 0===e&&(e=this.length()),this.rules.splice(e,0,t),t.parent=this,i&&null!==this.model&&this.model.trigger("add",this,t,e),t},h.prototype.addGroup=function(t,e){return this.insertNode(new h(this,t),e,!0)},h.prototype.addRule=function(t,e){return this.insertNode(new d(this,t),e,!0)},h.prototype.removeNode=function(t){var e=this.getNodePos(t);-1!==e&&(t.parent=null,this.rules.splice(e,1))},h.prototype.getNodePos=function(t){return this.rules.indexOf(t)},h.prototype.each=function(t,e,i,s){"boolean"!=typeof t&&"string"!=typeof t&&(s=i,i=e,e=t,t=!1),s=void 0===s?null:s;for(var n=t?this.rules.length-1:0,r=t?0:this.rules.length-1,o=t?-1:1,a=!1;(t?n>=r:n<=r)&&(this.rules[n]instanceof h?i&&(a=!1===i.call(s,this.rules[n])):e&&(a=!1===e.call(s,this.rules[n])),!a);n+=o);return!a},h.prototype.contains=function(t,e){return-1!==this.getNodePos(t)||!!e&&!this.each(function(){return!0},function(e){return!e.contains(t,!0)})};var d=function(t,e){return this instanceof d?(l.call(this,t,e),this._updating_value=!1,this._updating_input=!1,this.__.filter=null,this.__.operator=null,void(this.__.value=void 0)):new d(t,e)};return d.prototype=Object.create(l.prototype),d.prototype.constructor=d,a.defineModelProperties(d,["filter","operator","value"]),d.prototype.isRoot=function(){return!1},o.Group=h,o.Rule=d,t.fn.queryBuilder=function(t){0===this.length&&a.error("Config","No target defined"),this.length>1&&a.error("Config","Unable to initialize on multiple target");var e=this.data("queryBuilder"),i="object"==typeof t&&t||{};if(!e&&"destroy"==t)return this;if(!e){var s=new o(this,i);this.data("queryBuilder",s),s.init(i.rules)}return"string"==typeof t?e[t].apply(e,Array.prototype.slice.call(arguments,1)):this},t.fn.queryBuilder.constructor=o,t.fn.queryBuilder.defaults=o.defaults,t.fn.queryBuilder.extend=o.extend,t.fn.queryBuilder.define=o.define,t.fn.queryBuilder.regional=o.regional,o.define("bt-checkbox",function(t){"glyphicons"==t.font&&this.$el.addClass("bt-checkbox-glyphicons"),this.on("getRuleInput.filter",function(e,i,s){var n=i.filter;if(("radio"===n.input||"checkbox"===n.input)&&!n.plugin){e.value="",n.colors||(n.colors={}),n.color&&(n.colors._def_=n.color);var r=n.vertical?' style="display:block"':"",o=0;a.iterateOptions(n.values,function(i,a){var l=n.colors[i]||n.colors._def_||t.color,h=s+"_"+o++;e.value+="<div"+r+' class="'+n.input+" "+n.input+"-"+l+'">   <input type="'+n.input+'" name="'+s+'" id="'+h+'" value="'+i+'">   <label for="'+h+'">'+a+"</label> </div>"})}})},{font:"glyphicons",color:"default"}),o.define("bt-selectpicker",function(e){t.fn.selectpicker&&t.fn.selectpicker.Constructor||a.error("MissingLibrary",'Bootstrap Select is required to use "bt-selectpicker" plugin. Get it here: http://silviomoreto.github.io/bootstrap-select');var i=o.selectors;this.on("afterCreateRuleFilters",function(t,s){s.$el.find(i.rule_filter).removeClass("form-control").selectpicker(e)}),this.on("afterCreateRuleOperators",function(t,s){s.$el.find(i.rule_operator).removeClass("form-control").selectpicker(e)}),this.on("afterUpdateRuleFilter",function(t,e){e.$el.find(i.rule_filter).selectpicker("render")}),this.on("afterUpdateRuleOperator",function(t,e){e.$el.find(i.rule_operator).selectpicker("render")}),this.on("beforeDeleteRule",function(t,e){e.$el.find(i.rule_filter).selectpicker("destroy"),e.$el.find(i.rule_operator).selectpicker("destroy")})},{container:"body",style:"btn-inverse btn-xs",width:"auto",showIcon:!1}),o.define("bt-tooltip-errors",function(e){t.fn.tooltip&&t.fn.tooltip.Constructor&&t.fn.tooltip.Constructor.prototype.fixTitle||a.error("MissingLibrary",'Bootstrap Tooltip is required to use "bt-tooltip-errors" plugin. Get it here: http://getbootstrap.com');var i=this;this.on("getRuleTemplate.filter getGroupTemplate.filter",function(e){var i=t(e.value);i.find(o.selectors.error_container).attr("data-toggle","tooltip"),e.value=i.prop("outerHTML")}),this.model.on("update",function(t,s,n){"error"==n&&i.settings.display_errors&&s.$el.find(o.selectors.error_container).eq(0).tooltip(e).tooltip("hide").tooltip("fixTitle")})},{placement:"right"}),o.extend({setFilters:function(t,e){var i=this;void 0===e&&(e=t,t=!1),e=this.checkFilters(e);var s=(e=this.change("setFilters",e)).map(function(t){return t.id});if(t||function t(e){e.each(function(t){t.filter&&-1===s.indexOf(t.filter.id)&&a.error("ChangeFilter",'A rule is using filter "{0}"',t.filter.id)},t)}(this.model.root),this.filters=e,function t(e){e.each(!0,function(t){t.filter&&-1===s.indexOf(t.filter.id)?(t.drop(),i.trigger("rulesChanged")):(i.createRuleFilters(t),t.$el.find(o.selectors.rule_filter).val(t.filter?t.filter.id:"-1"),i.trigger("afterUpdateRuleFilter",t))},t)}(this.model.root),this.settings.plugins&&(this.settings.plugins["unique-filter"]&&this.updateDisabledFilters(),this.settings.plugins["bt-selectpicker"]&&this.$el.find(o.selectors.rule_filter).selectpicker("render")),this.settings.default_filter)try{this.getFilterById(this.settings.default_filter)}catch(t){this.settings.default_filter=null}this.trigger("afterSetFilters",e)},addFilter:function(e,i){void 0===i||"#end"==i?i=this.filters.length:"#start"==i&&(i=0),t.isArray(e)||(e=[e]);var s=t.extend(!0,[],this.filters);parseInt(i)==i?Array.prototype.splice.apply(s,[i,0].concat(e)):this.filters.some(function(t,e){if(t.id==i)return i=e+1,!0})?Array.prototype.splice.apply(s,[i,0].concat(e)):Array.prototype.push.apply(s,e),this.setFilters(s)},removeFilter:function(e,i){var s=t.extend(!0,[],this.filters);"string"==typeof e&&(e=[e]),s=s.filter(function(t){return-1===e.indexOf(t.id)}),this.setFilters(i,s)}}),o.define("filter-description",function(e){"inline"===e.mode?this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(i,s){var n=s.$el.find("p.filter-description"),r=i.builder.getFilterDescription(s.filter,s);r?(0===n.length?(n=t('<p class="filter-description"></p>')).appendTo(s.$el):n.show(),n.html('<i class="'+e.icon+'"></i> '+r)):n.hide()}):"popover"===e.mode?(t.fn.popover&&t.fn.popover.Constructor&&t.fn.popover.Constructor.prototype.fixTitle||a.error("MissingLibrary",'Bootstrap Popover is required to use "filter-description" plugin. Get it here: http://getbootstrap.com'),this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(i,s){var n=s.$el.find("button.filter-description"),r=i.builder.getFilterDescription(s.filter,s);r?(0===n.length?((n=t('<button type="button" class="btn btn-xs btn-info filter-description" data-toggle="popover"><i class="'+e.icon+'"></i></button>')).prependTo(s.$el.find(o.selectors.rule_actions)),n.popover({placement:"left",container:"body",html:!0}),n.on("mouseout",function(){n.popover("hide")})):n.show(),n.data("bs.popover").options.content=r,n.attr("aria-describedby")&&n.popover("show")):(n.hide(),n.data("bs.popover")&&n.popover("hide"))})):"bootbox"===e.mode&&("bootbox"in window||a.error("MissingLibrary",'Bootbox is required to use "filter-description" plugin. Get it here: http://bootboxjs.com'),this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(i,s){var n=s.$el.find("button.filter-description"),r=i.builder.getFilterDescription(s.filter,s);r?(0===n.length?((n=t('<button type="button" class="btn btn-xs btn-info filter-description" data-toggle="bootbox"><i class="'+e.icon+'"></i></button>')).prependTo(s.$el.find(o.selectors.rule_actions)),n.on("click",function(){bootbox.alert(n.data("description"))})):n.show(),n.data("description",r)):n.hide()}))},{icon:"glyphicon glyphicon-info-sign",mode:"popover"}),o.extend({getFilterDescription:function(t,e){return t?"function"==typeof t.description?t.description.call(this,e):t.description:void 0}}),o.define("invert",function(e){var i=this,s=o.selectors;this.on("afterInit",function(){i.$el.on("click.queryBuilder","[data-invert=group]",function(){var n=t(this).closest(s.group_container);i.invert(i.getModel(n),e)}),e.display_rules_button&&e.invert_rules&&i.$el.on("click.queryBuilder","[data-invert=rule]",function(){var n=t(this).closest(s.rule_container);i.invert(i.getModel(n),e)})}),this.on("getGroupTemplate.filter",function(n,r){var o=t(n.value);o.find(s.condition_container).after('<button type="button" class="btn btn-xs btn-default" data-invert="group"><i class="'+e.icon+'"></i> '+i.translate("invert")+"</button>"),n.value=o.prop("outerHTML")}),e.display_rules_button&&e.invert_rules&&this.on("getRuleTemplate.filter",function(n){var r=t(n.value);r.find(s.rule_actions).prepend('<button type="button" class="btn btn-xs btn-default" data-invert="rule"><i class="'+e.icon+'"></i> '+i.translate("invert")+"</button>"),n.value=r.prop("outerHTML")})},{icon:"glyphicon glyphicon-random",recursive:!0,invert_rules:!0,display_rules_button:!1,silent_fail:!1}),o.defaults({operatorOpposites:{equal:"not_equal",not_equal:"equal",in:"not_in",not_in:"in",less:"greater_or_equal",less_or_equal:"greater",greater:"less_or_equal",greater_or_equal:"less",between:"not_between",not_between:"between",begins_with:"not_begins_with",not_begins_with:"begins_with",contains:"not_contains",not_contains:"contains",ends_with:"not_ends_with",not_ends_with:"ends_with",is_empty:"is_not_empty",is_not_empty:"is_empty",is_null:"is_not_null",is_not_null:"is_null"},conditionOpposites:{AND:"OR",OR:"AND"}}),o.extend({invert:function(e,i){if(!(e instanceof l)){if(!this.model.root)return;i=e,e=this.model.root}if("object"!=typeof i&&(i={}),void 0===i.recursive&&(i.recursive=!0),void 0===i.invert_rules&&(i.invert_rules=!0),void 0===i.silent_fail&&(i.silent_fail=!1),void 0===i.trigger&&(i.trigger=!0),e instanceof h){if(this.settings.conditionOpposites[e.condition]?e.condition=this.settings.conditionOpposites[e.condition]:i.silent_fail||a.error("InvertCondition",'Unknown inverse of condition "{0}"',e.condition),i.recursive){var s=t.extend({},i,{trigger:!1});e.each(function(t){i.invert_rules&&this.invert(t,s)},function(t){this.invert(t,s)},this)}}else if(e instanceof d&&e.operator&&!e.filter.no_invert)if(this.settings.operatorOpposites[e.operator.type]){var n=this.settings.operatorOpposites[e.operator.type];e.filter.operators&&-1==e.filter.operators.indexOf(n)||(e.operator=this.getOperatorByType(n))}else i.silent_fail||a.error("InvertOperator",'Unknown inverse of operator "{0}"',e.operator.type);i.trigger&&(this.trigger("afterInvert",e,i),this.trigger("rulesChanged"))}}),o.defaults({mongoOperators:{equal:function(t){return t[0]},not_equal:function(t){return{$ne:t[0]}},in:function(t){return{$in:t}},not_in:function(t){return{$nin:t}},less:function(t){return{$lt:t[0]}},less_or_equal:function(t){return{$lte:t[0]}},greater:function(t){return{$gt:t[0]}},greater_or_equal:function(t){return{$gte:t[0]}},between:function(t){return{$gte:t[0],$lte:t[1]}},not_between:function(t){return{$lt:t[0],$gt:t[1]}},begins_with:function(t){return{$regex:"^"+a.escapeRegExp(t[0])}},not_begins_with:function(t){return{$regex:"^(?!"+a.escapeRegExp(t[0])+")"}},contains:function(t){return{$regex:a.escapeRegExp(t[0])}},not_contains:function(t){return{$regex:"^((?!"+a.escapeRegExp(t[0])+").)*$",$options:"s"}},ends_with:function(t){return{$regex:a.escapeRegExp(t[0])+"$"}},not_ends_with:function(t){return{$regex:"(?<!"+a.escapeRegExp(t[0])+")$"}},is_empty:function(t){return""},is_not_empty:function(t){return{$ne:""}},is_null:function(t){return null},is_not_null:function(t){return{$ne:null}}},mongoRuleOperators:{$ne:function(t){return{val:t=t.$ne,op:null===t?"is_not_null":""===t?"is_not_empty":"not_equal"}},eq:function(t){return{val:t,op:null===t?"is_null":""===t?"is_empty":"equal"}},$regex:function(t){return"^(?!"==(t=t.$regex).slice(0,4)&&")"==t.slice(-1)?{val:t.slice(4,-1),op:"not_begins_with"}:"^((?!"==t.slice(0,5)&&").)*$"==t.slice(-5)?{val:t.slice(5,-5),op:"not_contains"}:"(?<!"==t.slice(0,4)&&")$"==t.slice(-2)?{val:t.slice(4,-2),op:"not_ends_with"}:"$"==t.slice(-1)?{val:t.slice(0,-1),op:"ends_with"}:"^"==t.slice(0,1)?{val:t.slice(1),op:"begins_with"}:{val:t,op:"contains"}},between:function(t){return{val:[t.$gte,t.$lte],op:"between"}},not_between:function(t){return{val:[t.$lt,t.$gt],op:"not_between"}},$in:function(t){return{val:t.$in,op:"in"}},$nin:function(t){return{val:t.$nin,op:"not_in"}},$lt:function(t){return{val:t.$lt,op:"less"}},$lte:function(t){return{val:t.$lte,op:"less_or_equal"}},$gt:function(t){return{val:t.$gt,op:"greater"}},$gte:function(t){return{val:t.$gte,op:"greater_or_equal"}}}}),o.extend({getMongo:function(t){if(!(t=void 0===t?this.getRules():t))return null;var e=this;return function t(i){if(i.condition||(i.condition=e.settings.default_condition),-1===["AND","OR"].indexOf(i.condition.toUpperCase())&&a.error("UndefinedMongoCondition",'Unable to build MongoDB query with condition "{0}"',i.condition),!i.rules)return{};var s=[];i.rules.forEach(function(i){if(i.rules&&i.rules.length>0)s.push(t(i));else{var n=e.settings.mongoOperators[i.operator],r=e.getOperatorByType(i.operator),o=[];void 0===n&&a.error("UndefinedMongoOperator",'Unknown MongoDB operation for operator "{0}"',i.operator),0!==r.nb_inputs&&(i.value instanceof Array||(i.value=[i.value]),i.value.forEach(function(t){o.push(a.changeType(t,i.type,!1))}));var l={};l[e.change("getMongoDBField",i.field,i)]=n.call(e,o),s.push(e.change("ruleToMongo",l,i,o,n))}});var n={};return n["$"+i.condition.toLowerCase()]=s,e.change("groupToMongo",n,i)}(t)},getRulesFromMongo:function(t){if(void 0===t||null===t)return null;var e=this;if("rules"in(t=e.change("parseMongoNode",t))&&"condition"in t)return t;if("id"in t&&"operator"in t&&"value"in t)return{condition:this.settings.default_condition,rules:[t]};var i=s(t);return i||a.error("MongoParse","Invalid MongoDB query format"),function t(i,n){var r=[];return i[n].forEach(function(i){if("rules"in(i=e.change("parseMongoNode",i))&&"condition"in i)r.push(i);else if("id"in i&&"operator"in i&&"value"in i)r.push(i);else{var n=s(i);if(n)r.push(t(i,n));else{var o=Object.keys(i)[0],l=i[o],h=function(t){if(null!==t&&"object"==typeof t){var e=Object.keys(t);return 1===e.length?e[0]:void 0!==t.$gte&&void 0!==t.$lte?"between":void 0!==t.$lt&&void 0!==t.$gt?"not_between":void 0!==t.$regex?"$regex":void 0}return"eq"}(l);void 0===h&&a.error("MongoParse","Invalid MongoDB query format");var d=e.settings.mongoRuleOperators[h];void 0===d&&a.error("UndefinedMongoOperator",'JSON Rule operation unknown for operator "{0}"',h);var u=d.call(e,l),c=e.getMongoDBFieldID(o,l),p=e.change("mongoToRule",{id:c,field:o,operator:u.op,value:u.val},i);r.push(p)}}}),e.change("mongoToGroup",{condition:n.replace("$","").toUpperCase(),rules:r},i)}(t,i)},setRulesFromMongo:function(t){this.setRules(this.getRulesFromMongo(t))},getMongoDBFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field===t});return 1===i.length?i[0].id:this.change("getMongoDBFieldID",t,e)}}),o.define("not-group",function(e){var i=this;this.on("afterInit",function(){i.$el.on("click.queryBuilder","[data-not=group]",function(){var e=t(this).closest(o.selectors.group_container),s=i.getModel(e);s.not=!s.not}),i.model.on("update",function(t,e,s){e instanceof h&&"not"===s&&i.updateGroupNot(e)})}),this.on("afterAddGroup",function(t,e){e.__.not=!1}),this.on("getGroupTemplate.filter",function(s,n){var r=t(s.value);r.find(o.selectors.condition_container).prepend('<button type="button" class="btn btn-xs btn-default" data-not="group"><i class="'+e.icon_unchecked+'"></i> '+i.translate("NOT")+"</button>"),s.value=r.prop("outerHTML")}),this.on("groupToJson.filter",function(t,e){t.value.not=e.not}),this.on("jsonToGroup.filter",function(t,e){t.value.not=!!e.not}),this.on("groupToSQL.filter",function(t,e){e.not&&(t.value="NOT ( "+t.value+" )")}),this.on("parseSQLNode.filter",function(t){t.value.name&&"NOT"==t.value.name.toUpperCase()&&(t.value=t.value.arguments.value[0],t.value.not=!0)}),this.on("sqlToGroup.filter",function(t,e){t.value.not=!!e.not}),this.on("groupToMongo.filter",function(t,e){var i="$"+e.condition.toLowerCase();e.not&&t.value[i]&&(t.value={$nor:[t.value]})}),this.on("parseMongoNode.filter",function(t){var e=Object.keys(t.value);"$nor"==e[0]&&(t.value=t.value[e[0]][0],t.value.not=!0)}),this.on("mongoToGroup.filter",function(t,e){t.value.not=!!e.not})},{icon_unchecked:"glyphicon glyphicon-unchecked",icon_checked:"glyphicon glyphicon-check"}),a.defineModelProperties(h,["not"]),o.selectors.group_not=o.selectors.group_header+" [data-not=group]",o.extend({updateGroupNot:function(t){var e=this.plugins["not-group"];t.$el.find(">"+o.selectors.group_not).toggleClass("active",t.not).find("i").attr("class",t.not?e.icon_checked:e.icon_unchecked),this.trigger("afterUpdateGroupNot",t),this.trigger("rulesChanged")}}),o.define("sortable",function(e){var i,s,r;"interact"in window||a.error("MissingLibrary",'interact.js is required to use "sortable" plugin. Get it here: http://interactjs.io'),void 0!==e.default_no_sortable&&(a.error(!1,"Config",'Sortable plugin : "default_no_sortable" options is deprecated, use standard "default_rule_flags" and "default_group_flags" instead'),this.settings.default_rule_flags.no_sortable=this.settings.default_group_flags.no_sortable=e.default_no_sortable),interact.dynamicDrop(!0),interact.pointerMoveTolerance(10),this.on("afterAddRule afterAddGroup",function(a,l){if(l!=i){var d=a.builder;e.inherit_no_sortable&&l.parent&&l.parent.flags.no_sortable&&(l.flags.no_sortable=!0),e.inherit_no_drop&&l.parent&&l.parent.flags.no_drop&&(l.flags.no_drop=!0),l.flags.no_sortable||interact(l.$el[0]).allowFrom(o.selectors.drag_handle).draggable({onstart:function(e){r=d.getModel(e.target),s=r.$el.clone().appendTo(r.$el.parent()).width(r.$el.outerWidth()).addClass("dragging");var n=t('<div class="rule-placeholder">&nbsp;</div>').height(r.$el.outerHeight());i=r.parent.addRule(n,r.getPos()),r.$el.hide()},onmove:function(t){s[0].style.top=t.clientY-15+"px",s[0].style.left=t.clientX-15+"px"},onend:function(){s.remove(),s=void 0,i.drop(),i=void 0,r.$el.show(),d.trigger("afterMove",r),d.trigger("rulesChanged")}}),l.flags.no_drop||(interact(l.$el[0]).dropzone({accept:o.selectors.rule_and_group_containers,ondragenter:function(e){n(i,t(e.target),d)},ondrop:function(e){n(r,t(e.target),d)}}),l instanceof h&&interact(l.$el.find(o.selectors.group_header)[0]).dropzone({accept:o.selectors.rule_and_group_containers,ondragenter:function(e){n(i,t(e.target),d)},ondrop:function(e){n(r,t(e.target),d)}}))}}),this.on("beforeDeleteRule beforeDeleteGroup",function(t,e){t.isDefaultPrevented()||(interact(e.$el[0]).unset(),e instanceof h&&interact(e.$el.find(o.selectors.group_header)[0]).unset())}),this.on("afterApplyRuleFlags afterApplyGroupFlags",function(t,e){e.flags.no_sortable&&e.$el.find(".drag-handle").remove()}),this.on("getGroupTemplate.filter",function(i,s){if(s>1){var n=t(i.value);n.find(o.selectors.condition_container).after('<div class="drag-handle"><i class="'+e.icon+'"></i></div>'),i.value=n.prop("outerHTML")}}),this.on("getRuleTemplate.filter",function(i){var s=t(i.value);s.find(o.selectors.rule_header).after('<div class="drag-handle"><i class="'+e.icon+'"></i></div>'),i.value=s.prop("outerHTML")})},{inherit_no_sortable:!0,inherit_no_drop:!0,icon:"glyphicon glyphicon-sort"}),o.selectors.rule_and_group_containers=o.selectors.rule_container+", "+o.selectors.group_container,o.selectors.drag_handle=".drag-handle",o.defaults({default_rule_flags:{no_sortable:!1,no_drop:!1},default_group_flags:{no_sortable:!1,no_drop:!1}}),o.define("sql-support",function(t){},{boolean_as_integer:!0}),o.defaults({sqlOperators:{equal:{op:"= ?"},not_equal:{op:"!= ?"},in:{op:"IN(?)",sep:", "},not_in:{op:"NOT IN(?)",sep:", "},less:{op:"< ?"},less_or_equal:{op:"<= ?"},greater:{op:"> ?"},greater_or_equal:{op:">= ?"},between:{op:"BETWEEN ?",sep:" AND "},not_between:{op:"NOT BETWEEN ?",sep:" AND "},begins_with:{op:"LIKE(?)",mod:"{0}%"},not_begins_with:{op:"NOT LIKE(?)",mod:"{0}%"},contains:{op:"LIKE(?)",mod:"%{0}%"},not_contains:{op:"NOT LIKE(?)",mod:"%{0}%"},ends_with:{op:"LIKE(?)",mod:"%{0}"},not_ends_with:{op:"NOT LIKE(?)",mod:"%{0}"},is_empty:{op:"= ''"},is_not_empty:{op:"!= ''"},is_null:{op:"IS NULL"},is_not_null:{op:"IS NOT NULL"}},sqlRuleOperator:{"=":function(t){return{val:t,op:""===t?"is_empty":"equal"}},"!=":function(t){return{val:t,op:""===t?"is_not_empty":"not_equal"}},LIKE:function(t){return"%"==t.slice(0,1)&&"%"==t.slice(-1)?{val:t.slice(1,-1),op:"contains"}:"%"==t.slice(0,1)?{val:t.slice(1),op:"ends_with"}:"%"==t.slice(-1)?{val:t.slice(0,-1),op:"begins_with"}:void a.error("SQLParse",'Invalid value for LIKE operator "{0}"',t)},"NOT LIKE":function(t){return"%"==t.slice(0,1)&&"%"==t.slice(-1)?{val:t.slice(1,-1),op:"not_contains"}:"%"==t.slice(0,1)?{val:t.slice(1),op:"not_ends_with"}:"%"==t.slice(-1)?{val:t.slice(0,-1),op:"not_begins_with"}:void a.error("SQLParse",'Invalid value for NOT LIKE operator "{0}"',t)},IN:function(t){return{val:t,op:"in"}},"NOT IN":function(t){return{val:t,op:"not_in"}},"<":function(t){return{val:t,op:"less"}},"<=":function(t){return{val:t,op:"less_or_equal"}},">":function(t){return{val:t,op:"greater"}},">=":function(t){return{val:t,op:"greater_or_equal"}},BETWEEN:function(t){return{val:t,op:"between"}},"NOT BETWEEN":function(t){return{val:t,op:"not_between"}},IS:function(t){return null!==t&&a.error("SQLParse","Invalid value for IS operator"),{val:null,op:"is_null"}},"IS NOT":function(t){return null!==t&&a.error("SQLParse","Invalid value for IS operator"),{val:null,op:"is_not_null"}}},sqlStatements:{question_mark:function(){var t=[];return{add:function(e,i){return t.push(i),"?"},run:function(){return t}}},numbered:function(t){(!t||t.length>1)&&(t="$");var e=0,i=[];return{add:function(s,n){return i.push(n),t+ ++e},run:function(){return i}}},named:function(t){(!t||t.length>1)&&(t=":");var e={},i={};return{add:function(s,n){e[s.field]||(e[s.field]=1);var r=s.field+"_"+e[s.field]++;return i[r]=n,t+r},run:function(){return i}}}},sqlRuleStatement:{question_mark:function(t){var e=0;return{parse:function(i){return"?"==i?t[e++]:i},esc:function(t){return t.replace(/\?/g,"'?'")}}},numbered:function(t,e){(!e||e.length>1)&&(e="$");var i=new RegExp("^\\"+e+"[0-9]+$"),s=new RegExp("\\"+e+"([0-9]+)","g");return{parse:function(e){return i.test(e)?t[e.slice(1)-1]:e},esc:function(t){return t.replace(s,"'"+("$"==e?"$$":e)+"$1'")}}},named:function(t,e){(!e||e.length>1)&&(e=":");var i=new RegExp("^\\"+e),s=new RegExp("\\"+e+"("+Object.keys(t).join("|")+")","g");return{parse:function(e){return i.test(e)?t[e.slice(1)]:e},esc:function(t){return t.replace(s,"'"+("$"==e?"$$":e)+"$1'")}}}}}),o.extend({getSQL:function(t,e,i){if(!(i=void 0===i?this.getRules():i))return null;e=e?"\n":" ";var s=this.getPluginOptions("sql-support","boolean_as_integer");if(!0===t&&(t="question_mark"),"string"==typeof t){var n=r(t);t=this.settings.sqlStatements[n[1]](n[2])}var o=this,l=function i(n){if(n.condition||(n.condition=o.settings.default_condition),-1===["AND","OR"].indexOf(n.condition.toUpperCase())&&a.error("UndefinedSQLCondition",'Unable to build SQL query with condition "{0}"',n.condition),!n.rules)return"";var r=[];n.rules.forEach(function(n){if(n.rules&&n.rules.length>0)r.push("("+e+i(n)+e+")"+e);else{var l=o.settings.sqlOperators[n.operator],h=o.getOperatorByType(n.operator),d="";void 0===l&&a.error("UndefinedSQLOperator",'Unknown SQL operation for operator "{0}"',n.operator),0!==h.nb_inputs&&(n.value instanceof Array||(n.value=[n.value]),n.value.forEach(function(e,i){i>0&&(d+=l.sep),"integer"==n.type||"double"==n.type||"boolean"==n.type?e=a.changeType(e,n.type,s):t||(e=a.escapeString(e)),l.mod&&(e=a.fmt(l.mod,e)),t?d+=t.add(n,e):("string"==typeof e&&(e="'"+e+"'"),d+=e)}));var u=function(t){return l.op.replace(/\?/,t)},c=o.change("getSQLField",n.field,n)+" "+u(d);r.push(o.change("ruleToSQL",c,n,d,u))}});var l=r.join(" "+n.condition+e);return o.change("groupToSQL",l,n)}(i);return t?{sql:l,params:t.run()}:{sql:l}},getRulesFromSQL:function(e,i){"SQLParser"in window||a.error("MissingLibrary","SQLParser is required to parse SQL queries. Get it here https://github.com/mistic100/sql-parser");var s=this;if("string"==typeof e&&(e={sql:e}),!0===i&&(i="question_mark"),"string"==typeof i){var n=r(i);i=this.settings.sqlRuleStatement[n[1]](e.params,n[2])}i&&(e.sql=i.esc(e.sql)),0!==e.sql.toUpperCase().indexOf("SELECT")&&(e.sql="SELECT * FROM table WHERE "+e.sql);var o=SQLParser.parse(e.sql);o.where||a.error("SQLParse","No WHERE clause found");var l=s.change("parseSQLNode",o.where.conditions);if("rules"in l&&"condition"in l)return l;if("id"in l&&"operator"in l&&"value"in l)return{condition:this.settings.default_condition,rules:[l]};var h=s.change("sqlToGroup",{condition:this.settings.default_condition,rules:[]},l),d=h;return function e(n,r){if("rules"in(n=s.change("parseSQLNode",n))&&"condition"in n)d.rules.push(n);else if("id"in n&&"operator"in n&&"value"in n)d.rules.push(n);else if("left"in n&&"right"in n&&"operation"in n||a.error("SQLParse","Unable to parse WHERE clause"),-1!==["AND","OR"].indexOf(n.operation.toUpperCase())){if(r>0&&d.condition!=n.operation.toUpperCase()){var o=s.change("sqlToGroup",{condition:s.settings.default_condition,rules:[]},n);d.rules.push(o),d=o}d.condition=n.operation.toUpperCase(),r++;var l=d;e(n.left,r),d=l,e(n.right,r)}else{var h;t.isPlainObject(n.right.value)&&a.error("SQLParse","Value format not supported for {0}.",n.left.value),h=t.isArray(n.right.value)?n.right.value.map(function(t){return t.value}):n.right.value,i&&(h=t.isArray(h)?h.map(i.parse):i.parse(h));var u=n.operation.toUpperCase();"<>"==u&&(u="!=");var c=s.settings.sqlRuleOperator[u];void 0===c&&a.error("UndefinedSQLOperator",'Invalid SQL operation "{0}".',n.operation);var p,f=c.call(this,h,n.operation);"values"in n.left?p=n.left.values.join("."):"value"in n.left?p=n.left.value:a.error("SQLParse","Cannot find field name in {0}",JSON.stringify(n.left));var m=s.getSQLFieldID(p,h),g=s.change("sqlToRule",{id:m,field:p,operator:f.op,value:f.val},n);d.rules.push(g)}}(l,0),h},setRulesFromSQL:function(t,e){this.setRules(this.getRulesFromSQL(t,e))},getSQLFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field.toLowerCase()===t.toLowerCase()});return 1===i.length?i[0].id:this.change("getSQLFieldID",t,e)}}),o.define("unique-filter",function(){this.status.used_filters={},this.on("afterUpdateRuleFilter",this.updateDisabledFilters),this.on("afterDeleteRule",this.updateDisabledFilters),this.on("afterCreateRuleFilters",this.applyDisabledFilters),this.on("afterReset",this.clearDisabledFilters),this.on("afterClear",this.clearDisabledFilters),this.on("getDefaultFilter.filter",function(t,e){var i=t.builder;(i.updateDisabledFilters(),t.value.id in i.status.used_filters)&&(i.filters.some(function(s){if(!(s.id in i.status.used_filters)||i.status.used_filters[s.id].length>0&&-1===i.status.used_filters[s.id].indexOf(e.parent))return t.value=s,!0})||(a.error(!1,"UniqueFilter","No more non-unique filters available"),t.value=void 0))})}),o.extend({updateDisabledFilters:function(t){var e=t?t.builder:this;e.status.used_filters={},e.model&&(function t(i){i.each(function(t){t.filter&&t.filter.unique&&(e.status.used_filters[t.filter.id]||(e.status.used_filters[t.filter.id]=[]),"group"==t.filter.unique&&e.status.used_filters[t.filter.id].push(t.parent))},function(e){t(e)})}(e.model.root),e.applyDisabledFilters(t))},clearDisabledFilters:function(t){var e=t?t.builder:this;e.status.used_filters={},e.applyDisabledFilters(t)},applyDisabledFilters:function(e){var i=e?e.builder:this;i.$el.find(o.selectors.filter_container+" option").prop("disabled",!1),t.each(i.status.used_filters,function(t,e){0===e.length?i.$el.find(o.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",!0):e.forEach(function(e){e.each(function(e){e.$el.find(o.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",!0)})})}),i.settings.plugins&&i.settings.plugins["bt-selectpicker"]&&i.$el.find(o.selectors.rule_filter).selectpicker("render")}}),o.regional.en={__locale:"English (en)",__author:'Damien "Mistic" Sorel, http://www.strangeplanet.fr',add_rule:"Add rule",add_group:"Add group",delete_rule:"Delete",delete_group:"Delete",conditions:{AND:"AND",OR:"OR"},operators:{equal:"equal",not_equal:"not equal",in:"in",not_in:"not in",less:"less",less_or_equal:"less or equal",greater:"greater",greater_or_equal:"greater or equal",between:"between",not_between:"not between",begins_with:"begins with",not_begins_with:"doesn't begin with",contains:"contains",not_contains:"doesn't contain",ends_with:"ends with",not_ends_with:"doesn't end with",is_empty:"is empty",is_not_empty:"is not empty",is_null:"is null",is_not_null:"is not null"},errors:{no_filter:"No filter selected",empty_group:"The group is empty",radio_empty:"No value selected",checkbox_empty:"No value selected",select_empty:"No value selected",string_empty:"Empty value",string_exceed_min_length:"Must contain at least {0} characters",string_exceed_max_length:"Must not contain more than {0} characters",string_invalid_format:"Invalid format ({0})",number_nan:"Not a number",number_not_integer:"Not an integer",number_not_double:"Not a real number",number_exceed_min:"Must be greater than {0}",number_exceed_max:"Must be lower than {0}",number_wrong_step:"Must be a multiple of {0}",number_between_invalid:"Invalid values, {0} is greater than {1}",datetime_empty:"Empty value",datetime_invalid:"Invalid date format ({0})",datetime_exceed_min:"Must be after {0}",datetime_exceed_max:"Must be before {0}",datetime_between_invalid:"Invalid values, {0} isgreater than {1}",boolean_not_valid:"Not a boolean",operator_not_multiple:'Operator "{1}" cannot accept multiple values'},invert:"Invert",NOT:"NOT"},o.defaults({lang_code:"en"}),o}),function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(!(t=n(String(t||"").toLowerCase()))||!t.length)return[];var e,i,s,o,l=[],h=t.split(/ +/);for(e=0,i=h.length;e<i;e++){if(s=r(h[e]),this.settings.diacritics)for(o in a)a.hasOwnProperty(o)&&(s=s.replace(new RegExp(o,"g"),a[o]));l.push({string:h[e],regex:new RegExp(s,"i")})}return l},t.prototype.iterator=function(t,e){(o(t)?Array.prototype.forEach||function(t){for(var e=0,i=this.length;e<i;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)}).apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var i,n,r,o;t=this.prepareSearch(t,e),n=t.tokens,i=t.options.fields,r=n.length,o=t.options.nesting;var a,l=function(t,e){var i,s;return t?-1===(s=(t=String(t||"")).search(e.regex))?0:(i=e.string.length/t.length,0===s&&(i+=.5),i):0},h=(a=i.length)?1===a?function(t,e){return l(s(e,i[0],o),t)}:function(t,e){for(var n=0,r=0;n<a;n++)r+=l(s(e,i[n],o),t);return r/a}:function(){return 0};return r?1===r?function(t){return h(n[0],t)}:"and"===t.options.conjunction?function(t){for(var e,i=0,s=0;i<r;i++){if((e=h(n[i],t))<=0)return 0;s+=e}return s/r}:function(t){for(var e=0,i=0;e<r;e++)i+=h(n[e],t);return i/r}:function(){return 0}},t.prototype.getSortFunction=function(t,i){var n,r,o,a,l,h,d,u,c,p,f;if(f=!(t=(o=this).prepareSearch(t,i)).query&&i.sort_empty||i.sort,c=function(t,e){return"$score"===t?e.score:s(o.items[e.id],t,i.nesting)},l=[],f)for(n=0,r=f.length;n<r;n++)(t.query||"$score"!==f[n].field)&&l.push(f[n]);if(t.query){for(p=!0,n=0,r=l.length;n<r;n++)if("$score"===l[n].field){p=!1;break}p&&l.unshift({field:"$score",direction:"desc"})}else for(n=0,r=l.length;n<r;n++)if("$score"===l[n].field){l.splice(n,1);break}for(u=[],n=0,r=l.length;n<r;n++)u.push("desc"===l[n].direction?-1:1);return(h=l.length)?1===h?(a=l[0].field,d=u[0],function(t,i){return d*e(c(a,t),c(a,i))}):function(t,i){var s,n,r;for(s=0;s<h;s++)if(r=l[s].field,n=u[s]*e(c(r,t),c(r,i)))return n;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;var s=(e=i({},e)).fields,n=e.sort,r=e.sort_empty;return s&&!o(s)&&(e.fields=[s]),n&&!o(n)&&(e.sort=[n]),r&&!o(r)&&(e.sort_empty=[r]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var i,s,n,r;return s=this.prepareSearch(t,e),e=s.options,t=s.query,r=e.score||this.getScoreFunction(s),t.length?this.iterator(this.items,function(t,n){i=r(t),(!1===e.filter||i>0)&&s.items.push({score:i,id:n})}):this.iterator(this.items,function(t,e){s.items.push({score:1,id:e})}),(n=this.getSortFunction(s,e))&&s.items.sort(n),s.total=s.items.length,"number"==typeof e.limit&&(s.items=s.items.slice(0,e.limit)),s};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?t>e?1:t<e?-1:0:(t=l(String(t||"")))>(e=l(String(e||"")))?1:e>t?-1:0},i=function(t,e){var i,s,n,r;for(i=1,s=arguments.length;i<s;i++)if(r=arguments[i])for(n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);return t},s=function(t,e,i){if(t&&e){if(!i)return t[e];for(var s=e.split(".");s.length&&(t=t[s.shift()]););return t}},n=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},r=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},o=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},l=function(){var t,e,i,s,n="",r={};for(i in a)if(a.hasOwnProperty(i))for(s=a[i].substring(2,a[i].length-1),n+=s,t=0,e=s.length;t<e;t++)r[s.charAt(t)]=i;var o=new RegExp("["+n+"]","g");return function(t){return t.replace(o,function(t){return r[t]}).toLowerCase()}}();return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={};t.mixin=function(t){t.plugins={},t.prototype.initializePlugins=function(t){var i,s,n,r=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},e.isArray(t))for(i=0,s=t.length;i<s;i++)"string"==typeof t[i]?r.push(t[i]):(this.plugins.settings[t[i].name]=t[i].options,r.push(t[i].name));else if(t)for(n in t)t.hasOwnProperty(n)&&(this.plugins.settings[n]=t[n],r.push(n));for(;r.length;)this.require(r.shift())},t.prototype.loadPlugin=function(e){var i=this.plugins,s=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=s.fn.apply(this,[this.plugins.settings[e]||{}]),i.names.push(e)},t.prototype.require=function(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]},t.define=function(e,i){t.plugins[e]={name:e,fn:i}}};var e={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function(t,e,i){var s=function(t,e){if("string"!=typeof e||e.length){var i="string"==typeof e?new RegExp(e,"i"):e,s=function(t){var e=0;if(3===t.nodeType){var n=t.data.search(i);if(n>=0&&t.data.length>0){var r=t.data.match(i),o=document.createElement("span");o.className="highlight";var a=t.splitText(n),l=(a.splitText(r[0].length),a.cloneNode(!0));o.appendChild(l),a.parentNode.replaceChild(o,a),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))for(var h=0;h<t.childNodes.length;++h)h+=s(t.childNodes[h]);return e};return t.each(function(){s(this)})}};t.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()}).end()};var n=function(){};n.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(t){for(var e=["on","off","trigger"],i=0;i<e.length;i++)t.prototype[e[i]]=n.prototype[e[i]]};var r=/Mac/.test(navigator.userAgent),o=r?91:17,a=r?18:17,l=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,h=function(t){return void 0!==t},d=function(t){return void 0===t||null===t?null:"boolean"==typeof t?t?"1":"0":t+""},u=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},c={};c.before=function(t,e,i){var s=t[e];t[e]=function(){return i.apply(t,arguments),s.apply(t,arguments)}},c.after=function(t,e,i){var s=t[e];t[e]=function(){var e=s.apply(t,arguments);return i.apply(t,arguments),e}};var p=function(t,e,i){var s,n=t.trigger,r={};t.trigger=function(){var i=arguments[0];return-1===e.indexOf(i)?n.apply(t,arguments):void(r[i]=arguments)},i.apply(t,[]),t.trigger=n;for(s in r)r.hasOwnProperty(s)&&n.apply(t,r[s])},f=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var i=document.selection.createRange(),s=document.selection.createRange().text.length;i.moveStart("character",-t.value.length),e.start=i.text.length-s,e.length=s}return e},m=function(e){var i=null,s=function(s,n){var r,o,a,l,h,d,u,c;s=s||window.event||{},n=n||{},s.metaKey||s.altKey||(n.force||!1!==e.data("grow"))&&(r=e.val(),s.type&&"keydown"===s.type.toLowerCase()&&(a=(o=s.keyCode)>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||32===o,46===o||8===o?(c=f(e[0])).length?r=r.substring(0,c.start)+r.substring(c.start+c.length):8===o&&c.start?r=r.substring(0,c.start-1)+r.substring(c.start+1):46===o&&void 0!==c.start&&(r=r.substring(0,c.start)+r.substring(c.start+1)):a&&(d=s.shiftKey,u=String.fromCharCode(s.keyCode),r+=u=d?u.toUpperCase():u.toLowerCase())),l=e.attr("placeholder"),!r&&l&&(r=l),(h=function(e,i){if(!e)return 0;var s=t("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(e).appendTo("body");!function(t,e,i){var s,n,r={};if(i)for(s=0,n=i.length;s<n;s++)r[i[s]]=t.css(i[s]);else r=t.css();e.css(r)}(i,s,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var n=s.width();return s.remove(),n}(r,e)+4)!==i&&(i=h,e.width(h),e.triggerHandler("resize")))};e.on("keydown keyup update blur",s),s()},g=function(i,s){var n,r,o,a;(a=i[0]).selectize=this;var l,h,d,u=window.getComputedStyle&&window.getComputedStyle(a,null);if(o=(o=u?u.getPropertyValue("direction"):a.currentStyle&&a.currentStyle.direction)||i.parents("[dir]:first").attr("dir")||"",t.extend(this,{order:0,settings:s,$input:i,tabIndex:i.attr("tabindex")||"",tagType:"select"===a.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(o),eventNS:".selectize"+ ++g.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:i.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===s.loadThrottle?this.onSearchChange:(l=this.onSearchChange,h=s.loadThrottle,function(){var t=this,e=arguments;window.clearTimeout(d),d=window.setTimeout(function(){l.apply(t,e)},h)})}),this.sifter=new e(this.options,{diacritics:s.diacritics}),this.settings.options){for(n=0,r=this.settings.options.length;n<r;n++)this.registerOption(this.settings.options[n]);delete this.settings.options}if(this.settings.optgroups){for(n=0,r=this.settings.optgroups.length;n<r;n++)this.registerOptionGroup(this.settings.optgroups[n]);delete this.settings.optgroups}this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi"),"boolean"!=typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode),this.initializePlugins(this.settings.plugins),this.setupCallbacks(),this.setupTemplates(),this.setup()};return n.mixin(g),void 0!==i?i.mixin(g):function(t,e){e||(e={});console.error("Selectize: "+t),e.explanation&&(console.group&&console.group(),console.error(e.explanation),console.group&&console.groupEnd())}("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),t.extend(g.prototype,{setup:function(){var e,i,s,n,h,d,u,c,p,f,g,v,y,_,b=this,w=b.settings,x=b.eventNS,C=t(window),k=t(document),E=b.$input;if(u=b.settings.mode,c=E.attr("class")||"",e=t("<div>").addClass(w.wrapperClass).addClass(c).addClass(u),i=t("<div>").addClass(w.inputClass).addClass("items").appendTo(e),s=t('<input type="text" autocomplete="off" />').appendTo(i).attr("tabindex",E.is(":disabled")?"-1":b.tabIndex),d=t(w.dropdownParent||e),n=t("<div>").addClass(w.dropdownClass).addClass(u).hide().appendTo(d),h=t("<div>").addClass(w.dropdownContentClass).appendTo(n),(f=E.attr("id"))&&(s.attr("id",f+"-selectized"),t("label[for='"+f+"']").attr("for",f+"-selectized")),b.settings.copyClassesToDropdown&&n.addClass(c),e.css({width:E[0].style.width}),b.plugins.names.length&&(p="plugin-"+b.plugins.names.join(" plugin-"),e.addClass(p),n.addClass(p)),(null===w.maxItems||w.maxItems>1)&&1===b.tagType&&E.attr("multiple","multiple"),b.settings.placeholder&&s.attr("placeholder",w.placeholder),!b.settings.splitOn&&b.settings.delimiter){var T=b.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");b.settings.splitOn=new RegExp("\\s*"+T+"+\\s*")}E.attr("autocorrect")&&s.attr("autocorrect",E.attr("autocorrect")),E.attr("autocapitalize")&&s.attr("autocapitalize",E.attr("autocapitalize")),b.$wrapper=e,b.$control=i,b.$control_input=s,b.$dropdown=n,b.$dropdown_content=h,n.on("mouseenter","[data-selectable]",function(){return b.onOptionHover.apply(b,arguments)}),n.on("mousedown click","[data-selectable]",function(){return b.onOptionSelect.apply(b,arguments)}),v="mousedown",y="*:not(input)",_=function(){return b.onItemSelect.apply(b,arguments)},(g=i).on(v,y,function(t){for(var e=t.target;e&&e.parentNode!==g[0];)e=e.parentNode;return t.currentTarget=e,_.apply(this,[t])}),m(s),i.on({mousedown:function(){return b.onMouseDown.apply(b,arguments)},click:function(){return b.onClick.apply(b,arguments)}}),s.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return b.onKeyDown.apply(b,arguments)},keyup:function(){return b.onKeyUp.apply(b,arguments)},keypress:function(){return b.onKeyPress.apply(b,arguments)},resize:function(){b.positionDropdown.apply(b,[])},blur:function(){return b.onBlur.apply(b,arguments)},focus:function(){return b.ignoreBlur=!1,b.onFocus.apply(b,arguments)},paste:function(){return b.onPaste.apply(b,arguments)}}),k.on("keydown"+x,function(t){b.isCmdDown=t[r?"metaKey":"ctrlKey"],b.isCtrlDown=t[r?"altKey":"ctrlKey"],b.isShiftDown=t.shiftKey}),k.on("keyup"+x,function(t){t.keyCode===a&&(b.isCtrlDown=!1),16===t.keyCode&&(b.isShiftDown=!1),t.keyCode===o&&(b.isCmdDown=!1)}),k.on("mousedown"+x,function(t){if(b.isFocused){if(t.target===b.$dropdown[0]||t.target.parentNode===b.$dropdown[0])return!1;b.$control.has(t.target).length||t.target===b.$control[0]||b.blur(t.target)}}),C.on(["scroll"+x,"resize"+x].join(" "),function(){b.isOpen&&b.positionDropdown.apply(b,arguments)}),C.on("mousemove"+x,function(){b.ignoreHover=!1}),this.revertSettings={$children:E.children().detach(),tabindex:E.attr("tabindex")},E.attr("tabindex",-1).hide().after(b.$wrapper),t.isArray(w.items)&&(b.setValue(w.items),delete w.items),l&&E.on("invalid"+x,function(t){t.preventDefault(),b.isInvalid=!0,b.refreshState()}),b.updateOriginalInput(),b.refreshItems(),b.refreshState(),b.updatePlaceholder(),b.isSetup=!0,E.is(":disabled")&&b.disable(),b.on("change",this.onChange),E.data("selectize",b),E.addClass("selectized"),b.trigger("initialize"),!0===w.preload&&b.onSearchChange("")},setupTemplates:function(){var e=this.settings.labelField,i=this.settings.optgroupLabelField,s={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[i])+"</div>"},option:function(t,i){return'<div class="option">'+i(t[e])+"</div>"},item:function(t,i){return'<div class="item">'+i(t[e])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};this.settings.render=t.extend({},s,this.settings.render)},setupCallbacks:function(){var t,e,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in i)i.hasOwnProperty(t)&&(e=this.settings[i[t]],e&&this.on(t,e))},onClick:function(t){this.isFocused||(this.focus(),t.preventDefault())},onMouseDown:function(e){var i=this,s=e.isDefaultPrevented();if(t(e.target),i.isFocused){if(e.target!==i.$control_input[0])return"single"===i.settings.mode?i.isOpen?i.close():i.open():s||i.setActiveItem(null),!1}else s||window.setTimeout(function(){i.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var i=this;return i.isFull()||i.isInputHidden||i.isLocked?void e.preventDefault():void(i.settings.splitOn&&setTimeout(function(){var e=i.$control_input.val();if(e.match(i.settings.splitOn))for(var s=t.trim(e).split(i.settings.splitOn),n=0,r=s.length;n<r;n++)i.createItem(s[n])},0))},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){var e=(t.target,this.$control_input[0],this);if(!e.isLocked){switch(t.keyCode){case 65:if(e.isCmdDown)return void e.selectAll();break;case 27:return void(e.isOpen&&(t.preventDefault(),t.stopPropagation(),e.close()));case 78:if(!t.ctrlKey||t.altKey)break;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.$activeOption){e.ignoreHover=!0;var i=e.getAdjacentOption(e.$activeOption,1);i.length&&e.setActiveOption(i,!0,!0)}return void t.preventDefault();case 80:if(!t.ctrlKey||t.altKey)break;case 38:if(e.$activeOption){e.ignoreHover=!0;var s=e.getAdjacentOption(e.$activeOption,-1);s.length&&e.setActiveOption(s,!0,!0)}return void t.preventDefault();case 13:return void(e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),t.preventDefault()));case 37:return void e.advanceSelection(-1,t);case 39:return void e.advanceSelection(1,t);case 9:return e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||t.preventDefault()),void(e.settings.create&&e.createItem()&&t.preventDefault());case 8:case 46:return void e.deleteSelection(t)}return!e.isFull()&&!e.isInputHidden||(r?t.metaKey:t.ctrlKey)?void 0:void t.preventDefault()}9!==t.keyCode&&t.preventDefault()},onKeyUp:function(t){if(this.isLocked)return t&&t.preventDefault();var e=this.$control_input.val()||"";this.lastValue!==e&&(this.lastValue=e,this.onSearchChange(e),this.refreshOptions(),this.trigger("type",e))},onSearchChange:function(t){var e=this,i=e.settings.load;i&&(e.loadedSearches.hasOwnProperty(t)||(e.loadedSearches[t]=!0,e.load(function(s){i.apply(e,[t,s])})))},onFocus:function(t){var e=this.isFocused;return this.isDisabled?(this.blur(),t&&t.preventDefault(),!1):void(this.ignoreFocus||(this.isFocused=!0,"focus"===this.settings.preload&&this.onSearchChange(""),e||this.trigger("focus"),this.$activeItems.length||(this.showInput(),this.setActiveItem(null),this.refreshOptions(!!this.settings.openOnFocus)),this.refreshState()))},onBlur:function(t,e){var i=this;if(i.isFocused&&(i.isFocused=!1,!i.ignoreFocus)){if(!i.ignoreBlur&&document.activeElement===i.$dropdown_content[0])return i.ignoreBlur=!0,void i.onFocus(t);var s=function(){i.close(),i.setTextboxValue(""),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),e&&e.focus&&e.focus(),i.ignoreFocus=!1,i.trigger("blur")};i.ignoreFocus=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,s):s()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(e){var i,s,n=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),(s=t(e.currentTarget)).hasClass("create")?n.createItem(null,function(){n.settings.closeAfterSelect&&n.close()}):void 0!==(i=s.attr("data-value"))&&(n.lastQuery=null,n.setTextboxValue(""),n.addItem(i),n.settings.closeAfterSelect?n.close():!n.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&n.setActiveOption(n.getOption(i)))},onItemSelect:function(t){this.isLocked||"multi"===this.settings.mode&&(t.preventDefault(),this.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,i=e.$wrapper.addClass(e.settings.loadingClass);e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||i.removeClass(e.settings.loadingClass),e.trigger("load",t)}])},setTextboxValue:function(t){var e=this.$control_input;e.val()!==t&&(e.val(t).triggerHandler("update"),this.lastValue=t)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){p(this,e?[]:["change"],function(){this.clear(e),this.addItems(t,e)})},setActiveItem:function(e,i){var s,n,r,o,a,l,h,d;if("single"!==this.settings.mode){if(!(e=t(e)).length)return t(this.$activeItems).removeClass("active"),this.$activeItems=[],void(this.isFocused&&this.showInput());if("mousedown"===(s=i&&i.type.toLowerCase())&&this.isShiftDown&&this.$activeItems.length){for(d=this.$control.children(".active:last"),(o=Array.prototype.indexOf.apply(this.$control[0].childNodes,[d[0]]))>(a=Array.prototype.indexOf.apply(this.$control[0].childNodes,[e[0]]))&&(h=o,o=a,a=h),n=o;n<=a;n++)l=this.$control[0].childNodes[n],-1===this.$activeItems.indexOf(l)&&(t(l).addClass("active"),this.$activeItems.push(l));i.preventDefault()}else"mousedown"===s&&this.isCtrlDown||"keydown"===s&&this.isShiftDown?e.hasClass("active")?(r=this.$activeItems.indexOf(e[0]),this.$activeItems.splice(r,1),e.removeClass("active")):this.$activeItems.push(e.addClass("active")[0]):(t(this.$activeItems).removeClass("active"),this.$activeItems=[e.addClass("active")[0]]);this.hideInput(),this.isFocused||this.focus()}},setActiveOption:function(e,i,s){var n,r,o,a,l;this.$activeOption&&this.$activeOption.removeClass("active"),this.$activeOption=null,(e=t(e)).length&&(this.$activeOption=e.addClass("active"),!i&&h(i)||(n=this.$dropdown_content.height(),r=this.$activeOption.outerHeight(!0),i=this.$dropdown_content.scrollTop()||0,a=o=this.$activeOption.offset().top-this.$dropdown_content.offset().top+i,l=o-n+r,o+r>n+i?this.$dropdown_content.stop().animate({scrollTop:l},s?this.settings.scrollDuration:0):o<i&&this.$dropdown_content.stop().animate({scrollTop:a},s?this.settings.scrollDuration:0)))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),this.close()),this.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(t){this.$control_input[0].blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e}},search:function(e){var i,s,n,r=this.settings,o=this.getSearchOptions();if(r.score&&"function"!=typeof(n=this.settings.score.apply(this,[e])))throw new Error('Selectize "score" setting must be a function that returns a function');if(e!==this.lastQuery?(this.lastQuery=e,s=this.sifter.search(e,t.extend(o,{score:n})),this.currentResults=s):s=t.extend(!0,{},this.currentResults),r.hideSelected)for(i=s.items.length-1;i>=0;i--)-1!==this.items.indexOf(d(s.items[i].id))&&s.items.splice(i,1);return s},refreshOptions:function(e){var i,n,r,o,a,l,h,u,c,p,f,m,g,v,y,_;void 0===e&&(e=!0);var b,w,x=this,C=t.trim(x.$control_input.val()),k=x.search(C),E=x.$dropdown_content,T=x.$activeOption&&d(x.$activeOption.attr("data-value"));for(o=k.items.length,"number"==typeof x.settings.maxOptions&&(o=Math.min(o,x.settings.maxOptions)),a={},l=[],i=0;i<o;i++)for(h=x.options[k.items[i].id],u=x.render("option",h),c=h[x.settings.optgroupField]||"",p=t.isArray(c)?c:[c],n=0,r=p&&p.length;n<r;n++)c=p[n],x.optgroups.hasOwnProperty(c)||(c=""),a.hasOwnProperty(c)||(a[c]=document.createDocumentFragment(),l.push(c)),a[c].appendChild(u);for(this.settings.lockOptgroupOrder&&l.sort(function(t,e){return(x.optgroups[t].$order||0)-(x.optgroups[e].$order||0)}),f=document.createDocumentFragment(),i=0,o=l.length;i<o;i++)c=l[i],x.optgroups.hasOwnProperty(c)&&a[c].childNodes.length?(m=document.createDocumentFragment(),m.appendChild(x.render("optgroup_header",x.optgroups[c])),m.appendChild(a[c]),f.appendChild(x.render("optgroup",t.extend({},x.optgroups[c],{html:(b=m,w=void 0,w=document.createElement("div"),w.appendChild(b.cloneNode(!0)),w.innerHTML),dom:m})))):f.appendChild(a[c]);if(E.html(f),x.settings.highlight&&k.query.length&&k.tokens.length)for(E.removeHighlight(),i=0,o=k.tokens.length;i<o;i++)s(E,k.tokens[i].regex);if(!x.settings.hideSelected)for(i=0,o=x.items.length;i<o;i++)x.getOption(x.items[i]).addClass("selected");(g=x.canCreate(C))&&(E.prepend(x.render("option_create",{input:C})),_=t(E[0].childNodes[0])),x.hasOptions=k.items.length>0||g,x.hasOptions?(k.items.length>0?((y=T&&x.getOption(T))&&y.length?v=y:"single"===x.settings.mode&&x.items.length&&(v=x.getOption(x.items[0])),v&&v.length||(v=_&&!x.settings.addPrecedence?x.getAdjacentOption(_,1):E.find("[data-selectable]:first"))):v=_,x.setActiveOption(v),e&&!x.isOpen&&x.open()):(x.setActiveOption(null),e&&x.isOpen&&x.close())},addOption:function(e){var i,s,n;if(t.isArray(e))for(i=0,s=e.length;i<s;i++)this.addOption(e[i]);else(n=this.registerOption(e))&&(this.userOptions[n]=!0,this.lastQuery=null,this.trigger("option_add",n,e))},registerOption:function(t){var e=d(t[this.settings.valueField]);return void 0!==e&&null!==e&&!this.options.hasOwnProperty(e)&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=d(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.renderCache={},this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(e,i){var s,n,r,o,a,l,h;if(e=d(e),r=d(i[this.settings.valueField]),null!==e&&this.options.hasOwnProperty(e)){if("string"!=typeof r)throw new Error("Value must be set in option data");h=this.options[e].$order,r!==e&&(delete this.options[e],-1!==(o=this.items.indexOf(e))&&this.items.splice(o,1,r)),i.$order=i.$order||h,this.options[r]=i,a=this.renderCache.item,l=this.renderCache.option,a&&(delete a[e],delete a[r]),l&&(delete l[e],delete l[r]),-1!==this.items.indexOf(r)&&(s=this.getItem(e),n=t(this.render("item",i)),s.hasClass("active")&&n.addClass("active"),s.replaceWith(n)),this.lastQuery=null,this.isOpen&&this.refreshOptions(!1)}},removeOption:function(t,e){t=d(t);var i=this.renderCache.item,s=this.renderCache.option;i&&delete i[t],s&&delete s[t],delete this.userOptions[t],delete this.options[t],this.lastQuery=null,this.trigger("option_remove",t),this.removeItem(t,e)},clearOptions:function(){this.loadedSearches={},this.userOptions={},this.renderCache={},this.options=this.sifter.items={},this.lastQuery=null,this.trigger("option_clear"),this.clear()},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(e,i){var s=this.$dropdown.find("[data-selectable]"),n=s.index(e)+i;return n>=0&&n<s.length?s.eq(n):t()},getElementWithValue:function(e,i){if(void 0!==(e=d(e))&&null!==e)for(var s=0,n=i.length;s<n;s++)if(i[s].getAttribute("data-value")===e)return t(i[s]);return t()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(e,i){for(var s=t.isArray(e)?e:[e],n=0,r=s.length;n<r;n++)this.isPending=n<r-1,this.addItem(s[n],i)},addItem:function(e,i){p(this,i?[]:["change"],function(){var s,n,r,o,a,l=this.settings.mode;return e=d(e),-1!==this.items.indexOf(e)?void("single"===l&&this.close()):void(this.options.hasOwnProperty(e)&&("single"===l&&this.clear(i),"multi"===l&&this.isFull()||(s=t(this.render("item",this.options[e])),a=this.isFull(),this.items.splice(this.caretPos,0,e),this.insertAtCaret(s),(!this.isPending||!a&&this.isFull())&&this.refreshState(),this.isSetup&&(r=this.$dropdown_content.find("[data-selectable]"),this.isPending||(n=this.getOption(e),o=this.getAdjacentOption(n,1).attr("data-value"),this.refreshOptions(this.isFocused&&"single"!==l),o&&this.setActiveOption(this.getOption(o))),!r.length||this.isFull()?this.close():this.positionDropdown(),this.updatePlaceholder(),this.trigger("item_add",e,s),this.updateOriginalInput({silent:i})))))})},removeItem:function(e,i){var s,n,r;s=e instanceof t?e:this.getItem(e),e=d(s.attr("data-value")),-1!==(n=this.items.indexOf(e))&&(s.remove(),s.hasClass("active")&&(r=this.$activeItems.indexOf(s[0]),this.$activeItems.splice(r,1)),this.items.splice(n,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(e)&&this.removeOption(e,i),n<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updatePlaceholder(),this.updateOriginalInput({silent:i}),this.positionDropdown(),this.trigger("item_remove",e,s))},createItem:function(e,i){var s=this,n=s.caretPos;e=e||t.trim(s.$control_input.val()||"");var r=arguments[arguments.length-1];if("function"!=typeof r&&(r=function(){}),"boolean"!=typeof i&&(i=!0),!s.canCreate(e))return r(),!1;s.lock();var o,a,l="function"==typeof s.settings.create?this.settings.create:function(t){var e={};return e[s.settings.labelField]=t,e[s.settings.valueField]=t,e},h=(o=function(t){if(s.unlock(),!t||"object"!=typeof t)return r();var e=d(t[s.settings.valueField]);return"string"!=typeof e?r():(s.setTextboxValue(""),s.addOption(t),s.setCaret(n),s.addItem(e),s.refreshOptions(i&&"single"!==s.settings.mode),void r(t))},a=!1,function(){a||(a=!0,o.apply(this,arguments))}),u=l.apply(this,[e,h]);return void 0!==u&&h(u),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.$control_input.prop("required",t),this.$input.prop("required",!t)},refreshClasses:function(){var e=this.isFull(),i=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl),this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",i).toggleClass("full",e).toggleClass("not-full",!e).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!t.isEmptyObject(this.options)).toggleClass("has-items",this.items.length>0),this.$control_input.data("grow",!e&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,i,s,n;if(t=t||{},1===this.tagType){for(s=[],e=0,i=this.items.length;e<i;e++)n=this.options[this.items[e]][this.settings.labelField]||"",s.push('<option value="'+u(this.items[e])+'" selected="selected">'+u(n)+"</option>");s.length||this.$input.attr("multiple")||s.push('<option value="" selected="selected"></option>'),this.$input.html(s.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&(t.silent||this.trigger("change",this.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.css({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.css({visibility:"visible"}),this.trigger("dropdown_open",this.$dropdown))},close:function(){var t=this.isOpen;"single"===this.settings.mode&&this.items.length&&(this.hideInput(),this.$control_input.blur()),this.isOpen=!1,this.$dropdown.hide(),this.setActiveOption(null),this.refreshState(),t&&this.trigger("dropdown_close",this.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t.outerWidth(),top:e.top,left:e.left})},clear:function(t){this.items.length&&(this.$control.children(":not(input)").remove(),this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updatePlaceholder(),this.updateOriginalInput({silent:t}),this.refreshState(),this.showInput(),this.trigger("clear"))},insertAtCaret:function(e){var i=Math.min(this.caretPos,this.items.length);0===i?this.$control.prepend(e):t(this.$control[0].childNodes[i]).before(e),this.setCaret(i+1)},deleteSelection:function(e){var i,s,n,r,o,a,l,h,d;if(n=e&&8===e.keyCode?-1:1,r=f(this.$control_input[0]),this.$activeOption&&!this.settings.hideSelected&&(l=this.getAdjacentOption(this.$activeOption,-1).attr("data-value")),o=[],this.$activeItems.length){for(d=this.$control.children(".active:"+(n>0?"last":"first")),a=this.$control.children(":not(input)").index(d),n>0&&a++,i=0,s=this.$activeItems.length;i<s;i++)o.push(t(this.$activeItems[i]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(n<0&&0===r.start&&0===r.length?o.push(this.items[this.caretPos-1]):n>0&&r.start===this.$control_input.val().length&&o.push(this.items[this.caretPos]));if(!o.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[o]))return!1;for(void 0!==a&&this.setCaret(a);o.length;)this.removeItem(o.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!0),l&&((h=this.getOption(l)).length&&this.setActiveOption(h)),!0},advanceSelection:function(t,e){var i,s,n,r,o;0!==t&&(this.rtl&&(t*=-1),i=t>0?"last":"first",s=f(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(r=this.$control_input.val().length,(t<0?0===s.start&&0===s.length:s.start===r)&&!r&&this.advanceCaret(t,e)):(o=this.$control.children(".active:"+i)).length&&(n=this.$control.children(":not(input)").index(o),this.setActiveItem(null),this.setCaret(t>0?n+1:n)))},advanceCaret:function(t,e){var i,s;0!==t&&(i=t>0?"next":"prev",this.isShiftDown?(s=this.$control_input[i]()).length&&(this.hideInput(),this.setActiveItem(s),e&&e.preventDefault()):this.setCaret(this.caretPos+t))},setCaret:function(e){var i,s,n,r;if(e="single"===this.settings.mode?this.items.length:Math.max(0,Math.min(this.items.length,e)),!this.isPending)for(i=0,s=(n=this.$control.children(":not(input)")).length;i<s;i++)r=t(n[i]).detach(),i<e?this.$control_input.before(r):this.$control.append(r);this.caretPos=e},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){this.$input.prop("disabled",!1),this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex),this.isDisabled=!1,this.unlock()},destroy:function(){var e=this.eventNS,i=this.revertSettings;this.trigger("destroy"),this.off(),this.$wrapper.remove(),this.$dropdown.remove(),this.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),this.$control_input.removeData("grow"),this.$input.removeData("selectize"),t(window).off(e),t(document).off(e),t(document.body).off(e),delete this.$input[0].selectize},render:function(e,i){var s,n,r="",o=!1;return"option"!==e&&"item"!==e||(o=!!(s=d(i[this.settings.valueField]))),o&&(h(this.renderCache[e])||(this.renderCache[e]={}),this.renderCache[e].hasOwnProperty(s))?this.renderCache[e][s]:(r=t(this.settings.render[e].apply(this,[i,u])),"option"===e||"option_create"===e?r.attr("data-selectable",""):"optgroup"===e&&(n=i[this.settings.optgroupValueField]||"",r.attr("data-group",n)),"option"!==e&&"item"!==e||r.attr("data-value",s||""),o&&(this.renderCache[e][s]=r[0]),r[0])},clearCache:function(t){void 0===t?this.renderCache={}:delete this.renderCache[t]},canCreate:function(t){if(!this.settings.create)return!1;var e=this.settings.createFilter;return t.length&&("function"!=typeof e||e.apply(this,[t]))&&("string"!=typeof e||new RegExp(e).test(t))&&(!(e instanceof RegExp)||e.test(t))}}),g.count=0,g.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},t.fn.selectize=function(e){var i=t.fn.selectize.defaults,s=t.extend({},i,e),n=s.dataAttr,r=s.labelField,o=s.valueField,a=s.optgroupField,l=s.optgroupLabelField,h=s.optgroupValueField;return this.each(function(){if(!this.selectize){var u=t(this),c=this.tagName.toLowerCase(),p=u.attr("placeholder")||u.attr("data-placeholder");p||s.allowEmptyOption||(p=u.children('option[value=""]').text());var f={placeholder:p,options:[],optgroups:[],items:[]};"select"===c?function(e,i){var u,c,p,f,m=i.options,g={},v=function(t){var e=n&&t.attr(n);return"string"==typeof e&&e.length?JSON.parse(e):null},y=function(e,n){e=t(e);var l=d(e.val());if(l||s.allowEmptyOption)if(g.hasOwnProperty(l)){if(n){var h=g[l][a];h?t.isArray(h)?h.push(n):g[l][a]=[h,n]:g[l][a]=n}}else{var u=v(e)||{};u[r]=u[r]||e.text(),u[o]=u[o]||l,u[a]=u[a]||n,g[l]=u,m.push(u),e.is(":selected")&&i.items.push(l)}},_=function(e){var s,n,r,o,a;for((r=(e=t(e)).attr("label"))&&((o=v(e)||{})[l]=r,o[h]=r,i.optgroups.push(o)),s=0,n=(a=t("option",e)).length;s<n;s++)y(a[s],r)};for(i.maxItems=e.attr("multiple")?null:1,u=0,c=(f=e.children()).length;u<c;u++)p=f[u].tagName.toLowerCase(),"optgroup"===p?_(f[u]):"option"===p&&y(f[u])}(u,f):function(e,i){var a,l,h,d,u=e.attr(n);if(u)for(i.options=JSON.parse(u),a=0,l=i.options.length;a<l;a++)i.items.push(i.options[a][o]);else{var c=t.trim(e.val()||"");if(!s.allowEmptyOption&&!c.length)return;for(a=0,l=(h=c.split(s.delimiter)).length;a<l;a++)d={},d[r]=h[a],d[o]=h[a],i.options.push(d);i.items=h}}(u,f),new g(u,t.extend(!0,{},i,f,e))}})},t.fn.selectize.defaults=g.defaults,t.fn.selectize.support={validity:l},g.define("drag_drop",function(e){if(!t.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var i=this;i.lock=(r=i.lock,function(){var t=i.$control.data("sortable");return t&&t.disable(),r.apply(i,arguments)}),i.unlock=(n=i.unlock,function(){var t=i.$control.data("sortable");return t&&t.enable(),n.apply(i,arguments)}),i.setup=(s=i.setup,function(){s.apply(this,arguments);var e=i.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:i.isLocked,start:function(t,i){i.placeholder.css("width",i.helper.css("width")),e.css({overflow:"visible"})},stop:function(){e.css({overflow:"hidden"});var s=i.$activeItems?i.$activeItems.slice():null,n=[];e.children("[data-value]").each(function(){n.push(t(this).attr("data-value"))}),i.setValue(n),i.setActiveItem(s)}})})}var s,n,r}),g.define("dropdown_header",function(e){var i,s=this;e=t.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},e),s.setup=(i=s.setup,function(){i.apply(s,arguments),s.$dropdown_header=t(e.html(e)),s.$dropdown.prepend(s.$dropdown_header)})}),g.define("optgroup_columns",function(e){var i,s=this;e=t.extend({equalizeWidth:!0,equalizeHeight:!0},e),this.getAdjacentOption=function(e,i){var s=e.closest("[data-group]").find("[data-selectable]"),n=s.index(e)+i;return n>=0&&n<s.length?s.eq(n):t()},this.onKeyDown=(i=s.onKeyDown,function(t){var e,n,r,o;return!this.isOpen||37!==t.keyCode&&39!==t.keyCode?i.apply(this,arguments):(s.ignoreHover=!0,e=(o=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void((n=(r=(o=37===t.keyCode?o.prev("[data-group]"):o.next("[data-group]")).find("[data-selectable]")).eq(Math.min(r.length-1,e))).length&&this.setActiveOption(n)))});var n=function(){var t,e=n.width,i=document;return void 0===e&&((t=i.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',t=t.firstChild,i.body.appendChild(t),e=n.width=t.offsetWidth-t.clientWidth,i.body.removeChild(t)),e},r=function(){var i,r,o,a,l,h,d;if((r=(d=t("[data-group]",s.$dropdown_content)).length)&&s.$dropdown_content.width()){if(e.equalizeHeight){for(o=0,i=0;i<r;i++)o=Math.max(o,d.eq(i).height());d.css({height:o})}e.equalizeWidth&&(h=s.$dropdown_content.innerWidth()-n(),a=Math.round(h/r),d.css({width:a}),r>1&&(l=h-a*(r-1),d.eq(r-1).css({width:l})))}};(e.equalizeHeight||e.equalizeWidth)&&(c.after(this,"positionDropdown",r),c.after(this,"refreshOptions",r))}),g.define("remove_button",function(e){e=t.extend({label:"&times;",title:"Remove",className:"remove",append:!0},e);var i,s,n,r,o;return"single"===this.settings.mode?void function(e,i){i.className="remove-single";var s,n=e,r='<a href="javascript:void(0)" class="'+i.className+'" tabindex="-1" title="'+u(i.title)+'">'+i.label+"</a>";e.setup=(s=n.setup,function(){if(i.append){var o=t(n.$input.context).attr("id"),a=(t("#"+o),n.settings.render.item);n.settings.render.item=function(t){return a.apply(e,arguments)+r}}s.apply(e,arguments),e.$control.on("click","."+i.className,function(t){t.preventDefault(),n.isLocked||n.clear()})})}(this,e):(r=i=this,o='<a href="javascript:void(0)" class="'+(s=e).className+'" tabindex="-1" title="'+u(s.title)+'">'+s.label+"</a>",void(i.setup=(n=r.setup,function(){if(s.append){var e=r.settings.render.item;r.settings.render.item=function(t){return s=e.apply(i,arguments),n=o,r=s.search(/(<\/[^>]+>\s*)$/),s.substring(0,r)+n+s.substring(r);var s,n,r}}n.apply(i,arguments),i.$control.on("click","."+s.className,function(e){if(e.preventDefault(),!r.isLocked){var i=t(e.currentTarget).parent();r.setActiveItem(i),r.deleteSelection()&&r.setCaret(r.items.length)}})})))}),g.define("restore_on_backspace",function(t){var e,i=this;t.text=t.text||function(t){return t[this.settings.labelField]},this.onKeyDown=(e=i.onKeyDown,function(i){var s,n;return 8===i.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(s=this.caretPos-1)>=0&&s<this.items.length?(n=this.options[this.items[s]],this.deleteSelection(i)&&(this.setTextboxValue(t.text.apply(this,[n])),this.refreshOptions(!0)),void i.preventDefault()):e.apply(this,arguments)})}),g}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){t.defineMode("yaml",function(){var t=new RegExp("\\b(("+["true","false","on","off","yes","no"].join(")|(")+"))$","i");return{token:function(e,i){var s=e.peek(),n=i.escaped;if(i.escaped=!1,"#"==s&&(0==e.pos||/\s/.test(e.string.charAt(e.pos-1))))return e.skipToEnd(),"comment";if(e.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(i.literal&&e.indentation()>i.keyCol)return e.skipToEnd(),"string";if(i.literal&&(i.literal=!1),e.sol()){if(i.keyCol=0,i.pair=!1,i.pairStart=!1,e.match(/---/))return"def";if(e.match(/\.\.\./))return"def";if(e.match(/\s*-\s+/))return"meta"}if(e.match(/^(\{|\}|\[|\])/))return"{"==s?i.inlinePairs++:"}"==s?i.inlinePairs--:"["==s?i.inlineList++:i.inlineList--,"meta";if(i.inlineList>0&&!n&&","==s)return e.next(),"meta";if(i.inlinePairs>0&&!n&&","==s)return i.keyCol=0,i.pair=!1,i.pairStart=!1,e.next(),"meta";if(i.pairStart){if(e.match(/^\s*(\||\>)\s*/))return i.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable-2";if(0==i.inlinePairs&&e.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(i.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(e.match(t))return"keyword"}return!i.pair&&e.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(i.pair=!0,i.keyCol=e.indentation(),"atom"):i.pair&&e.match(/^:\s*/)?(i.pairStart=!0,"meta"):(i.pairStart=!1,i.escaped="\\"==s,e.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}}}}),t.defineMIME("text/x-yaml","yaml"),t.defineMIME("text/yaml","yaml")}),Mautic.contactclientType=function(){if(void 0===window.contactclientTypeLoaded){window.contactclientTypeLoaded=!0,mQuery('input[name="contactclient[type]"]').change(function(){var t=mQuery('input[name="contactclient[type]"]:checked').val();"api"===t?(mQuery("#payload-tab").removeClass("hide"),mQuery(".row.api_payload").removeClass("hide"),mQuery(".row.file_payload").addClass("hide"),Mautic.contactclientApiPayload()):"file"===t?(mQuery("#payload-tab").removeClass("hide"),mQuery(".row.api_payload").addClass("hide"),mQuery(".row.file_payload").removeClass("hide"),Mautic.contactclientFilePayload()):mQuery("#payload-tab").addClass("hide")}).first().parent().parent().find("label.active input:first").trigger("change");var t="#details";mQuery(".contactclient-tab").click(function(){var e=mQuery(this).attr("href");e!==t&&("#payload"===(t=e)?(mQuery(".contactclient-left").addClass("col-md-12").removeClass("col-md-9"),mQuery(".contactclient-right").addClass("hide")):(mQuery(".contactclient-left").removeClass("col-md-12").addClass("col-md-9"),mQuery(".contactclient-right").removeClass("hide")))})}},Mautic.contactclientTypeChange=function(t){return setTimeout(function(){var e=mQuery(t).parent().parent();e.find("label.btn:not(.active)").addClass("btn-default").removeClass("btn-primary"),e.find("label.btn.btn-default.active").addClass("btn-primary").removeClass("btn-default")},50),!0},Mautic.contactclientSuccessDefinitionDefaultOps=["equal","not_equal","less","less_or_equal","greater","greater_or_equal","begins_with","not_begins_with","contains","not_contains","ends_with","not_ends_with","is_empty","is_not_empty"],Mautic.contactclientSuccessDefinitionFiltersDefault=[{id:"status",label:"Status Code",type:"string",input:"select",values:{"1xx":"1xx: Informational",100:"100: Continue",101:"101: Switching Protocols","2xx":"2xx: Successful",200:"200: OK",201:"201: Created",202:"202: Accepted",203:"203: Non-Authoritative Information",204:"204: No Content",205:"205: Reset Content",206:"206: Partial Content","3xx":"3xx: Redirection",300:"300: Multiple Choices",301:"301: Moved Permanently",302:"302: Found",303:"303: See Other",304:"304: Not Modified",305:"305: Use Proxy",307:"307: Temporary Redirect","4xx":"4xx: Client Error",400:"400: Bad Request",401:"401: Unauthorized",402:"402: Payment Required",403:"403: Forbidden",404:"404: Not Found",405:"405: Method Not Allowed",406:"406: Not Acceptable",407:"407: Proxy Authentication Required",408:"408: Request Timeout",409:"409: Conflict",410:"410: Gone",411:"411: Length Required",412:"412: Precondition Failed",413:"413: Payload Too Large",414:"414: URI Too Long",415:"415: Unsupported Media Type",416:"416: Range Not Satisfiable",417:"417: Expectation Failed",418:"418: I'm a teapot",426:"426: Upgrade Required","5xx":"5xx: Server Error",500:"500: Internal Server Error",501:"501: Not Implemented",502:"502: Bad Gateway",503:"503: Service Unavailable",504:"504: Gateway Time-out",505:"505: HTTP Version Not Supported",102:"102: Processing",207:"207: Multi-Status",226:"226: IM Used",308:"308: Permanent Redirect",422:"422: Unprocessable Entity",423:"423: Locked",424:"424: Failed Dependency",428:"428: Precondition Required",429:"429: Too Many Requests",431:"431: Request Header Fields Too Large",451:"451: Unavailable For Legal Reasons",506:"506: Variant Also Negotiates",507:"507: Insufficient Storage",511:"511: Network Authentication Required","7xx":"7xx: Developer Error"},operators:["equal","not_equal"]},{id:"headersRaw",label:"Header Text (raw)",type:"string",operators:Mautic.contactclientSuccessDefinitionDefaultOps},{id:"bodyRaw",label:"Body Text (raw)",type:"string",operators:Mautic.contactclientSuccessDefinitionDefaultOps},{id:"bodySize",label:"Body Size",type:"integer",operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal"]}],JSONEditor.defaults.themes.custom=JSONEditor.defaults.themes.bootstrap3.extend({getButton:function(t,e,i){var s=this._super(t,e,i);return-1!==i.indexOf("Delete")?s.className=s.className.replace("btn-default","btn-sm btn-xs btn-danger"):-1!==i.indexOf("Add")?s.className=s.className.replace("btn-default","btn-md btn-primary"):s.className=s.className.replace("btn-default","btn-sm btn-xs btn-secondary"),s},getHeaderButtonHolder:function(){var t=this.getButtonHolder();return t.className="btn-group btn-group-sm btn-right",t},getButtonHolder:function(){var t=document.createElement("div");return t.className="btn-group btn-left",t},getHeader:function(t){var e=document.createElement("h3");return e.onclick=function(t){t.preventDefault(),t.stopPropagation();var e=mQuery(this).find("> div.btn-group > button.json-editor-btn-collapse:first:visible");if(e.length){var i=e[0];if(i){var s=new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0});i.dispatchEvent(s)}}},e.style.cursor="pointer","string"==typeof t?e.textContent=t:e.appendChild(t),e}}),JSONEditor.defaults.editors.query=JSONEditor.defaults.editors.string.extend({postBuild:function(){var t=this,e={condition:"AND",rules:[{id:"status",operator:"equal",value:"200"}]};if(this.input.value)if("object"==typeof this.input.value)e=this.input.value;else{try{var i=mQuery.parseJSON(this.input.value)}catch(t){console.warn("Invalid JSON in success definition")}"object"==typeof i&&i.length>0&&(e=i)}mQuery("<div>",{id:"success-definition-"+this.parent.parent.parent.key,class:"query-builder"}).insertAfter(t.input).queryBuilder({plugins:{sortable:{icon:"fa fa-sort"},"bt-tooltip-errors":null},filters:Mautic.contactclientSuccessDefinitionFiltersDefault,icons:{add_group:"fa fa-plus",add_rule:"fa fa-plus",remove_group:"fa fa-times",remove_rule:"fa fa-times",sort:"fa fa-sort",error:"fa fa-exclamation-triangle"},rules:e}).on("afterDeleteGroup.queryBuilder afterUpdateRuleFilter.queryBuilder afterAddRule.queryBuilder afterDeleteRule.queryBuilder afterUpdateRuleValue.queryBuilder afterUpdateRuleOperator.queryBuilder afterUpdateGroupCondition.queryBuilder",function(){var e=mQuery(this).queryBuilder("getRules",{get_flags:!0,skip_empty:!0,allow_invalid:!0});t.setValue(e)}).parent().find("textarea").addClass("hide")}}),JSONEditor.defaults.options.ajax=!1,JSONEditor.defaults.options.theme="custom",JSONEditor.defaults.options.iconlib="fontawesome4",JSONEditor.defaults.options.disable_edit_json=!0,JSONEditor.defaults.options.disable_properties=!0,JSONEditor.defaults.options.disable_array_delete_all_rows=!0,JSONEditor.defaults.options.disable_array_delete_last_row=!0,JSONEditor.defaults.options.required_by_default=!0,JSONEditor.defaults.options.expand_height=!0,JSONEditor.defaults.custom_validators.push(function(t,e,i){var s=[];return"datestring"===t.format&&(/^[0-9|yY]{4}-[0-9]{1,2}-[0-9]{1,2}$/.test(e)||/^[0-9]{1,2}-[0-9]{1,2}$/.test(e)||s.push({path:i,property:"format",message:"Dates should be in ISO format as YYYY-MM-DD or MM-DD for repeating dates"})),s}),Mautic.contactclientApiPayload=function(){var t=mQuery("#contactclient_api_payload");if(void 0===window.contactclientApiPayloadLoaded&&t.length){var e,i;function s(t){var e;if(t.length)try{"object"==typeof(e=mQuery.parseJSON(t))&&i.setValue(e)}catch(t){console.warn(t)}}window.contactclientApiPayloadLoaded=!0,mQuery.ajax({dataType:"json",cache:!0,url:mauticBasePath+"/"+mauticAssetPrefix+"plugins/MauticContactClientBundle/Assets/json/api_payload.json",success:function(e){var n=e,r=mQuery("<div>",{class:"contactclient_jsoneditor",id:"api_payload_jsoneditor"}).insertBefore(t);i=new JSONEditor(r[0],{schema:n}),s(t.val()),i.on("change",function(){var e=i.getValue();if("object"==typeof e){var s=JSON.stringify(e,null,"  ");if(s.length&&t.val(s),"object"==typeof e.operations)for(var n=0,r=e.operations.length;n<r;n++)if("object"==typeof e.operations[n].response){var o=[];if("object"==typeof e.operations[n].response.headers)for(var a=0,l=e.operations[n].response.headers.length;a<l;a++)void 0!==e.operations[n].response.headers[a].key&&e.operations[n].response.headers[a].key.length&&o.push({id:"headers."+e.operations[n].response.headers[a].key,label:"Header Field: "+e.operations[n].response.headers[a].key,type:"string",operators:Mautic.contactclientSuccessDefinitionDefaultOps});if("object"==typeof e.operations[n].response.body)for(var h=0,d=e.operations[n].response.body.length;h<d;h++)void 0!==e.operations[n].response.body[h].key&&e.operations[n].response.body[h].key.length&&o.push({id:"body."+e.operations[n].response.body[h].key,label:"Body Field: "+e.operations[n].response.body[h].key,type:"string",operators:Mautic.contactclientSuccessDefinitionDefaultOps});if(o.length){var u=mQuery("#success-definition-"+n);u.length&&u.queryBuilder("setFilters",!0,Mautic.contactclientSuccessDefinitionFiltersDefault.concat(o))}}}})}});var n,r=mQuery("<div>",{id:"contactclient_api_payload_codemirror",class:"hide"}).insertBefore(t);t.css({display:"none"}),(e=CodeMirror(r[0],{value:t.val(),mode:{name:"javascript",json:!0},theme:"material",gutters:["CodeMirror-lint-markers"],lint:"json",lintOnChange:!0,matchBrackets:!0,autoCloseBrackets:!0,lineNumbers:!0,extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!0})).on("change",function(){var i=e.getValue();i.length&&t.val(i)}),mQuery(".btn#api_payload_advanced").click(function(){var s=t.val(),n=!1;if(mQuery(this).hasClass("active")){if(i){if(s.length)try{var o=mQuery.parseJSON(s);"object"==typeof o&&i.setValue(o)}catch(t){n=!0,console.warn(t)}n?mQuery(this).toggleClass("active"):(r.addClass("hide"),mQuery("#api_payload_jsoneditor").removeClass("hide"))}}else if(e){if(s.length)try{s!==e.getValue()&&e.setValue(s,-1)}catch(t){n=!0,console.warn("Error setting CodeMirror value.")}n?mQuery(this).toggleClass("active"):(r.removeClass("hide"),mQuery("#api_payload_jsoneditor").addClass("hide"),e.refresh())}}).parent().parent().removeClass("hide"),mQuery("#api_payload_test").click(function(){var e=mQuery(this),i=mQuery("#api_payload_test_result"),r=i.find("#api_payload_test_result_yaml");if(e.hasClass("active"));else{var o={action:"plugin:mauticContactClient:getApiPayloadTest",apiPayload:t.val()};i.addClass("hide"),r.addClass("hide"),mQuery.ajax({url:mauticAjaxUrl,type:"POST",data:o,dataType:"json",success:function(t){void 0!==t.html&&(i.removeClass("hide"),r.removeClass("hide"),""!==t.html&&(n?n.setValue(t.html,-1):n=CodeMirror(r[0],{value:t.html,mode:"yaml",theme:"material",gutters:[],lineNumbers:!1,lineWrapping:!0,readOnly:!0}),Mautic.onPageLoad("#api_payload_test_result",t))),void 0!==t.payload&&t.payload.length&&s(t.payload)},error:function(t,e,i){Mautic.processAjaxError(t,e,i)},complete:function(){Mautic.removeButtonLoadingIndicator(e),mQuery("html, body").stop().animate({scrollTop:i.first().offset().top},500),e.removeClass("active")}})}})}},Mautic.contactclientExclusive=function(){var t,e=mQuery("#contactclient_exclusive");void 0===window.contactclientExclusiveLoaded&&e.length&&(window.contactclientExclusiveLoaded=!0,mQuery.ajax({dataType:"json",cache:!0,url:mauticBasePath+"/"+mauticAssetPrefix+"plugins/MauticContactClientBundle/Assets/json/exclusive.json",success:function(i){var s=i,n=mQuery("<div>",{class:"contactclient_jsoneditor"}).insertBefore(e);t=new JSONEditor(n[0],{schema:s,disable_collapse:!0}),e.change(function(){var e,i=mQuery(this).val();if(i.length)try{"object"==typeof(e=mQuery.parseJSON(i))&&t.setValue(e)}catch(t){console.warn(t)}}).trigger("change"),t.on("change",function(){var i=t.getValue();if("object"==typeof i){var s=JSON.stringify(i,null,"  ");s.length&&e.val(s)}}),e.addClass("hide"),n.show()}}))},Mautic.contactclientFilePayload=function(){var t=mQuery("#contactclient_file_payload");void 0===window.contactclientFilePayloadLoaded&&t.length&&(window.contactclientFilePayloadLoaded=!0)},Mautic.contactclientFilter=function(){var t=mQuery("#contactclient_filter");void 0===window.contactclientFilterLoaded&&t.length&&(window.contactclientFilterLoaded=!0)},Mautic.contactclientLimits=function(){var t=mQuery("#contactclient_limits");void 0===window.contactclientLimitsLoaded&&t.length&&(window.contactclientLimitsLoaded=!0)},Mautic.contactclientSchedule=function(){var t=mQuery("#contactclient_schedule_hours_widget:first"),e=mQuery("#contactclient_schedule_hours:first");if(void 0===window.contactclientScheduleLoaded&&t.length&&e.length){window.contactclientScheduleLoaded=!0;var i=e.val();if(i.length)try{i=mQuery.parseJSON(i)}catch(t){console.warn("Invalid JSON")}"object"!=typeof i&&(i=[{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"},{isActive:!0,timeFrom:"00:00",timeTill:"23:59"}]);var s=t.businessHours({operationTime:i,checkedColorClass:"btn-success",uncheckedColorClass:"btn-danger",postInit:function(){mQuery(".operationTimeFrom, .operationTimeTill").timepicker({timeFormat:"H:i",step:function(t){return t<48?30:29}})},dayTmpl:'<div class="dayContainer"><div data-original-title="" class="colorBox"><input type="checkbox" class="invisible operationState"></div><div class="weekday"></div><div class="operationDayTimeContainer"><div class="operationTime input-group"><span class="input-group-addon"><i class="fa fa-sun-o"></i></span><input type="text" name="startTime" class="mini-time form-control operationTimeFrom" value=""></div><div class="operationTime input-group"><span class="input-group-addon"><i class="fa fa-moon-o"></i></span><input type="text" name="endTime" class="mini-time form-control operationTimeTill" value=""></div></div></div>'});e.addClass("hide"),mQuery("#contactclient_schedule_hours_widget .operationState, #contactclient_schedule_hours_widget input").change(function(){mQuery("#contactclient_schedule_hours").val(JSON.stringify(s.serialize()))})}var n,r=mQuery("#contactclient_schedule_exclusions:first");r.length&&mQuery.ajax({dataType:"json",cache:!0,url:mauticBasePath+"/"+mauticAssetPrefix+"plugins/MauticContactClientBundle/Assets/json/exclusions.json",success:function(t){var e=t,i=mQuery("<div>",{class:"contactclient_jsoneditor"}).insertBefore(r);n=new JSONEditor(i[0],{schema:e,disable_collapse:!0}),r.change(function(){var t,e=mQuery(this).val();if(e.length)try{"object"==typeof(t=mQuery.parseJSON(e))&&n.setValue(t)}catch(t){console.warn(t)}}).trigger("change"),n.on("change",function(){var t=n.getValue();if("object"==typeof t){var e=JSON.stringify(t,null,"  ");e.length&&r.val(e)}}),r.addClass("hide"),i.show()}})},Mautic.contactclientIntegration=function(){var t,e=mQuery("#campaignevent_properties_config_contactclient:first"),i=mQuery("#campaignevent_properties_config_contactclient_overrides:first");void 0===window.contactclientIntegrationLoaded&&e.length&&i.length&&(window.contactclientIntegrationLoaded=!0,e.change(function(){var t=parseInt(mQuery(this).val()),e=t?mQuery("#campaignevent_properties_config_contactclient > option[value="+t+"]:first"):[],s=e.length?e.attr("data-overridable-fields"):null;s?(mQuery("#campaignevent_properties_config_contactclient_overrides_button").removeClass("hide"),mQuery("label[for=campaignevent_properties_config_contactclient_overrides]:first, .contactclient_jsoneditor").addClass("hide")):(mQuery("#campaignevent_properties_config_contactclient_overrides_button").addClass("hide"),mQuery("label[for=campaignevent_properties_config_contactclient_overrides]:first, .contactclient_jsoneditor").addClass("hide")),i.val(s)}),0===i.val().length&&e.trigger("change"),mQuery.ajax({dataType:"json",cache:!0,url:mauticBasePath+"/"+mauticAssetPrefix+"plugins/MauticContactClientBundle/Assets/json/overrides.json",success:function(e){var s=e,n=mQuery("<div>",{class:"contactclient_jsoneditor"}).insertBefore(i);t=new JSONEditor(n[0],{schema:s,disable_array_add:!0,disable_array_delete:!0,disable_array_reorder:!0,disable_collapse:!0}),i.change(function(){var e,i=mQuery(this).val();if(i.length)try{"object"==typeof(e=mQuery.parseJSON(i))&&t.setValue(e)}catch(t){console.warn(t)}}).trigger("change"),t.on("change",function(){var e=t.getValue();if("object"==typeof e){var s=JSON.stringify(e,null,"  ");s.length&&i.val(s)}}),mQuery("#campaignevent_properties_config_contactclient_overrides_button").addClass("hide"),mQuery("label[for=campaignevent_properties_config_contactclient_overrides]").removeClass("hide")}}))},Mautic.contactclientTimelineOnLoad=function(t,e){if(void 0===window.contactclientTimelineLoaded){window.contactclientTimelineLoaded=!0;var i=function(t){if(!t.hasClass("codemirror-active")){var e=t.find("textarea.codeMirror-yaml");e.length&&CodeMirror.fromTextArea(e[0],{mode:"yaml",theme:"material",gutters:[],lineNumbers:!1,lineWrapping:!0,readOnly:!0}),t.addClass("codemirror-active")}};mQuery("#contactclient-timeline a[data-activate-details='all']").on("click",function(){mQuery(this).find("span").first().hasClass("fa-level-down")?(mQuery("#contactclient-timeline a[data-activate-details!='all']").each(function(){var t=mQuery(this).data("activate-details"),e=mQuery("#timeline-details-"+t);t&&e.length&&(e.removeClass("hide"),i(e),mQuery(this).addClass("active"))}),mQuery(this).find("span").first().removeClass("fa-level-down").addClass("fa-level-up")):(mQuery("#contactclient-timeline a[data-activate-details!='all']").each(function(){var t=mQuery(this).data("activate-details"),e=mQuery("#timeline-details-"+t);t&&e.length&&(e.addClass("hide"),mQuery(this).removeClass("active"))}),mQuery(this).find("span").first().removeClass("fa-level-up").addClass("fa-level-down"))}),mQuery("#contactclient-timeline a[data-activate-details!='all']").on("click",function(){var t=mQuery(this).data("activate-details");if(t&&mQuery("#timeline-details-"+t).length){var e=mQuery(this).hasClass("active"),s=mQuery("#timeline-details-"+t);e?(s.addClass("hide"),mQuery(this).removeClass("active")):(s.removeClass("hide"),i(s),mQuery(this).addClass("active"))}}),e&&void 0!==e.timelineCount&&mQuery("#TimelineCount").html(e.timelineCount)}},Mautic.contactclientAttribution=function(){var t=mQuery("#contactclient_attribution_settings:first");if(void 0===window.contactclientAttributionLoaded&&t.length){window.contactclientAttributionLoaded=!0;var e;mQuery.ajax({dataType:"json",cache:!0,url:mauticBasePath+"/"+mauticAssetPrefix+"plugins/MauticContactClientBundle/Assets/json/attribution.json",success:function(i){var s=i;s.properties.mode.oneOf[1].properties.key.enumSource=function(){var t,e={},i=mQuery("#contactclient_api_payload");if(i.length){var s=i.val();if(s.length)try{if("object"==typeof(t=mQuery.parseJSON(s))&&"object"==typeof t.operations)for(var n=0,r=t.operations.length;n<r;n++)if("object"==typeof t.operations[n].response){if("object"==typeof t.operations[n].response.headers)for(var o=0,a=t.operations[n].response.headers.length;o<a;o++)void 0!==t.operations[n].response.headers[o].key&&t.operations[n].response.headers[o].key.length&&(e[t.operations[n].response.headers[o].key]=t.operations[n].response.headers[o].example);if("object"==typeof t.operations[n].response.body)for(var l=0,h=t.operations[n].response.body.length;l<h;l++)void 0!==t.operations[n].response.body[l].key&&t.operations[n].response.body[l].key.length&&(e[t.operations[n].response.body[l].key]=t.operations[n].response.body[l].example)}}catch(t){console.warn(t)}}var d=Object.keys(e),u=[];d.sort();for(var c=0,p=d.length;c<p;c++)u[d[c]]=e[d[c]];e=u;var f,m=[];for(f in e)e.hasOwnProperty(f)&&(e[f].length?m.push({value:f,title:f+" ("+e[f]+")"}):m.push({value:f,title:f}));return[{source:m,title:"{{item.title}}",value:"{{item.value}}"}]}();var n=mQuery("<div>",{class:"contactclient_jsoneditor"}).insertBefore(t);e=new JSONEditor(n[0],{schema:s,disable_collapse:!0}),t.change(function(){var t,i=mQuery(this).val();if(i.length)try{"object"==typeof(t=mQuery.parseJSON(i))&&e.setValue(t)}catch(t){console.warn(t)}}).trigger("change"),e.on("change",function(){var i=e.getValue();if("object"==typeof i){var s=JSON.stringify(i,null,"  ");s.length&&t.val(s)}}),t.addClass("hide"),n.show(),mQuery("label[for=contactclient_attribution_settings]").addClass("hide")}})}},Mautic.contactclientOnLoad=function(){mQuery(document).ready(function(){if(mQuery('input[name="contactclient[type]"]').length)return Mautic.contactclientType(),Mautic.contactclientExclusive(),Mautic.contactclientFilter(),Mautic.contactclientLimits(),Mautic.contactclientSchedule(),void Mautic.contactclientAttribution();mQuery("#contactclient-timeline").length&&Mautic.contactclientTimelineOnLoad()})};
//# sourceMappingURL=contactclient.min.js.map